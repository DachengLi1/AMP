using exec cost with mp_size 1: [7.20977783e-04 2.26020813e-04 2.28166580e-04 6.37507439e-03
 6.10113144e-03 6.19411469e-03 6.10971451e-03 6.23774529e-03
 6.11472130e-03 6.22129440e-03 6.08468056e-03 6.13045692e-03
 6.08968735e-03 6.21557236e-03 6.07681274e-03 2.13861465e-04
 4.07695770e-04 3.31878662e-04 5.57899475e-05 3.09705734e-04
 2.31742859e-04 4.88519669e-04 2.33173370e-04 1.00851059e-04
 2.61068344e-04 8.51154327e-05 1.63078308e-04 9.44137573e-05
 2.74658203e-04 4.87804413e-04 2.32458115e-04 9.51290131e-05
 2.50339508e-04 8.36849213e-05 6.86645508e-05 2.51054764e-04
 4.30583954e-04 2.15291977e-04 9.51290131e-05 2.44617462e-04
 8.15391541e-05 1.20248795e-02 1.20019913e-02 1.19976997e-02
 1.19891167e-02 1.19891167e-02 1.19791031e-02 1.19826794e-02
 1.19805336e-02 1.19919777e-02 1.20112896e-02 1.20027065e-02
 1.20205879e-02 1.27315521e-04 3.25441360e-04 8.18252563e-04]
using exec cost with mp_size 2: [7.24554062e-04 2.16722488e-04 2.16007233e-04 7.77769089e-03
 6.81924820e-03 6.96873665e-03 6.85286522e-03 7.01665878e-03
 6.95085526e-03 6.85143471e-03 6.93798065e-03 6.85858727e-03
 6.97016716e-03 6.82711601e-03 6.90650940e-03 2.22444534e-04
 3.94821167e-04 2.26020813e-04 5.07831573e-05 2.93254852e-04
 2.26020813e-04 4.72068787e-04 2.27451324e-04 9.65595245e-05
 2.50339508e-04 8.01086426e-05 1.51634216e-04 8.58306885e-05
 2.55346298e-04 4.36306000e-04 2.29597092e-04 9.29832458e-05
 2.38180161e-04 7.79628754e-05 6.43730164e-05 2.45332718e-04
 4.60624695e-04 2.16007233e-04 9.29832458e-05 3.78370285e-04
 8.22544098e-05 1.48658752e-02 1.48501396e-02 1.48165226e-02
 1.48108006e-02 1.49931908e-02 1.48386955e-02 1.47743225e-02
 1.47900581e-02 1.49660110e-02 1.47829056e-02 1.48072243e-02
 1.47943497e-02 1.08718872e-04 3.37600708e-04 8.36133957e-04]
using exec cost with mp_size 4: [7.72476196e-04 2.81095505e-04 2.38895416e-04 7.92431831e-03
 7.37643242e-03 7.40361214e-03 7.39789009e-03 7.34210014e-03
 7.55095482e-03 7.40718842e-03 7.41791725e-03 7.46369362e-03
 7.12537766e-03 7.35497475e-03 7.51519203e-03 2.21014023e-04
 3.91244888e-04 2.22444534e-04 4.93526459e-05 2.84671783e-04
 2.21014023e-04 4.69207764e-04 2.23159790e-04 9.15527344e-05
 2.48193741e-04 7.86781311e-05 1.61647797e-04 8.86917114e-05
 2.89678574e-04 4.18424606e-04 2.26736069e-04 8.79764557e-05
 2.32458115e-04 7.58171082e-05 6.36577606e-05 2.34603882e-04
 4.12702560e-04 2.08139420e-04 8.65459442e-05 2.30312347e-04
 7.36713409e-05 1.40805244e-02 1.37515068e-02 1.38967037e-02
 1.37336254e-02 1.37729645e-02 1.35591030e-02 1.36964321e-02
 1.36935711e-02 1.36799812e-02 1.37672424e-02 1.36034489e-02
 1.35805607e-02 1.10864639e-04 3.39031219e-04 8.94784927e-04]
total possible amp candidates without placment: 65
pipe_ast used 14.546523094177246 with L=25, k=16
amp gives partition: [3, 3, 3, 3, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[3, 3, 3, 3, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 5, 8, 11, 14, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 56] tensor([1.3877]) tensor([0.])
pipe_ast used 9.625777006149292 with L=25, k=8
amp gives partition: [5, 5, 4, 2, 2, 3, 2, 2]
[5, 5, 4, 2, 2, 3, 2, 2] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 7, 12, 42, 44, 46, 49, 51, 56] tensor([1.3456]) tensor([0.0118])
pipe_ast used 4.890570878982544 with L=25, k=4
amp gives partition: [10, 6, 5, 4]
[10, 6, 5, 4] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 12, 44, 49, 56] tensor([1.1502]) tensor([0.0320])
pipe_ast used 1.8820486068725586 with L=25, k=2
amp gives partition: [16, 9]
[16, 9] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 44, 56] tensor([1.8394]) tensor([0.8456])
pipe_ast used 0.07423782348632812 with L=25, k=1
amp gives partition: [25]
[25] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 56] tensor([1.7808]) tensor([0.9062])
pipe_ast used 9.717074871063232 with L=25, k=8
amp gives partition: [6, 6, 3, 2, 2, 2, 2, 2]
[6, 6, 3, 2, 2, 2, 2, 2] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 8, 14, 43, 45, 47, 49, 51, 56] tensor([2.8714]) tensor([0.])
pipe_ast used 4.940339088439941 with L=25, k=4
amp gives partition: [11, 6, 4, 4]
[11, 6, 4, 4] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 13, 45, 49, 56] tensor([2.5406]) tensor([0.0118])
pipe_ast used 1.9152886867523193 with L=25, k=2
amp gives partition: [16, 9]
[16, 9] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 44, 56] tensor([2.6286]) tensor([0.3624])
pipe_ast used 0.07352519035339355 with L=25, k=1
amp gives partition: [25]
[25] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 56] tensor([2.5233]) tensor([0.4229])
pipe_ast used 4.941582679748535 with L=25, k=4
amp gives partition: [10, 6, 4, 5]
[10, 6, 4, 5] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 12, 44, 48, 56] tensor([4.5601]) tensor([0.])
pipe_ast used 1.9066755771636963 with L=25, k=2
amp gives partition: [16, 9]
[16, 9] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 44, 56] tensor([4.4611]) tensor([0.1208])
pipe_ast used 0.07510089874267578 with L=25, k=1
amp gives partition: [25]
[25] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 56] tensor([4.2591]) tensor([0.1812])
pipe_ast used 14.576740026473999 with L=25, k=16
amp gives partition: [3, 3, 3, 3, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[3, 3, 3, 3, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 5, 8, 11, 14, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 56] tensor([1.5888]) tensor([0.])
pipe_ast used 9.621095180511475 with L=25, k=8
amp gives partition: [5, 5, 4, 2, 2, 3, 2, 2]
[5, 5, 4, 2, 2, 3, 2, 2] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 7, 12, 42, 44, 46, 49, 51, 56] tensor([1.5291]) tensor([0.0118])
pipe_ast used 4.8998072147369385 with L=25, k=4
amp gives partition: [10, 6, 5, 4]
[10, 6, 5, 4] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 12, 44, 49, 56] tensor([1.3097]) tensor([0.0320])
pipe_ast used 1.8777711391448975 with L=25, k=2
amp gives partition: [16, 9]
[16, 9] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 44, 56] tensor([1.9476]) tensor([0.8456])
pipe_ast used 0.07444596290588379 with L=25, k=1
amp gives partition: [25]
[25] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 56] tensor([1.7808]) tensor([0.9062])
pipe_ast used 9.747992753982544 with L=25, k=8
amp gives partition: [6, 6, 3, 2, 2, 2, 2, 2]
[6, 6, 3, 2, 2, 2, 2, 2] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 8, 14, 43, 45, 47, 49, 51, 56] tensor([3.0934]) tensor([0.])
pipe_ast used 4.942622900009155 with L=25, k=4
amp gives partition: [11, 6, 4, 4]
[11, 6, 4, 4] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 13, 45, 49, 56] tensor([2.7308]) tensor([0.0118])
pipe_ast used 1.9040381908416748 with L=25, k=2
amp gives partition: [16, 9]
[16, 9] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 44, 56] tensor([2.7579]) tensor([0.3624])
pipe_ast used 0.08588075637817383 with L=25, k=1
amp gives partition: [25]
[25] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 56] tensor([2.5233]) tensor([0.4229])
pipe_ast used 4.906542539596558 with L=25, k=4
amp gives partition: [10, 6, 4, 5]
[10, 6, 4, 5] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 12, 44, 48, 56] tensor([4.7475]) tensor([0.])
pipe_ast used 1.92393159866333 with L=25, k=2
amp gives partition: [16, 9]
[16, 9] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 44, 56] tensor([4.5845]) tensor([0.1208])
pipe_ast used 0.0750429630279541 with L=25, k=1
amp gives partition: [25]
[25] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 56] tensor([4.2591]) tensor([0.1812])
pipe_ast used 14.591030597686768 with L=25, k=16
amp gives partition: [3, 3, 3, 3, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[3, 3, 3, 3, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 5, 8, 11, 14, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 56] tensor([1.9910]) tensor([0.])
pipe_ast used 9.608769178390503 with L=25, k=8
amp gives partition: [5, 5, 4, 2, 3, 3, 2, 1]
[5, 5, 4, 2, 3, 3, 2, 1] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 7, 12, 42, 44, 47, 50, 52, 56] tensor([1.8967]) tensor([0.0118])
pipe_ast used 4.9125142097473145 with L=25, k=4
amp gives partition: [8, 7, 5, 5]
[8, 7, 5, 5] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 10, 43, 48, 56] tensor([1.6227]) tensor([0.0249])
pipe_ast used 1.8831322193145752 with L=25, k=2
amp gives partition: [16, 9]
[16, 9] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 44, 56] tensor([2.1640]) tensor([0.8456])
using pipe uniform
pipe uniform returns [24]
amp gives partition: [24]
[24] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 56] tensor([1.7808]) tensor([0.9062])
pipe_ast used 9.71834945678711 with L=25, k=8
amp gives partition: [6, 6, 3, 2, 2, 2, 2, 2]
[6, 6, 3, 2, 2, 2, 2, 2] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 8, 14, 43, 45, 47, 49, 51, 56] tensor([3.5374]) tensor([0.])
pipe_ast used 4.956006765365601 with L=25, k=4
amp gives partition: [11, 6, 4, 4]
[11, 6, 4, 4] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 13, 45, 49, 56] tensor([3.1114]) tensor([0.0118])
pipe_ast used 1.8948390483856201 with L=25, k=2
amp gives partition: [16, 9]
[16, 9] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 44, 56] tensor([3.0164]) tensor([0.3624])
pipe_ast used 0.07375001907348633 with L=25, k=1
amp gives partition: [25]
[25] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 56] tensor([2.5233]) tensor([0.4229])
pipe_ast used 4.922675132751465 with L=25, k=4
amp gives partition: [10, 6, 4, 5]
[10, 6, 4, 5] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 12, 44, 48, 56] tensor([5.1221]) tensor([0.])
pipe_ast used 1.888326644897461 with L=25, k=2
amp gives partition: [16, 9]
[16, 9] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 44, 56] tensor([4.8312]) tensor([0.1208])
pipe_ast used 0.08914732933044434 with L=25, k=1
amp gives partition: [25]
[25] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 56] tensor([4.2591]) tensor([0.1812])
pipe_ast used 14.56898808479309 with L=25, k=16
amp gives partition: [3, 3, 3, 3, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[3, 3, 3, 3, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 5, 8, 11, 14, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 56] tensor([2.7953]) tensor([0.])
pipe_ast used 9.614139795303345 with L=25, k=8
amp gives partition: [1, 4, 5, 4, 3, 3, 3, 2]
[1, 4, 5, 4, 3, 3, 3, 2] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 1, 7, 12, 42, 45, 48, 51, 56] tensor([2.6316]) tensor([0.0118])
pipe_ast used 4.868335008621216 with L=25, k=4
amp gives partition: [8, 7, 5, 5]
[8, 7, 5, 5] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 10, 43, 48, 56] tensor([2.2604]) tensor([0.0249])
using pipe uniform
pipe uniform returns [12, 12]
amp gives partition: [12, 12]
[12, 12] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 14, 56] tensor([2.5264]) tensor([0.7751])
pipe_ast used 9.749600648880005 with L=25, k=8
amp gives partition: [6, 6, 3, 2, 2, 2, 2, 2]
[6, 6, 3, 2, 2, 2, 2, 2] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 8, 14, 43, 45, 47, 49, 51, 56] tensor([4.4255]) tensor([0.])
pipe_ast used 4.9499735832214355 with L=25, k=4
amp gives partition: [11, 6, 4, 4]
[11, 6, 4, 4] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 13, 45, 49, 56] tensor([3.8725]) tensor([0.0118])
pipe_ast used 1.9254634380340576 with L=25, k=2
amp gives partition: [16, 9]
[16, 9] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 44, 56] tensor([3.5334]) tensor([0.3624])
using pipe uniform
pipe uniform returns [24]
amp gives partition: [24]
[24] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 56] tensor([2.5233]) tensor([0.4229])
pipe_ast used 4.90595555305481 with L=25, k=4
amp gives partition: [10, 6, 4, 5]
[10, 6, 4, 5] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 12, 44, 48, 56] tensor([5.8715]) tensor([0.])
pipe_ast used 1.8999006748199463 with L=25, k=2
amp gives partition: [16, 9]
[16, 9] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 44, 56] tensor([5.3246]) tensor([0.1208])
pipe_ast used 0.0751488208770752 with L=25, k=1
amp gives partition: [25]
[25] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 56] tensor([4.2591]) tensor([0.1812])
pipe_ast used 14.548255681991577 with L=25, k=16
amp gives partition: [3, 3, 3, 3, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[3, 3, 3, 3, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 5, 8, 11, 14, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 56] tensor([4.4040]) tensor([0.])
pipe_ast used 9.667339324951172 with L=25, k=8
amp gives partition: [1, 4, 5, 4, 3, 3, 3, 2]
[1, 4, 5, 4, 3, 3, 3, 2] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 1, 7, 12, 42, 45, 48, 51, 56] tensor([4.0997]) tensor([0.0118])
using pipe uniform
pipe uniform returns [6, 6, 6, 6]
amp gives partition: [6, 6, 6, 6]
[6, 6, 6, 6] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 8, 14, 46, 56] tensor([3.5324]) tensor([0.0213])
pipe_ast used 9.739617586135864 with L=25, k=8
amp gives partition: [6, 6, 3, 2, 2, 2, 2, 2]
[6, 6, 3, 2, 2, 2, 2, 2] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 8, 14, 43, 45, 47, 49, 51, 56] tensor([6.2016]) tensor([0.])
pipe_ast used 4.945847272872925 with L=25, k=4
amp gives partition: [11, 6, 4, 4]
[11, 6, 4, 4] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 13, 45, 49, 56] tensor([5.3947]) tensor([0.0118])
using pipe uniform
pipe uniform returns [12, 12]
amp gives partition: [12, 12]
[12, 12] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 14, 56] tensor([4.5373]) tensor([0.3322])
pipe_ast used 4.935539960861206 with L=25, k=4
amp gives partition: [10, 6, 4, 5]
[10, 6, 4, 5] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 12, 44, 48, 56] tensor([7.3702]) tensor([0.])
pipe_ast used 1.8920621871948242 with L=25, k=2
amp gives partition: [16, 9]
[16, 9] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 44, 56] tensor([6.3114]) tensor([0.1208])
using pipe uniform
pipe uniform returns [24]deepspeed --hostfile=/home/ubuntu/hostfile --master_port 9005 pretrain_transgan.py --model-parallel-size 1 --pipe-parallel-size 4 --gas 16 --exp_name simulate_het_model --num-layers 24 --hidden-size 1024 --num-attention-heads 1 --seq-length 1024 --fp16 --max-position-embeddings 1024 --batch-size 1 --train-iters 320000 --lr-decay-iters 320000 --save /home/ubuntu/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/examples/ckpts/gpt2_1542m_ds_distributed --load /home/ubuntu/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/examples/ckpts/gpt2_1542m_ds_distributed --data-path /home/ubuntu/datasets/datasets/preprocessed_data/my-gpt2_text_document --vocab-file /home/ubuntu/datasets/datasets/gpt2-vocab.json --merge-file /home/ubuntu/datasets/datasets/gpt2-merges.txt --data-impl mmap --split 949,50,1 --distributed-backend nccl --lr 1.5e-4 --lr-decay-style cosine --min-lr 1.0e-5 --weight-decay 1e-2 --clip-grad 1.0 --warmup 0.01 --log-interval 20 --save-interval 50000 --eval-interval 100000 --eval-iters 10000 --tensorboard-dir tensorboard_data/24l_1024h_n_g_4pp_1mp_1b_ds4 -gen_bs 16 -dis_bs 16 --accumulated_times 4 --g_accumulated_times 8 --dist-url 'tcp://localhost:10641' --dist-backend 'nccl' --dataset church --data_path ./lsun --bottom_width 9 --img_size 256 --max_iter 500000 --gen_model ViT_custom_local544444_256_rp_noise --dis_model ViT_scale3_local_new_rp --g_window_size 18 --d_window_size 12 --g_norm pn --df_dim 384 --d_depth 3 --g_depth 12,0,0,0,0,12 --latent_dim 512 --gf_dim 1024 --num_workers 8 --g_lr 0.0001 --d_lr 0.0001 --optimizer adam --loss wgangp-eps --wd 1e-3 --beta1 0 --beta2 0.99 --phi 1 --eval_batch_size 10 --num_eval_imgs 50000 --init_type xavier_uniform --n_critic 4 --val_freq 5000 --print_freq 50 --grow_steps 0 0 --fade_in 0 --patch_size 4 --diff_aug translation,erase_ratio,color --fid_stat fid_stat/fid_stats_church_256.npz --ema 0.995 --deepspeed --deepspeed_config /home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/examples/ds_config.json
[2022-10-08 14:53:07,104] [INFO] [runner.py:288:main] Using IP address of 172.31.41.243 for node ec2-34-219-204-184.us-west-2.compute.amazonaws.com
[2022-10-08 14:53:07,106] [INFO] [multinode_runner.py:50:get_cmd] Running on the following workers: ec2-34-219-204-184.us-west-2.compute.amazonaws.com,ec2-54-244-82-8.us-west-2.compute.amazonaws.com,ec2-35-90-65-226.us-west-2.compute.amazonaws.com,ec2-35-90-28-66.us-west-2.compute.amazonaws.com
[2022-10-08 14:53:07,106] [INFO] [runner.py:358:main] cmd = pdsh -f 1024 -w ec2-34-219-204-184.us-west-2.compute.amazonaws.com,ec2-54-244-82-8.us-west-2.compute.amazonaws.com,ec2-35-90-65-226.us-west-2.compute.amazonaws.com,ec2-35-90-28-66.us-west-2.compute.amazonaws.com export PYTHONPATH=/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism; export NCCL_ALGO=^tree,collnet; export NCCL_DEBUG=INFO;  cd /home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism; /home/ubuntu/anaconda3/envs/amp/bin/python3.7 -u -m deepspeed.launcher.launch --world_info=eyJlYzItMzQtMjE5LTIwNC0xODQudXMtd2VzdC0yLmNvbXB1dGUuYW1hem9uYXdzLmNvbSI6IFswLCAxLCAyLCAzXSwgImVjMi01NC0yNDQtODItOC51cy13ZXN0LTIuY29tcHV0ZS5hbWF6b25hd3MuY29tIjogWzAsIDEsIDIsIDNdLCAiZWMyLTM1LTkwLTY1LTIyNi51cy13ZXN0LTIuY29tcHV0ZS5hbWF6b25hd3MuY29tIjogWzAsIDEsIDIsIDNdLCAiZWMyLTM1LTkwLTI4LTY2LnVzLXdlc3QtMi5jb21wdXRlLmFtYXpvbmF3cy5jb20iOiBbMCwgMSwgMiwgM119 --node_rank=%n --master_addr=172.31.41.243 --master_port=9005 pretrain_transgan.py --model-parallel-size '1' --pipe-parallel-size '4' --gas '16' --exp_name 'simulate_het_model' --num-layers '24' --hidden-size '1024' --num-attention-heads '1' --seq-length '1024' --fp16 --max-position-embeddings '1024' --batch-size '1' --train-iters '320000' --lr-decay-iters '320000' --save '/home/ubuntu/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/examples/ckpts/gpt2_1542m_ds_distributed' --load '/home/ubuntu/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/examples/ckpts/gpt2_1542m_ds_distributed' --data-path '/home/ubuntu/datasets/datasets/preprocessed_data/my-gpt2_text_document' --vocab-file '/home/ubuntu/datasets/datasets/gpt2-vocab.json' --merge-file '/home/ubuntu/datasets/datasets/gpt2-merges.txt' --data-impl 'mmap' --split '949,50,1' --distributed-backend 'nccl' --lr '1.5e-4' --lr-decay-style 'cosine' --min-lr '1.0e-5' --weight-decay '1e-2' --clip-grad '1.0' --warmup '0.01' --log-interval '20' --save-interval '50000' --eval-interval '100000' --eval-iters '10000' --tensorboard-dir 'tensorboard_data/24l_1024h_n_g_4pp_1mp_1b_ds4' -gen_bs '16' -dis_bs '16' --accumulated_times '4' --g_accumulated_times '8' --dist-url 'tcp://localhost:10641' --dist-backend 'nccl' --dataset 'church' --data_path './lsun' --bottom_width '9' --img_size '256' --max_iter '500000' --gen_model 'ViT_custom_local544444_256_rp_noise' --dis_model 'ViT_scale3_local_new_rp' --g_window_size '18' --d_window_size '12' --g_norm 'pn' --df_dim '384' --d_depth '3' --g_depth '12,0,0,0,0,12' --latent_dim '512' --gf_dim '1024' --num_workers '8' --g_lr '0.0001' --d_lr '0.0001' --optimizer 'adam' --loss 'wgangp-eps' --wd '1e-3' --beta1 '0' --beta2 '0.99' --phi '1' --eval_batch_size '10' --num_eval_imgs '50000' --init_type 'xavier_uniform' --n_critic '4' --val_freq '5000' --print_freq '50' --grow_steps '0' '0' --fade_in '0' --patch_size '4' --diff_aug 'translation,erase_ratio,color' --fid_stat 'fid_stat/fid_stats_church_256.npz' --ema '0.995' --deepspeed --deepspeed_config '/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/examples/ds_config.json'
ec2-34-219-204-184: [2022-10-08 14:53:08,603] [INFO] [launch.py:73:main] 0 NCCL_ALGO ^tree,collnet
ec2-34-219-204-184: [2022-10-08 14:53:08,604] [INFO] [launch.py:73:main] 0 NCCL_DEBUG INFO
ec2-34-219-204-184: [2022-10-08 14:53:08,604] [INFO] [launch.py:79:main] WORLD INFO DICT: {'ec2-34-219-204-184.us-west-2.compute.amazonaws.com': [0, 1, 2, 3], 'ec2-54-244-82-8.us-west-2.compute.amazonaws.com': [0, 1, 2, 3], 'ec2-35-90-65-226.us-west-2.compute.amazonaws.com': [0, 1, 2, 3], 'ec2-35-90-28-66.us-west-2.compute.amazonaws.com': [0, 1, 2, 3]}
ec2-34-219-204-184: [2022-10-08 14:53:08,604] [INFO] [launch.py:88:main] nnodes=4, num_local_procs=4, node_rank=0
ec2-34-219-204-184: [2022-10-08 14:53:08,604] [INFO] [launch.py:98:main] inferring rank maps.
ec2-34-219-204-184: [2022-10-08 14:53:08,604] [INFO] [launch.py:127:main] global_rank_mapping=defaultdict(<class 'list'>, {'ec2-34-219-204-184.us-west-2.compute.amazonaws.com': [0, 1, 2, 3], 'ec2-54-244-82-8.us-west-2.compute.amazonaws.com': [4, 5, 6, 7], 'ec2-35-90-65-226.us-west-2.compute.amazonaws.com': [8, 9, 10, 11], 'ec2-35-90-28-66.us-west-2.compute.amazonaws.com': [12, 13, 14, 15]})
ec2-34-219-204-184: [2022-10-08 14:53:08,604] [INFO] [launch.py:128:main] dist_world_size=16
ec2-34-219-204-184: [2022-10-08 14:53:08,604] [INFO] [launch.py:131:main] Setting CUDA_VISIBLE_DEVICES=0,1,2,3
ec2-35-90-65-226: [2022-10-08 14:53:08,820] [INFO] [launch.py:73:main] 2 NCCL_ALGO ^tree,collnet
ec2-35-90-65-226: [2022-10-08 14:53:08,820] [INFO] [launch.py:73:main] 2 NCCL_DEBUG INFO
ec2-35-90-65-226: [2022-10-08 14:53:08,820] [INFO] [launch.py:79:main] WORLD INFO DICT: {'ec2-34-219-204-184.us-west-2.compute.amazonaws.com': [0, 1, 2, 3], 'ec2-54-244-82-8.us-west-2.compute.amazonaws.com': [0, 1, 2, 3], 'ec2-35-90-65-226.us-west-2.compute.amazonaws.com': [0, 1, 2, 3], 'ec2-35-90-28-66.us-west-2.compute.amazonaws.com': [0, 1, 2, 3]}
ec2-35-90-65-226: [2022-10-08 14:53:08,820] [INFO] [launch.py:88:main] nnodes=4, num_local_procs=4, node_rank=2
ec2-35-90-65-226: [2022-10-08 14:53:08,820] [INFO] [launch.py:98:main] inferring rank maps.
ec2-35-90-65-226: [2022-10-08 14:53:08,820] [INFO] [launch.py:127:main] global_rank_mapping=defaultdict(<class 'list'>, {'ec2-34-219-204-184.us-west-2.compute.amazonaws.com': [0, 1, 2, 3], 'ec2-54-244-82-8.us-west-2.compute.amazonaws.com': [4, 5, 6, 7], 'ec2-35-90-65-226.us-west-2.compute.amazonaws.com': [8, 9, 10, 11], 'ec2-35-90-28-66.us-west-2.compute.amazonaws.com': [12, 13, 14, 15]})
ec2-35-90-65-226: [2022-10-08 14:53:08,820] [INFO] [launch.py:128:main] dist_world_size=16
ec2-35-90-65-226: [2022-10-08 14:53:08,820] [INFO] [launch.py:131:main] Setting CUDA_VISIBLE_DEVICES=0,1,2,3
ec2-54-244-82-8: [2022-10-08 14:53:08,823] [INFO] [launch.py:73:main] 1 NCCL_ALGO ^tree,collnet
ec2-54-244-82-8: [2022-10-08 14:53:08,823] [INFO] [launch.py:73:main] 1 NCCL_DEBUG INFO
ec2-54-244-82-8: [2022-10-08 14:53:08,824] [INFO] [launch.py:79:main] WORLD INFO DICT: {'ec2-34-219-204-184.us-west-2.compute.amazonaws.com': [0, 1, 2, 3], 'ec2-54-244-82-8.us-west-2.compute.amazonaws.com': [0, 1, 2, 3], 'ec2-35-90-65-226.us-west-2.compute.amazonaws.com': [0, 1, 2, 3], 'ec2-35-90-28-66.us-west-2.compute.amazonaws.com': [0, 1, 2, 3]}
ec2-54-244-82-8: [2022-10-08 14:53:08,824] [INFO] [launch.py:88:main] nnodes=4, num_local_procs=4, node_rank=1
ec2-54-244-82-8: [2022-10-08 14:53:08,824] [INFO] [launch.py:98:main] inferring rank maps.
ec2-54-244-82-8: [2022-10-08 14:53:08,824] [INFO] [launch.py:127:main] global_rank_mapping=defaultdict(<class 'list'>, {'ec2-34-219-204-184.us-west-2.compute.amazonaws.com': [0, 1, 2, 3], 'ec2-54-244-82-8.us-west-2.compute.amazonaws.com': [4, 5, 6, 7], 'ec2-35-90-65-226.us-west-2.compute.amazonaws.com': [8, 9, 10, 11], 'ec2-35-90-28-66.us-west-2.compute.amazonaws.com': [12, 13, 14, 15]})
ec2-54-244-82-8: [2022-10-08 14:53:08,824] [INFO] [launch.py:128:main] dist_world_size=16
ec2-54-244-82-8: [2022-10-08 14:53:08,824] [INFO] [launch.py:131:main] Setting CUDA_VISIBLE_DEVICES=0,1,2,3
ec2-34-219-204-184: using world size: 16 and model-parallel size: 1 
ec2-34-219-204-184: using torch.float16 for parameters ...
ec2-34-219-204-184: -------------------- arguments --------------------
ec2-35-90-65-226: hi hi debug before: {args.rank} {torch.cuda.current_device()}
ec2-34-219-204-184:   accumulated_times ............... 4
ec2-34-219-204-184:   adam_beta1 ...................... 0.9
ec2-34-219-204-184:   adam_beta2 ...................... 0.999
ec2-34-219-204-184:   adam_eps ........................ 1e-08
ec2-34-219-204-184:   adlr_autoresume ................. False
ec2-34-219-204-184:   adlr_autoresume_interval ........ 1000
ec2-34-219-204-184:   apply_query_key_layer_scaling ... False
ec2-34-219-204-184:   apply_residual_connection_post_layernorm  False
ec2-34-219-204-184:   arch ............................ None
ec2-34-219-204-184:   attention_dropout ............... 0.1
ec2-34-219-204-184:   attention_softmax_in_fp32 ....... False
ec2-34-219-204-184:   baseline_decay .................. 0.9
ec2-34-219-204-184:   batch_size ...................... 1
ec2-34-219-204-184:   bert_load ....................... None
ec2-34-219-204-184:   beta1 ........................... 0.0
ec2-34-219-204-184:   beta2 ........................... 0.99
ec2-34-219-204-184:   bias_dropout_fusion ............. False
ec2-34-219-204-184:   bias_gelu_fusion ................ False
ec2-34-219-204-184:   block_data_path ................. None
ec2-34-219-204-184:   bottom_width .................... 9
ec2-34-219-204-184:   channels ........................ 3
ec2-34-219-204-184:   checkpoint_activations .......... False
ec2-34-219-204-184:   checkpoint_in_cpu ............... False
ec2-34-219-204-184:   checkpoint_num_layers ........... 1
ec2-35-90-65-226: hi hi debug before: {args.rank} {torch.cuda.current_device()}
ec2-34-219-204-184:   clip_grad ....................... 1.0
ec2-34-219-204-184:   contigious_checkpointing ........ False
ec2-34-219-204-184:   controller ...................... controller
ec2-34-219-204-184:   cpu_optimizer ................... False
ec2-34-219-204-184:   cpu_torch_adam .................. False
ec2-34-219-204-184:   ctrl_lr ......................... 0.00035
ec2-34-219-204-184:   ctrl_sample_batch ............... 1
ec2-34-219-204-184:   ctrl_step ....................... 30
ec2-34-219-204-184:   d_act ........................... gelu
ec2-34-219-204-184:   d_depth ......................... 3
ec2-34-219-204-184:   D_downsample .................... avg
ec2-34-219-204-184:   d_heads ......................... 4
ec2-34-219-204-184:   d_lr ............................ 0.0001
ec2-34-219-204-184:   d_mlp ........................... 4
ec2-34-219-204-184:   d_norm .......................... ln
ec2-34-219-204-184:   d_spectral_norm ................. False
ec2-34-219-204-184:   d_window_size ................... 12
ec2-34-219-204-184:   data_impl ....................... mmap
ec2-34-219-204-184:   data_path ....................... ./lsun
ec2-34-219-204-184:   dataset ......................... church
ec2-34-219-204-184:   DDP_impl ........................ local
ec2-34-219-204-184:   deepscale ....................... False
ec2-34-219-204-184:   deepscale_config ................ None
ec2-34-219-204-184:   deepspeed ....................... True
ec2-34-219-204-184:   deepspeed_activation_checkpointing  False
ec2-34-219-204-184:   deepspeed_config ................ /home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/examples/ds_config.json
ec2-34-219-204-184:   deepspeed_mpi ................... False
ec2-34-219-204-184:   df_dim .......................... 384
ec2-34-219-204-184:   diff_aug ........................ translation,erase_ratio,color
ec2-34-219-204-184:   dis_batch_size .................. 16
ec2-34-219-204-184:   dis_model ....................... ViT_scale3_local_new_rp
ec2-34-219-204-184:   dist_backend .................... nccl
ec2-34-219-204-184:   dist_url ........................ tcp://localhost:10641
ec2-34-219-204-184:   distribute_checkpointed_activations  False
ec2-34-219-204-184:   distributed_backend ............. nccl
ec2-34-219-204-184:   dropout ......................... 0.0
ec2-34-219-204-184:   dynamic_loss_scale .............. True
ec2-34-219-204-184:   dynamic_reset_threshold ......... 0.001
ec2-34-219-204-184:   dynamic_reset_window ............ 500
ec2-34-219-204-184:   ema ............................. 0.995
ec2-34-219-204-184:   ema_kimg ........................ 500
ec2-34-219-204-184:   ema_warmup ...................... 0.0
ec2-34-219-204-184:   entropy_coeff ................... 0.001
ec2-34-219-204-184:   eod_mask_loss ................... False
ec2-34-219-204-184:   eval_batch_size ................. 10
ec2-34-219-204-184:   eval_interval ................... 100000
ec2-34-219-204-184:   eval_iters ...................... 10000
ec2-34-219-204-184:   exit_interval ................... None
ec2-34-219-204-184:   exp_name ........................ simulate_het_model
ec2-34-219-204-184:   fade_in ......................... 0.0
ec2-34-219-204-184:   faiss_use_gpu ................... False
ec2-34-219-204-184:   fid_stat ........................ fid_stat/fid_stats_church_256.npz
ec2-34-219-204-184:   finetune ........................ False
ec2-34-219-204-184:   fp16 ............................ True
ec2-34-219-204-184:   fp16_lm_cross_entropy ........... False
ec2-34-219-204-184:   fp32_allreduce .................. False
ec2-34-219-204-184:   g_accumulated_times ............. 8
ec2-34-219-204-184:   g_act ........................... gelu
ec2-34-219-204-184:   g_depth ......................... 12,0,0,0,0,12
ec2-34-219-204-184:   g_lr ............................ 0.0001
ec2-34-219-204-184:   g_mlp ........................... 4
ec2-34-219-204-184:   g_norm .......................... pn
ec2-34-219-204-184:   g_spectral_norm ................. False
ec2-34-219-204-184:   g_window_size ................... 18
ec2-34-219-204-184:   gas ............................. 16
ec2-34-219-204-184:   gen_batch_size .................. 16
ec2-34-219-204-184:   gen_model ....................... ViT_custom_local544444_256_rp_noise
ec2-34-219-204-184:   gf_dim .......................... 1024
ec2-34-219-204-184:   gpu ............................. None
ec2-34-219-204-184:   grow_step1 ...................... 25
ec2-34-219-204-184:   grow_step2 ...................... 55
ec2-34-219-204-184:   grow_steps ...................... [0, 0]
ec2-34-219-204-184:   hid_size ........................ 100
ec2-34-219-204-184:   hidden_dropout .................. 0.1
ec2-34-219-204-184:   hidden_size ..................... 1024
ec2-34-219-204-184:   hysteresis ...................... 2
ec2-34-219-204-184:   ict_head_size ................... None
ec2-34-219-204-184:   ict_load ........................ None
ec2-34-219-204-184:   img_size ........................ 256
ec2-34-219-204-184:   indexer_batch_size .............. 128
ec2-34-219-204-184:   indexer_log_interval ............ 1000
ec2-34-219-204-184:   init_method_std ................. 0.02
ec2-34-219-204-184:   init_type ....................... xavier_uniform
ec2-34-219-204-184:   latent_dim ...................... 512
ec2-34-219-204-184:   latent_norm ..................... False
ec2-34-219-204-184:   layernorm_epsilon ............... 1e-05
ec2-34-219-204-184:   lazy_mpu_init ................... None
ec2-34-219-204-184:   load ............................ /home/ubuntu/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/examples/ckpts/gpt2_1542m_ds_distributed
ec2-34-219-204-184:   load_path ....................... None
ec2-34-219-204-184:   loca_rank ....................... -1
ec2-34-219-204-184:   local_rank ...................... 0
ec2-34-219-204-184:   log_interval .................... 20
ec2-34-219-204-184:   loss ............................ wgangp-eps
ec2-34-219-204-184:   loss_scale ...................... None
ec2-34-219-204-184:   loss_scale_window ............... 1000
ec2-34-219-204-184:   lr .............................. 0.00015
ec2-34-219-204-184:   lr_decay ........................ False
ec2-34-219-204-184:   lr_decay_iters .................. 320000
ec2-34-219-204-184:   lr_decay_style .................. cosine
ec2-34-219-204-184:   make_vocab_size_divisible_by .... 128
ec2-34-219-204-184:   mask_prob ....................... 0.15
ec2-34-219-204-184:   max_epoch ....................... 200
ec2-34-219-204-184:   max_iter ........................ 500000
ec2-34-219-204-184:   max_position_embeddings ......... 1024
ec2-34-219-204-184:   max_search_iter ................. 90
ec2-34-219-204-184:   merge_file ...................... /home/ubuntu/datasets/datasets/gpt2-merges.txt
ec2-34-219-204-184:   min_lr .......................... 1e-05
ec2-34-219-204-184:   min_scale ....................... 1
ec2-34-219-204-184:   ministd ......................... False
ec2-34-219-204-184:   mmap_warmup ..................... False
ec2-34-219-204-184:   model_parallel_size ............. 1
ec2-34-219-204-184:   multiprocessing_distributed ..... False
ec2-34-219-204-184:   n_classes ....................... 0
ec2-34-219-204-184:   n_critic ........................ 4
ec2-34-219-204-184:   no_load_optim ................... False
ec2-34-219-204-184:   no_load_rng ..................... False
ec2-34-219-204-184:   no_save_optim ................... False
ec2-34-219-204-184:   no_save_rng ..................... False
ec2-34-219-204-184:   num_attention_heads ............. 1
ec2-34-219-204-184:   num_candidate ................... 10
ec2-34-219-204-184:   num_eval_imgs ................... 50000
ec2-34-219-204-184:   num_landmarks ................... 64
ec2-34-219-204-184:   num_layers ...................... 24
ec2-34-219-204-184:   num_unique_layers ............... None
ec2-34-219-204-184:   num_workers ..................... 8
ec2-34-219-204-184:   onnx_safe ....................... None
ec2-34-219-204-184:   openai_gelu ..................... False
ec2-34-219-204-184:   optimizer ....................... adam
ec2-34-219-204-184:   override_lr_scheduler ........... False
ec2-34-219-204-184:   param_sharing_style ............. grouped
ec2-34-219-204-184:   params_dtype .................... torch.float16
ec2-34-219-204-184:   partition_activations ........... False
ec2-34-219-204-184:   patch_size ...................... 4
ec2-34-219-204-184:   phi ............................. 1.0
ec2-34-219-204-184:   pipe_parallel_size .............. 4
ec2-34-219-204-184:   print_freq ...................... 50
ec2-34-219-204-184:   profile_backward ................ False
ec2-34-219-204-184:   query_in_block_prob ............. 0.1
ec2-34-219-204-184:   random_seed ..................... 12345
ec2-34-219-204-184:   rank ............................ 0
ec2-34-219-204-184:   report_topk_accuracies .......... []
ec2-34-219-204-184:   reset_attention_mask ............ False
ec2-34-219-204-184:   reset_position_ids .............. False
ec2-34-219-204-184:   rl_num_eval_img ................. 5000
ec2-35-90-65-226: hi hi debug before: {args.rank} {torch.cuda.current_device()}
ec2-34-219-204-184:   save ............................ /home/ubuntu/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/examples/ckpts/gpt2_1542m_ds_distributed
ec2-34-219-204-184:   save_interval ................... 50000
ec2-34-219-204-184:   scaled_masked_softmax_fusion .... False
ec2-34-219-204-184:   scaled_upper_triang_masked_softmax_fusion  False
ec2-34-219-204-184:   seed ............................ 1234
ec2-34-219-204-184:   seq_length ...................... 1024
ec2-34-219-204-184:   shared_epoch .................... 15
ec2-34-219-204-184:   short_seq_prob .................. 0.1
ec2-34-219-204-184:   show ............................ False
ec2-34-219-204-184:   split ........................... 949,50,1
ec2-34-219-204-184:   synchronize_each_layer .......... False
ec2-34-219-204-184:   tensorboard_dir ................. tensorboard_data/24l_1024h_n_g_4pp_1mp_1b_ds4
ec2-34-219-204-184:   titles_data_path ................ None
ec2-34-219-204-184:   tokenizer_type .................. GPT2BPETokenizer
ec2-34-219-204-184:   topk ............................ 5
ec2-34-219-204-184:   train_iters ..................... 320000
ec2-34-219-204-184:   use_checkpoint_lr_scheduler ..... False
ec2-34-219-204-184:   use_cpu_initialization .......... False
ec2-34-219-204-184:   use_one_sent_docs ............... False
ec2-34-219-204-184:   val_freq ........................ 5000
ec2-34-219-204-184:   vocab_file ...................... /home/ubuntu/datasets/datasets/gpt2-vocab.json
ec2-34-219-204-184:   warmup .......................... 0.01
ec2-34-219-204-184:   wd .............................. 0.001
ec2-34-219-204-184:   weight_decay .................... 0.01
ec2-34-219-204-184:   world_size ...................... 16
ec2-34-219-204-184:   zero_allgather_bucket_size ...... 0.0
ec2-34-219-204-184:   zero_contigious_gradients ....... False
ec2-35-90-65-226: hi hi debug before: {args.rank} {torch.cuda.current_device()}
ec2-34-219-204-184:   zero_reduce_bucket_size ......... 0.0
ec2-34-219-204-184:   zero_reduce_scatter ............. False
ec2-34-219-204-184:   zero_stage ...................... 1.0
ec2-34-219-204-184: ---------------- end of arguments ----------------
ec2-34-219-204-184: > building GPT2BPETokenizer tokenizer ...
ec2-35-90-65-226: hi hi debug after: {args.rank} {torch.cuda.current_device()}
ec2-35-90-65-226: init with 10/16 tcp://172.31.41.243:9005 2
ec2-35-90-65-226: hi hi debug after: {args.rank} {torch.cuda.current_device()}
ec2-35-90-65-226: init with 11/16 tcp://172.31.41.243:9005 3
ec2-35-90-65-226: hi hi debug after: {args.rank} {torch.cuda.current_device()}
ec2-35-90-65-226: init with 9/16 tcp://172.31.41.243:9005 1
ec2-35-90-65-226: hi hi debug after: {args.rank} {torch.cuda.current_device()}
ec2-35-90-65-226: init with 8/16 tcp://172.31.41.243:9005 0
ec2-34-219-204-184: hi hi debug before: {args.rank} {torch.cuda.current_device()}
ec2-34-219-204-184: hi hi debug before: {args.rank} {torch.cuda.current_device()}
ec2-34-219-204-184:  > padded vocab (size: 50257) with 47 dummy tokens (new size: 50304)
ec2-34-219-204-184: hi hi debug before: {args.rank} {torch.cuda.current_device()}
ec2-34-219-204-184: WARNING: TensorBoard writing requested but is not available (are you using PyTorch 1.1.0 or later?), no TensorBoard logs will be written.
ec2-34-219-204-184: > initializing torch distributed ...
ec2-34-219-204-184: hi hi debug before: {args.rank} {torch.cuda.current_device()}
ec2-34-219-204-184: hi hi debug after: {args.rank} {torch.cuda.current_device()}
ec2-34-219-204-184: init with 2/16 tcp://172.31.41.243:9005 2
ec2-34-219-204-184: hi hi debug after: {args.rank} {torch.cuda.current_device()}
ec2-34-219-204-184: init with 1/16 tcp://172.31.41.243:9005 1
ec2-34-219-204-184: hi hi debug after: {args.rank} {torch.cuda.current_device()}
ec2-34-219-204-184: init with 3/16 tcp://172.31.41.243:9005 3
ec2-34-219-204-184: hi hi debug after: {args.rank} {torch.cuda.current_device()}
ec2-34-219-204-184: init with 0/16 tcp://172.31.41.243:9005 0
ec2-54-244-82-8: hi hi debug before: {args.rank} {torch.cuda.current_device()}hi hi debug before: {args.rank} {torch.cuda.current_device()}
ec2-54-244-82-8: 
ec2-54-244-82-8: hi hi debug before: {args.rank} {torch.cuda.current_device()}
ec2-54-244-82-8: hi hi debug before: {args.rank} {torch.cuda.current_device()}
ec2-54-244-82-8: hi hi debug after: {args.rank} {torch.cuda.current_device()}
ec2-54-244-82-8: init with 5/16 tcp://172.31.41.243:9005 1
ec2-54-244-82-8: hi hi debug after: {args.rank} {torch.cuda.current_device()}
ec2-54-244-82-8: init with 4/16 tcp://172.31.41.243:9005 0
ec2-54-244-82-8: hi hi debug after: {args.rank} {torch.cuda.current_device()}
ec2-54-244-82-8: init with 6/16 tcp://172.31.41.243:9005 2
ec2-54-244-82-8: hi hi debug after: {args.rank} {torch.cuda.current_device()}
ec2-54-244-82-8: init with 7/16 tcp://172.31.41.243:9005 3
ec2-35-90-28-66: [2022-10-08 14:53:12,891] [INFO] [launch.py:73:main] 3 NCCL_ALGO ^tree,collnet
ec2-35-90-28-66: [2022-10-08 14:53:12,891] [INFO] [launch.py:73:main] 3 NCCL_DEBUG INFO
ec2-35-90-28-66: [2022-10-08 14:53:12,891] [INFO] [launch.py:79:main] WORLD INFO DICT: {'ec2-34-219-204-184.us-west-2.compute.amazonaws.com': [0, 1, 2, 3], 'ec2-54-244-82-8.us-west-2.compute.amazonaws.com': [0, 1, 2, 3], 'ec2-35-90-65-226.us-west-2.compute.amazonaws.com': [0, 1, 2, 3], 'ec2-35-90-28-66.us-west-2.compute.amazonaws.com': [0, 1, 2, 3]}
ec2-35-90-28-66: [2022-10-08 14:53:12,891] [INFO] [launch.py:88:main] nnodes=4, num_local_procs=4, node_rank=3
ec2-35-90-28-66: [2022-10-08 14:53:12,891] [INFO] [launch.py:98:main] inferring rank maps.
ec2-35-90-28-66: [2022-10-08 14:53:12,891] [INFO] [launch.py:127:main] global_rank_mapping=defaultdict(<class 'list'>, {'ec2-34-219-204-184.us-west-2.compute.amazonaws.com': [0, 1, 2, 3], 'ec2-54-244-82-8.us-west-2.compute.amazonaws.com': [4, 5, 6, 7], 'ec2-35-90-65-226.us-west-2.compute.amazonaws.com': [8, 9, 10, 11], 'ec2-35-90-28-66.us-west-2.compute.amazonaws.com': [12, 13, 14, 15]})
ec2-35-90-28-66: [2022-10-08 14:53:12,892] [INFO] [launch.py:128:main] dist_world_size=16
ec2-35-90-28-66: [2022-10-08 14:53:12,892] [INFO] [launch.py:131:main] Setting CUDA_VISIBLE_DEVICES=0,1,2,3
ec2-35-90-28-66: hi hi debug before: {args.rank} {torch.cuda.current_device()}hi hi debug before: {args.rank} {torch.cuda.current_device()}
ec2-35-90-28-66: 
ec2-35-90-28-66: hi hi debug before: {args.rank} {torch.cuda.current_device()}
ec2-35-90-28-66: hi hi debug before: {args.rank} {torch.cuda.current_device()}
ec2-35-90-28-66: hi hi debug after: {args.rank} {torch.cuda.current_device()}
ec2-35-90-28-66: init with 14/16 tcp://172.31.41.243:9005 2
ec2-35-90-28-66: hi hi debug after: {args.rank} {torch.cuda.current_device()}
ec2-35-90-28-66: init with 15/16 tcp://172.31.41.243:9005 3
ec2-35-90-28-66: hi hi debug after: {args.rank} {torch.cuda.current_device()}
ec2-35-90-28-66: init with 13/16 tcp://172.31.41.243:9005 1
ec2-35-90-28-66: hi hi debug after: {args.rank} {torch.cuda.current_device()}
ec2-35-90-28-66: init with 12/16 tcp://172.31.41.243:9005 0
ec2-34-219-204-184: ip-172-31-41-243:10714:10714 [0] NCCL INFO Bootstrap : Using [0]ens3:172.31.41.243<0>
ec2-34-219-204-184: ip-172-31-41-243:10714:10714 [0] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
ec2-34-219-204-184: ip-172-31-41-243:10714:10714 [0] NCCL INFO NET/IB : No device found.
ec2-34-219-204-184: ip-172-31-41-243:10714:10714 [0] NCCL INFO NET/Socket : Using [0]ens3:172.31.41.243<0>
ec2-34-219-204-184: ip-172-31-41-243:10714:10714 [0] NCCL INFO Using network Socket
ec2-34-219-204-184: NCCL version 2.7.8+cuda11.0
ec2-34-219-204-184: ip-172-31-41-243:10716:10716 [2] NCCL INFO Bootstrap : Using [0]ens3:172.31.41.243<0>
ec2-34-219-204-184: ip-172-31-41-243:10715:10715 [1] NCCL INFO Bootstrap : Using [0]ens3:172.31.41.243<0>
ec2-34-219-204-184: ip-172-31-41-243:10717:10717 [3] NCCL INFO Bootstrap : Using [0]ens3:172.31.41.243<0>
ec2-34-219-204-184: ip-172-31-41-243:10716:10716 [2] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
ec2-34-219-204-184: ip-172-31-41-243:10715:10715 [1] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
ec2-34-219-204-184: ip-172-31-41-243:10717:10717 [3] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
ec2-34-219-204-184: ip-172-31-41-243:10716:10716 [2] NCCL INFO NET/IB : No device found.
ec2-34-219-204-184: ip-172-31-41-243:10717:10717 [3] NCCL INFO NET/IB : No device found.
ec2-34-219-204-184: ip-172-31-41-243:10715:10715 [1] NCCL INFO NET/IB : No device found.
ec2-35-90-65-226: ip-172-31-38-78:3918:3918 [2] NCCL INFO Bootstrap : Using [0]ens3:172.31.38.78<0>
ec2-35-90-65-226: ip-172-31-38-78:3917:3917 [1] NCCL INFO Bootstrap : Using [0]ens3:172.31.38.78<0>
ec2-35-90-65-226: ip-172-31-38-78:3919:3919 [3] NCCL INFO Bootstrap : Using [0]ens3:172.31.38.78<0>
ec2-35-90-65-226: ip-172-31-38-78:3916:3916 [0] NCCL INFO Bootstrap : Using [0]ens3:172.31.38.78<0>
ec2-54-244-82-8: ip-172-31-44-10:14967:14967 [3] NCCL INFO Bootstrap : Using [0]ens3:172.31.44.10<0>
ec2-54-244-82-8: ip-172-31-44-10:14965:14965 [1] NCCL INFO Bootstrap : Using [0]ens3:172.31.44.10<0>
ec2-54-244-82-8: ip-172-31-44-10:14966:14966 [2] NCCL INFO Bootstrap : Using [0]ens3:172.31.44.10<0>
ec2-54-244-82-8: ip-172-31-44-10:14964:14964 [0] NCCL INFO Bootstrap : Using [0]ens3:172.31.44.10<0>
ec2-35-90-65-226: ip-172-31-38-78:3918:3918 [2] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
ec2-35-90-65-226: ip-172-31-38-78:3919:3919 [3] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
ec2-35-90-65-226: ip-172-31-38-78:3917:3917 [1] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
ec2-35-90-65-226: ip-172-31-38-78:3916:3916 [0] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
ec2-34-219-204-184: ip-172-31-41-243:10717:10717 [3] NCCL INFO NET/Socket : Using [0]ens3:172.31.41.243<0>
ec2-34-219-204-184: ip-172-31-41-243:10715:10715 [1] NCCL INFO NET/Socket : Using [0]ens3:172.31.41.243<0>
ec2-34-219-204-184: ip-172-31-41-243:10716:10716 [2] NCCL INFO NET/Socket : Using [0]ens3:172.31.41.243<0>
ec2-34-219-204-184: ip-172-31-41-243:10715:10715 [1] NCCL INFO Using network Socket
ec2-34-219-204-184: ip-172-31-41-243:10717:10717 [3] NCCL INFO Using network Socket
ec2-34-219-204-184: ip-172-31-41-243:10716:10716 [2] NCCL INFO Using network Socket
ec2-54-244-82-8: ip-172-31-44-10:14966:14966 [2] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
ec2-54-244-82-8: ip-172-31-44-10:14967:14967 [3] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
ec2-54-244-82-8: ip-172-31-44-10:14965:14965 [1] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
ec2-54-244-82-8: ip-172-31-44-10:14964:14964 [0] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
ec2-35-90-65-226: ip-172-31-38-78:3918:3918 [2] NCCL INFO NET/IB : No device found.
ec2-35-90-65-226: ip-172-31-38-78:3916:3916 [0] NCCL INFO NET/IB : No device found.
ec2-35-90-65-226: ip-172-31-38-78:3919:3919 [3] NCCL INFO NET/IB : No device found.
ec2-35-90-65-226: ip-172-31-38-78:3917:3917 [1] NCCL INFO NET/IB : No device found.
ec2-54-244-82-8: ip-172-31-44-10:14964:14964 [0] NCCL INFO NET/IB : No device found.
ec2-54-244-82-8: ip-172-31-44-10:14965:14965 [1] NCCL INFO NET/IB : No device found.
ec2-54-244-82-8: ip-172-31-44-10:14967:14967 [3] NCCL INFO NET/IB : No device found.
ec2-54-244-82-8: ip-172-31-44-10:14966:14966 [2] NCCL INFO NET/IB : No device found.
ec2-35-90-65-226: ip-172-31-38-78:3917:3917 [1] NCCL INFO NET/Socket : Using [0]ens3:172.31.38.78<0>
ec2-35-90-65-226: ip-172-31-38-78:3919:3919 [3] NCCL INFO NET/Socket : Using [0]ens3:172.31.38.78<0>
ec2-35-90-65-226: ip-172-31-38-78:3916:3916 [0] NCCL INFO NET/Socket : Using [0]ens3:172.31.38.78<0>
ec2-35-90-65-226: ip-172-31-38-78:3918:3918 [2] NCCL INFO NET/Socket : Using [0]ens3:172.31.38.78<0>
ec2-35-90-65-226: ip-172-31-38-78:3919:3919 [3] NCCL INFO Using network Socket
ec2-35-90-65-226: ip-172-31-38-78:3917:3917 [1] NCCL INFO Using network Socket
ec2-35-90-65-226: ip-172-31-38-78:3918:3918 [2] NCCL INFO Using network Socket
ec2-35-90-65-226: ip-172-31-38-78:3916:3916 [0] NCCL INFO Using network Socket
ec2-54-244-82-8: ip-172-31-44-10:14965:14965 [1] NCCL INFO NET/Socket : Using [0]ens3:172.31.44.10<0>
ec2-54-244-82-8: ip-172-31-44-10:14966:14966 [2] NCCL INFO NET/Socket : Using [0]ens3:172.31.44.10<0>
ec2-54-244-82-8: ip-172-31-44-10:14967:14967 [3] NCCL INFO NET/Socket : Using [0]ens3:172.31.44.10<0>
ec2-54-244-82-8: ip-172-31-44-10:14964:14964 [0] NCCL INFO NET/Socket : Using [0]ens3:172.31.44.10<0>
ec2-54-244-82-8: ip-172-31-44-10:14966:14966 [2] NCCL INFO Using network Socket
ec2-54-244-82-8: ip-172-31-44-10:14965:14965 [1] NCCL INFO Using network Socket
ec2-54-244-82-8: ip-172-31-44-10:14967:14967 [3] NCCL INFO Using network Socket
ec2-54-244-82-8: ip-172-31-44-10:14964:14964 [0] NCCL INFO Using network Socket
ec2-35-90-28-66: ip-172-31-39-36:4023:4023 [0] NCCL INFO Bootstrap : Using [0]ens3:172.31.39.36<0>
ec2-35-90-28-66: ip-172-31-39-36:4023:4023 [0] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
ec2-35-90-28-66: ip-172-31-39-36:4025:4025 [2] NCCL INFO Bootstrap : Using [0]ens3:172.31.39.36<0>
ec2-35-90-28-66: ip-172-31-39-36:4025:4025 [2] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
ec2-35-90-28-66: ip-172-31-39-36:4026:4026 [3] NCCL INFO Bootstrap : Using [0]ens3:172.31.39.36<0>
ec2-35-90-28-66: ip-172-31-39-36:4026:4026 [3] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
ec2-35-90-28-66: ip-172-31-39-36:4026:4026 [3] NCCL INFO NET/IB : No device found.
ec2-35-90-28-66: ip-172-31-39-36:4023:4023 [0] NCCL INFO NET/IB : No device found.
ec2-35-90-28-66: ip-172-31-39-36:4025:4025 [2] NCCL INFO NET/IB : No device found.
ec2-35-90-28-66: ip-172-31-39-36:4023:4023 [0] NCCL INFO NET/Socket : Using [0]ens3:172.31.39.36<0>
ec2-35-90-28-66: ip-172-31-39-36:4025:4025 [2] NCCL INFO NET/Socket : Using [0]ens3:172.31.39.36<0>
ec2-35-90-28-66: ip-172-31-39-36:4026:4026 [3] NCCL INFO NET/Socket : Using [0]ens3:172.31.39.36<0>
ec2-35-90-28-66: ip-172-31-39-36:4025:4025 [2] NCCL INFO Using network Socket
ec2-35-90-28-66: ip-172-31-39-36:4026:4026 [3] NCCL INFO Using network Socket
ec2-35-90-28-66: ip-172-31-39-36:4023:4023 [0] NCCL INFO Using network Socket
ec2-35-90-28-66: ip-172-31-39-36:4024:4024 [1] NCCL INFO Bootstrap : Using [0]ens3:172.31.39.36<0>
ec2-35-90-28-66: ip-172-31-39-36:4024:4024 [1] NCCL INFO NET/Plugin : No plugin found (libnccl-net.so), using internal implementation
ec2-35-90-28-66: ip-172-31-39-36:4024:4024 [1] NCCL INFO NET/IB : No device found.
ec2-35-90-28-66: ip-172-31-39-36:4024:4024 [1] NCCL INFO NET/Socket : Using [0]ens3:172.31.39.36<0>
ec2-35-90-28-66: ip-172-31-39-36:4024:4024 [1] NCCL INFO Using network Socket
ec2-35-90-28-66: ip-172-31-39-36:4026:4345 [3] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 8/8/64
ec2-35-90-28-66: ip-172-31-39-36:4026:4345 [3] NCCL INFO Trees [0] -1/-1/-1->15->14|14->15->-1/-1/-1 [1] -1/-1/-1->15->14|14->15->-1/-1/-1
ec2-34-219-204-184: ip-172-31-41-243:10714:11564 [0] NCCL INFO Channel 00/02 :    0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15
ec2-34-219-204-184: ip-172-31-41-243:10714:11564 [0] NCCL INFO Channel 01/02 :    0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15
ec2-34-219-204-184: ip-172-31-41-243:10715:11567 [1] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 8/8/64
ec2-34-219-204-184: ip-172-31-41-243:10715:11567 [1] NCCL INFO Trees [0] 2/8/-1->1->0|0->1->2/8/-1 [1] 2/-1/-1->1->0|0->1->2/-1/-1
ec2-34-219-204-184: ip-172-31-41-243:10716:11568 [2] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 8/8/64
ec2-34-219-204-184: ip-172-31-41-243:10716:11568 [2] NCCL INFO Trees [0] 3/-1/-1->2->1|1->2->3/-1/-1 [1] 3/-1/-1->2->1|1->2->3/-1/-1
ec2-34-219-204-184: ip-172-31-41-243:10714:11564 [0] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 8/8/64
ec2-34-219-204-184: ip-172-31-41-243:10714:11564 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1|-1->0->1/-1/-1 [1] 1/-1/-1->0->13|13->0->1/-1/-1
ec2-34-219-204-184: ip-172-31-41-243:10717:11566 [3] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 8/8/64
ec2-34-219-204-184: ip-172-31-41-243:10717:11566 [3] NCCL INFO Trees [0] -1/-1/-1->3->2|2->3->-1/-1/-1 [1] -1/-1/-1->3->2|2->3->-1/-1/-1
ec2-54-244-82-8: ip-172-31-44-10:14967:15817 [3] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 8/8/64
ec2-54-244-82-8: ip-172-31-44-10:14967:15817 [3] NCCL INFO Trees [0] -1/-1/-1->7->6|6->7->-1/-1/-1 [1] -1/-1/-1->7->6|6->7->-1/-1/-1
ec2-54-244-82-8: ip-172-31-44-10:14965:15820 [1] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 8/8/64
ec2-54-244-82-8: ip-172-31-44-10:14966:15818 [2] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 8/8/64
ec2-54-244-82-8: ip-172-31-44-10:14965:15820 [1] NCCL INFO Trees [0] 6/-1/-1->5->4|4->5->6/-1/-1 [1] 6/12/-1->5->4|4->5->6/12/-1
ec2-54-244-82-8: ip-172-31-44-10:14966:15818 [2] NCCL INFO Trees [0] 7/-1/-1->6->5|5->6->7/-1/-1 [1] 7/-1/-1->6->5|5->6->7/-1/-1
ec2-54-244-82-8: ip-172-31-44-10:14964:15819 [0] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 8/8/64
ec2-54-244-82-8: ip-172-31-44-10:14964:15819 [0] NCCL INFO Trees [0] 5/-1/-1->4->9|9->4->5/-1/-1 [1] 5/-1/-1->4->-1|-1->4->5/-1/-1
ec2-35-90-65-226: ip-172-31-38-78:3916:4233 [0] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 8/8/64
ec2-35-90-65-226: ip-172-31-38-78:3916:4233 [0] NCCL INFO Trees [0] 9/-1/-1->8->1|1->8->9/-1/-1 [1] 9/-1/-1->8->13|13->8->9/-1/-1
ec2-35-90-65-226: ip-172-31-38-78:3917:4230 [1] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 8/8/64
ec2-35-90-65-226: ip-172-31-38-78:3917:4230 [1] NCCL INFO Trees [0] 10/4/12->9->8|8->9->10/4/12 [1] 10/-1/-1->9->8|8->9->10/-1/-1
ec2-35-90-65-226: ip-172-31-38-78:3919:4231 [3] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 8/8/64
ec2-35-90-65-226: ip-172-31-38-78:3918:4232 [2] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 8/8/64
ec2-35-90-65-226: ip-172-31-38-78:3919:4231 [3] NCCL INFO Trees [0] -1/-1/-1->11->10|10->11->-1/-1/-1 [1] -1/-1/-1->11->10|10->11->-1/-1/-1
ec2-35-90-65-226: ip-172-31-38-78:3918:4232 [2] NCCL INFO Trees [0] 11/-1/-1->10->9|9->10->11/-1/-1 [1] 11/-1/-1->10->9|9->10->11/-1/-1
ec2-35-90-28-66: ip-172-31-39-36:4023:4344 [0] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 8/8/64
ec2-35-90-28-66: ip-172-31-39-36:4023:4344 [0] NCCL INFO Trees [0] 13/-1/-1->12->9|9->12->13/-1/-1 [1] 13/-1/-1->12->5|5->12->13/-1/-1
ec2-35-90-28-66: ip-172-31-39-36:4024:4347 [1] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 8/8/64
ec2-35-90-28-66: ip-172-31-39-36:4025:4346 [2] NCCL INFO threadThresholds 8/8/64 | 128/8/64 | 8/8/64
ec2-35-90-28-66: ip-172-31-39-36:4024:4347 [1] NCCL INFO Trees [0] 14/-1/-1->13->12|12->13->14/-1/-1 [1] 14/8/0->13->12|12->13->14/8/0
ec2-35-90-28-66: ip-172-31-39-36:4025:4346 [2] NCCL INFO Trees [0] 15/-1/-1->14->13|13->14->15/-1/-1 [1] 15/-1/-1->14->13|13->14->15/-1/-1
ec2-35-90-28-66: ip-172-31-39-36:4024:4347 [1] NCCL INFO Channel 00 : 13[1c0] -> 14[1d0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10715:11567 [1] NCCL INFO Channel 00 : 1[1c0] -> 2[1d0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10716:11568 [2] NCCL INFO Channel 00 : 2[1d0] -> 3[1e0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4025:4346 [2] NCCL INFO Channel 00 : 14[1d0] -> 15[1e0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3917:4230 [1] NCCL INFO Channel 00 : 9[1c0] -> 10[1d0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14965:15820 [1] NCCL INFO Channel 00 : 5[1c0] -> 6[1d0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14966:15818 [2] NCCL INFO Channel 00 : 6[1d0] -> 7[1e0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3918:4232 [2] NCCL INFO Channel 00 : 10[1d0] -> 11[1e0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4025:4346 [2] NCCL INFO Channel 00 : 14[1d0] -> 13[1c0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10716:11568 [2] NCCL INFO Channel 00 : 2[1d0] -> 1[1c0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3918:4232 [2] NCCL INFO Channel 00 : 10[1d0] -> 9[1c0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14966:15818 [2] NCCL INFO Channel 00 : 6[1d0] -> 5[1c0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14964:15819 [0] NCCL INFO Channel 00 : 3[1e0] -> 4[1b0] [receive] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14964:15819 [0] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-34-219-204-184: ip-172-31-41-243:10714:11564 [0] NCCL INFO Channel 00 : 15[1e0] -> 0[1b0] [receive] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10714:11564 [0] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-54-244-82-8: ip-172-31-44-10:14964:15819 [0] NCCL INFO Channel 00 : 4[1b0] -> 5[1c0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4023:4344 [0] NCCL INFO Channel 00 : 11[1e0] -> 12[1b0] [receive] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3916:4233 [0] NCCL INFO Channel 00 : 7[1e0] -> 8[1b0] [receive] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4026:4345 [3] NCCL INFO Channel 00 : 15[1e0] -> 0[1b0] [send] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4023:4344 [0] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-65-226: ip-172-31-38-78:3916:4233 [0] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-54-244-82-8: ip-172-31-44-10:14967:15817 [3] NCCL INFO Channel 00 : 7[1e0] -> 8[1b0] [send] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10714:11564 [0] NCCL INFO Channel 00 : 0[1b0] -> 1[1c0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4023:4344 [0] NCCL INFO Channel 00 : 12[1b0] -> 13[1c0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3916:4233 [0] NCCL INFO Channel 00 : 8[1b0] -> 9[1c0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10717:11566 [3] NCCL INFO Channel 00 : 3[1e0] -> 4[1b0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3919:4231 [3] NCCL INFO Channel 00 : 11[1e0] -> 12[1b0] [send] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14965:15820 [1] NCCL INFO Channel 00 : 5[1c0] -> 4[1b0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4024:4347 [1] NCCL INFO Channel 00 : 13[1c0] -> 12[1b0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10715:11567 [1] NCCL INFO Channel 00 : 8[1b0] -> 1[1c0] [receive] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10715:11567 [1] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-34-219-204-184: ip-172-31-41-243:10715:11567 [1] NCCL INFO Channel 00 : 1[1c0] -> 0[1b0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3917:4230 [1] NCCL INFO Channel 00 : 4[1b0] -> 9[1c0] [receive] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3917:4230 [1] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-65-226: ip-172-31-38-78:3917:4230 [1] NCCL INFO Channel 00 : 12[1b0] -> 9[1c0] [receive] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3917:4230 [1] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-65-226: ip-172-31-38-78:3917:4230 [1] NCCL INFO Channel 00 : 9[1c0] -> 8[1b0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4026:4345 [3] NCCL INFO Channel 00 : 15[1e0] -> 14[1d0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4025:4346 [2] NCCL INFO Channel 01 : 14[1d0] -> 15[1e0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10714:11564 [0] NCCL INFO Channel 01 : 15[1e0] -> 0[1b0] [receive] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10714:11564 [0] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-54-244-82-8: ip-172-31-44-10:14967:15817 [3] NCCL INFO Channel 00 : 7[1e0] -> 6[1d0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10714:11564 [0] NCCL INFO Channel 01 : 0[1b0] -> 1[1c0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4026:4345 [3] NCCL INFO Channel 01 : 15[1e0] -> 0[1b0] [send] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10717:11566 [3] NCCL INFO Channel 00 : 3[1e0] -> 2[1d0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14966:15818 [2] NCCL INFO Channel 01 : 6[1d0] -> 7[1e0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3919:4231 [3] NCCL INFO Channel 00 : 11[1e0] -> 10[1d0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4026:4345 [3] NCCL INFO Channel 01 : 15[1e0] -> 14[1d0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3918:4232 [2] NCCL INFO Channel 01 : 10[1d0] -> 11[1e0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10716:11568 [2] NCCL INFO Channel 01 : 2[1d0] -> 3[1e0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14967:15817 [3] NCCL INFO Channel 01 : 7[1e0] -> 8[1b0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3919:4231 [3] NCCL INFO Channel 01 : 11[1e0] -> 12[1b0] [send] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10717:11566 [3] NCCL INFO Channel 01 : 3[1e0] -> 4[1b0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3916:4233 [0] NCCL INFO Channel 00 : 8[1b0] -> 1[1c0] [send] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14965:15820 [1] NCCL INFO Channel 01 : 5[1c0] -> 6[1d0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14966:15818 [2] NCCL INFO Channel 01 : 6[1d0] -> 5[1c0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14964:15819 [0] NCCL INFO Channel 00 : 4[1b0] -> 9[1c0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3916:4233 [0] NCCL INFO Channel 00 : 1[1c0] -> 8[1b0] [receive] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3916:4233 [0] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-28-66: ip-172-31-39-36:4024:4347 [1] NCCL INFO Channel 01 : 13[1c0] -> 14[1d0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4026:4345 [3] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-54-244-82-8: ip-172-31-44-10:14964:15819 [0] NCCL INFO Channel 00 : 9[1c0] -> 4[1b0] [receive] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14964:15819 [0] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-28-66: ip-172-31-39-36:4026:4345 [3] NCCL INFO comm 0x7f98c8001060 rank 15 nranks 16 cudaDev 3 busId 1e0 - Init COMPLETE
ec2-35-90-28-66: ip-172-31-39-36:4025:4346 [2] NCCL INFO Channel 01 : 14[1d0] -> 13[1c0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4023:4344 [0] NCCL INFO Channel 00 : 12[1b0] -> 9[1c0] [send] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4023:4344 [0] NCCL INFO Channel 00 : 9[1c0] -> 12[1b0] [receive] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4023:4344 [0] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-34-219-204-184: ip-172-31-41-243:10715:11567 [1] NCCL INFO Channel 00 : 1[1c0] -> 8[1b0] [send] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10715:11567 [1] NCCL INFO Channel 01 : 1[1c0] -> 2[1d0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10716:11568 [2] NCCL INFO Channel 01 : 2[1d0] -> 1[1c0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10715:11567 [1] NCCL INFO Channel 01 : 1[1c0] -> 0[1b0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10715:11567 [1] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-34-219-204-184: ip-172-31-41-243:10715:11567 [1] NCCL INFO comm 0x7fc27c001060 rank 1 nranks 16 cudaDev 1 busId 1c0 - Init COMPLETE
ec2-35-90-65-226: ip-172-31-38-78:3916:4233 [0] NCCL INFO Channel 01 : 7[1e0] -> 8[1b0] [receive] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3916:4233 [0] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-65-226: ip-172-31-38-78:3916:4233 [0] NCCL INFO Channel 01 : 8[1b0] -> 9[1c0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3917:4230 [1] NCCL INFO Channel 00 : 9[1c0] -> 4[1b0] [send] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10714:11564 [0] NCCL INFO Channel 01 : 0[1b0] -> 13[1c0] [send] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14967:15817 [3] NCCL INFO Channel 01 : 7[1e0] -> 6[1d0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14967:15817 [3] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-54-244-82-8: ip-172-31-44-10:14967:15817 [3] NCCL INFO comm 0x7fd064001060 rank 7 nranks 16 cudaDev 3 busId 1e0 - Init COMPLETE
ec2-35-90-65-226: ip-172-31-38-78:3917:4230 [1] NCCL INFO Channel 00 : 9[1c0] -> 12[1b0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3917:4230 [1] NCCL INFO Channel 01 : 9[1c0] -> 10[1d0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14964:15819 [0] NCCL INFO Channel 01 : 3[1e0] -> 4[1b0] [receive] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14964:15819 [0] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-65-226: ip-172-31-38-78:3918:4232 [2] NCCL INFO Channel 01 : 10[1d0] -> 9[1c0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14964:15819 [0] NCCL INFO Channel 01 : 4[1b0] -> 5[1c0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3917:4230 [1] NCCL INFO Channel 01 : 9[1c0] -> 8[1b0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3917:4230 [1] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-35-90-65-226: ip-172-31-38-78:3917:4230 [1] NCCL INFO comm 0x7f20bc001060 rank 9 nranks 16 cudaDev 1 busId 1c0 - Init COMPLETE
ec2-54-244-82-8: ip-172-31-44-10:14966:15818 [2] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-35-90-28-66: ip-172-31-39-36:4023:4344 [0] NCCL INFO Channel 01 : 11[1e0] -> 12[1b0] [receive] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4023:4344 [0] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-54-244-82-8: ip-172-31-44-10:14966:15818 [2] NCCL INFO comm 0x7f4b90001060 rank 6 nranks 16 cudaDev 2 busId 1d0 - Init COMPLETE
ec2-34-219-204-184: ip-172-31-41-243:10717:11566 [3] NCCL INFO Channel 01 : 3[1e0] -> 2[1d0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4023:4344 [0] NCCL INFO Channel 01 : 12[1b0] -> 13[1c0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10716:11568 [2] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-34-219-204-184: ip-172-31-41-243:10717:11566 [3] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-34-219-204-184: ip-172-31-41-243:10716:11568 [2] NCCL INFO comm 0x7f6800001060 rank 2 nranks 16 cudaDev 2 busId 1d0 - Init COMPLETE
ec2-34-219-204-184: ip-172-31-41-243:10717:11566 [3] NCCL INFO comm 0x7f7114001060 rank 3 nranks 16 cudaDev 3 busId 1e0 - Init COMPLETE
ec2-35-90-65-226: ip-172-31-38-78:3916:4233 [0] NCCL INFO Channel 01 : 8[1b0] -> 13[1c0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3919:4231 [3] NCCL INFO Channel 01 : 11[1e0] -> 10[1d0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4025:4346 [2] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-35-90-28-66: ip-172-31-39-36:4025:4346 [2] NCCL INFO comm 0x7fc950001060 rank 14 nranks 16 cudaDev 2 busId 1d0 - Init COMPLETE
ec2-35-90-65-226: ip-172-31-38-78:3919:4231 [3] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-35-90-65-226: ip-172-31-38-78:3918:4232 [2] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-35-90-65-226: ip-172-31-38-78:3919:4231 [3] NCCL INFO comm 0x7f527c001060 rank 11 nranks 16 cudaDev 3 busId 1e0 - Init COMPLETE
ec2-35-90-65-226: ip-172-31-38-78:3918:4232 [2] NCCL INFO comm 0x7f6188001060 rank 10 nranks 16 cudaDev 2 busId 1d0 - Init COMPLETE
ec2-54-244-82-8: ip-172-31-44-10:14965:15820 [1] NCCL INFO Channel 01 : 12[1b0] -> 5[1c0] [receive] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14965:15820 [1] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-54-244-82-8: ip-172-31-44-10:14965:15820 [1] NCCL INFO Channel 01 : 5[1c0] -> 4[1b0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14964:15819 [0] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-54-244-82-8: ip-172-31-44-10:14964:15819 [0] NCCL INFO comm 0x7f9054001060 rank 4 nranks 16 cudaDev 0 busId 1b0 - Init COMPLETE
ec2-35-90-28-66: ip-172-31-39-36:4023:4344 [0] NCCL INFO Channel 01 : 12[1b0] -> 5[1c0] [send] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4024:4347 [1] NCCL INFO Channel 01 : 8[1b0] -> 13[1c0] [receive] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4024:4347 [1] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-28-66: ip-172-31-39-36:4024:4347 [1] NCCL INFO Channel 01 : 0[1b0] -> 13[1c0] [receive] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4024:4347 [1] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-28-66: ip-172-31-39-36:4024:4347 [1] NCCL INFO Channel 01 : 13[1c0] -> 12[1b0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10714:11564 [0] NCCL INFO Channel 01 : 13[1c0] -> 0[1b0] [receive] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10714:11564 [0] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-65-226: ip-172-31-38-78:3916:4233 [0] NCCL INFO Channel 01 : 13[1c0] -> 8[1b0] [receive] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3916:4233 [0] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-28-66: ip-172-31-39-36:4023:4344 [0] NCCL INFO Channel 01 : 5[1c0] -> 12[1b0] [receive] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4023:4344 [0] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-28-66: ip-172-31-39-36:4024:4347 [1] NCCL INFO Channel 01 : 13[1c0] -> 8[1b0] [send] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14965:15820 [1] NCCL INFO Channel 01 : 5[1c0] -> 12[1b0] [send] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14965:15820 [1] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-35-90-28-66: ip-172-31-39-36:4023:4344 [0] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-54-244-82-8: ip-172-31-44-10:14965:15820 [1] NCCL INFO comm 0x7f2410001060 rank 5 nranks 16 cudaDev 1 busId 1c0 - Init COMPLETE
ec2-35-90-28-66: ip-172-31-39-36:4023:4344 [0] NCCL INFO comm 0x7f8c94001060 rank 12 nranks 16 cudaDev 0 busId 1b0 - Init COMPLETE
ec2-35-90-28-66: ip-172-31-39-36:4024:4347 [1] NCCL INFO Channel 01 : 13[1c0] -> 0[1b0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3916:4233 [0] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-35-90-65-226: ip-172-31-38-78:3916:4233 [0] NCCL INFO comm 0x7f88a8001060 rank 8 nranks 16 cudaDev 0 busId 1b0 - Init COMPLETE
ec2-35-90-28-66: ip-172-31-39-36:4024:4347 [1] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-35-90-28-66: ip-172-31-39-36:4024:4347 [1] NCCL INFO comm 0x7ff8a8001060 rank 13 nranks 16 cudaDev 1 busId 1c0 - Init COMPLETE
ec2-34-219-204-184: ip-172-31-41-243:10714:11564 [0] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-34-219-204-184: ip-172-31-41-243:10714:11564 [0] NCCL INFO comm 0x7f24c0001060 rank 0 nranks 16 cudaDev 0 busId 1b0 - Init COMPLETE
ec2-34-219-204-184: ip-172-31-41-243:10714:10714 [0] NCCL INFO Launch mode Parallel
ec2-34-219-204-184: > initializing model parallel with size 1
ec2-34-219-204-184: MPU DP: [0, 1, 2, 3]
ec2-34-219-204-184: MPU DP: [4, 5, 6, 7]
ec2-34-219-204-184: MPU DP: [8, 9, 10, 11]
ec2-34-219-204-184: MPU DP: [12, 13, 14, 15]
ec2-34-219-204-184: MPU PP: [0, 4, 8, 12]
ec2-34-219-204-184: MPU PP: [1, 5, 9, 13]
ec2-34-219-204-184: MPU PP: [2, 6, 10, 14]
ec2-34-219-204-184: MPU PP: [3, 7, 11, 15]
ec2-34-219-204-184: MPU IO: [0, 1, 2, 3, 12, 13, 14, 15]
ec2-34-219-204-184: MPU MP: [0]
ec2-34-219-204-184: MPU MP: [1]
ec2-34-219-204-184: MPU MP: [2]
ec2-34-219-204-184: MPU MP: [3]
ec2-34-219-204-184: MPU MP: [4]
ec2-34-219-204-184: MPU MP: [5]
ec2-34-219-204-184: MPU MP: [6]
ec2-34-219-204-184: MPU MP: [7]
ec2-34-219-204-184: MPU MP: [8]
ec2-34-219-204-184: MPU MP: [9]
ec2-34-219-204-184: MPU MP: [10]
ec2-34-219-204-184: MPU MP: [11]
ec2-34-219-204-184: MPU MP: [12]
ec2-34-219-204-184: MPU MP: [13]
ec2-34-219-204-184: MPU MP: [14]
ec2-34-219-204-184: MPU MP: [15]
ec2-34-219-204-184: > setting random seeds to 1234 ...
ec2-34-219-204-184: > initializing model parallel cuda seeds on global rank 1, model parallel rank 0, and data parallel rank 1 with model parallel seed: 3952 and data parallel seed: 1234> initializing model parallel cuda seeds on global rank 2, model parallel rank 0, and data parallel rank 2 with model parallel seed: 3952 and data parallel seed: 1234
ec2-34-219-204-184: 
ec2-34-219-204-184: > initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 3952 and data parallel seed: 1234
ec2-34-219-204-184: > initializing model parallel cuda seeds on global rank 3, model parallel rank 0, and data parallel rank 3 with model parallel seed: 3952 and data parallel seed: 1234
ec2-54-244-82-8: > initializing model parallel cuda seeds on global rank 7, model parallel rank 0, and data parallel rank 3 with model parallel seed: 5091 and data parallel seed: 2373> initializing model parallel cuda seeds on global rank 4, model parallel rank 0, and data parallel rank 0 with model parallel seed: 5091 and data parallel seed: 2373
ec2-54-244-82-8: 
ec2-54-244-82-8: > initializing model parallel cuda seeds on global rank 5, model parallel rank 0, and data parallel rank 1 with model parallel seed: 5091 and data parallel seed: 2373
ec2-54-244-82-8: > initializing model parallel cuda seeds on global rank 6, model parallel rank 0, and data parallel rank 2 with model parallel seed: 5091 and data parallel seed: 2373
ec2-35-90-65-226: > initializing model parallel cuda seeds on global rank 11, model parallel rank 0, and data parallel rank 3 with model parallel seed: 5092 and data parallel seed: 2374> initializing model parallel cuda seeds on global rank 8, model parallel rank 0, and data parallel rank 0 with model parallel seed: 5092 and data parallel seed: 2374> initializing model parallel cuda seeds on global rank 9, model parallel rank 0, and data parallel rank 1 with model parallel seed: 5092 and data parallel seed: 2374> initializing model parallel cuda seeds on global rank 10, model parallel rank 0, and data parallel rank 2 with model parallel seed: 5092 and data parallel seed: 2374
ec2-35-90-65-226: 
ec2-35-90-65-226: 
ec2-35-90-65-226: 
ec2-35-90-28-66: > initializing model parallel cuda seeds on global rank 15, model parallel rank 0, and data parallel rank 3 with model parallel seed: 3952 and data parallel seed: 1234> initializing model parallel cuda seeds on global rank 13, model parallel rank 0, and data parallel rank 1 with model parallel seed: 3952 and data parallel seed: 1234> initializing model parallel cuda seeds on global rank 14, model parallel rank 0, and data parallel rank 2 with model parallel seed: 3952 and data parallel seed: 1234> initializing model parallel cuda seeds on global rank 12, model parallel rank 0, and data parallel rank 0 with model parallel seed: 3952 and data parallel seed: 1234
ec2-35-90-28-66: 
ec2-35-90-28-66: 
ec2-35-90-28-66: 
ec2-34-219-204-184: building TransGAN model ...
ec2-34-219-204-184: SEED_LAYERS=False BASE_SEED=1234 SEED_FN=None
ec2-34-219-204-184: Using topology: {ProcessCoord(pipe=0, data=0, model=0): 0, ProcessCoord(pipe=0, data=1, model=0): 1, ProcessCoord(pipe=0, data=2, model=0): 2, ProcessCoord(pipe=0, data=3, model=0): 3, ProcessCoord(pipe=1, data=0, model=0): 4, ProcessCoord(pipe=1, data=1, model=0): 5, ProcessCoord(pipe=1, data=2, model=0): 6, ProcessCoord(pipe=1, data=3, model=0): 7, ProcessCoord(pipe=2, data=0, model=0): 8, ProcessCoord(pipe=2, data=1, model=0): 9, ProcessCoord(pipe=2, data=2, model=0): 10, ProcessCoord(pipe=2, data=3, model=0): 11, ProcessCoord(pipe=3, data=0, model=0): 12, ProcessCoord(pipe=3, data=1, model=0): 13, ProcessCoord(pipe=3, data=2, model=0): 14, ProcessCoord(pipe=3, data=3, model=0): 15}
ec2-34-219-204-184: [2022-10-08 14:54:29,888] [INFO] [module.py:399:_partition_layers] Partitioning pipeline stages with method type:transformer
ec2-34-219-204-184: [0, 12, 44, 49, 56] using type:transformer
ec2-34-219-204-184: stage=0 layers=12
ec2-34-219-204-184:      0: Linear
ec2-34-219-204-184:      1: <lambda>
ec2-34-219-204-184:      2: PositionEmbedding
ec2-34-219-204-184:      3: ParallelTransformerBlock
ec2-34-219-204-184:      4: ParallelTransformerBlock
ec2-34-219-204-184:      5: ParallelTransformerBlock
ec2-34-219-204-184:      6: ParallelTransformerBlock
ec2-34-219-204-184:      7: ParallelTransformerBlock
ec2-34-219-204-184:      8: ParallelTransformerBlock
ec2-34-219-204-184:      9: ParallelTransformerBlock
ec2-34-219-204-184:     10: ParallelTransformerBlock
ec2-34-219-204-184:     11: ParallelTransformerBlock
ec2-34-219-204-184: stage=1 layers=32
ec2-34-219-204-184:     12: ParallelTransformerBlock
ec2-54-244-82-8: debug:3072 1debug:3072 1
ec2-34-219-204-184:     13: ParallelTransformerBlock
ec2-34-219-204-184:     14: ParallelTransformerBlock
ec2-34-219-204-184:     15: <lambda>
ec2-54-244-82-8: 
ec2-34-219-204-184:     16: <lambda>
ec2-34-219-204-184:     17: PositionEmbedding
ec2-34-219-204-184:     18: <lambda>
ec2-34-219-204-184:     19: <lambda>
ec2-34-219-204-184:     20: PositionEmbedding
ec2-34-219-204-184:     21: <lambda>
ec2-34-219-204-184:     22: PositionEmbedding
ec2-34-219-204-184:     23: <lambda>
ec2-34-219-204-184:     24: <lambda>
ec2-34-219-204-184:     25: <lambda>
ec2-34-219-204-184:     26: <lambda>
ec2-34-219-204-184:     27: <lambda>
ec2-34-219-204-184:     28: <lambda>
ec2-54-244-82-8: debug:3072 1
ec2-54-244-82-8: debug:3072 1
ec2-34-219-204-184:     29: <lambda>
ec2-34-219-204-184:     30: PositionEmbedding
ec2-34-219-204-184:     31: <lambda>
ec2-34-219-204-184:     32: <lambda>
ec2-34-219-204-184:     33: <lambda>
ec2-34-219-204-184:     34: <lambda>
ec2-34-219-204-184:     35: <lambda>
ec2-35-90-65-226: debug:48 1debug:48 1debug:48 1
ec2-35-90-65-226: 
ec2-35-90-65-226: 
ec2-35-90-65-226: debug:48 1
ec2-35-90-28-66: debug:48 1debug:48 1debug:48 1debug:48 1
ec2-35-90-28-66: 
ec2-35-90-28-66: 
ec2-34-219-204-184:     36: <lambda>
ec2-35-90-28-66: 
ec2-34-219-204-184:     37: PositionEmbedding
ec2-34-219-204-184:     38: <lambda>
ec2-34-219-204-184:     39: <lambda>
ec2-34-219-204-184:     40: <lambda>
ec2-34-219-204-184:     41: ParallelTransformerBlock
ec2-34-219-204-184:     42: ParallelTransformerBlock
ec2-34-219-204-184:     43: ParallelTransformerBlock
ec2-34-219-204-184: stage=2 layers=5
ec2-34-219-204-184:     44: ParallelTransformerBlock
ec2-34-219-204-184:     45: ParallelTransformerBlock
ec2-34-219-204-184:     46: ParallelTransformerBlock
ec2-34-219-204-184:     47: ParallelTransformerBlock
ec2-34-219-204-184:     48: ParallelTransformerBlock
ec2-34-219-204-184: stage=3 layers=7
ec2-34-219-204-184:     49: ParallelTransformerBlock
ec2-34-219-204-184:     50: ParallelTransformerBlock
ec2-34-219-204-184:     51: ParallelTransformerBlock
ec2-34-219-204-184:     52: ParallelTransformerBlock
ec2-34-219-204-184:     53: <lambda>
ec2-34-219-204-184:     54: <lambda>
ec2-34-219-204-184:     55: Conv2d
ec2-34-219-204-184:   loss: DummyGenLoss
ec2-35-90-65-226: debug:64 1debug:64 1
ec2-35-90-65-226: 
ec2-35-90-65-226: debug:64 1debug:64 1
ec2-35-90-65-226: 
ec2-35-90-65-226: debug:48 1debug:48 1debug:48 1debug:48 1
ec2-35-90-65-226: 
ec2-35-90-65-226: 
ec2-35-90-65-226: 
ec2-35-90-65-226: debug:64 1
ec2-35-90-65-226: debug:48 1
ec2-35-90-65-226: debug:64 1
ec2-35-90-65-226: debug:48 1
ec2-35-90-65-226: debug:64 1
ec2-35-90-65-226: debug:48 1
ec2-35-90-65-226: debug:64 1
ec2-35-90-65-226: debug:48 1
ec2-35-90-65-226: debug:64 1
ec2-35-90-65-226: debug:48 1
ec2-35-90-65-226: debug:64 1
ec2-35-90-65-226: debug:48 1
ec2-35-90-65-226: debug:64 1
ec2-35-90-65-226: debug:48 1
ec2-35-90-65-226: debug:64 1
ec2-35-90-65-226: debug:48 1
ec2-35-90-65-226: debug:64 1
ec2-35-90-65-226: debug:48 1
ec2-35-90-65-226: debug:64 1
ec2-35-90-65-226: debug:48 1
ec2-35-90-65-226: debug:64 1
ec2-35-90-65-226: debug:64 1
ec2-35-90-65-226: debug:64 1debug:64 1
ec2-35-90-65-226: 
ec2-35-90-65-226: debug:48 1
ec2-35-90-65-226: debug:48 1
ec2-35-90-65-226: debug:64 1
ec2-35-90-65-226: debug:64 1
ec2-54-244-82-8: debug:4096 1debug:4096 1
ec2-54-244-82-8: 
ec2-54-244-82-8: debug:4096 1
ec2-54-244-82-8: debug:4096 1
ec2-54-244-82-8: debug:3072 1
ec2-54-244-82-8: debug:3072 1
ec2-54-244-82-8: debug:3072 1
ec2-54-244-82-8: debug:3072 1
ec2-54-244-82-8: debug:4096 1debug:4096 1
ec2-54-244-82-8: 
ec2-54-244-82-8: debug:4096 1
ec2-54-244-82-8: debug:4096 1
ec2-54-244-82-8: debug:3072 1
ec2-54-244-82-8: debug:3072 1
ec2-54-244-82-8: debug:3072 1
ec2-54-244-82-8: debug:3072 1
ec2-54-244-82-8: debug:4096 1
ec2-54-244-82-8: debug:4096 1
ec2-54-244-82-8: debug:4096 1
ec2-54-244-82-8: debug:4096 1
ec2-54-244-82-8: debug:48 1
ec2-54-244-82-8: debug:64 1
ec2-54-244-82-8: debug:48 1
ec2-54-244-82-8: debug:64 1
ec2-54-244-82-8: debug:48 1
ec2-54-244-82-8: debug:48 1
ec2-34-219-204-184: debug:3072 1
ec2-34-219-204-184: debug:3072 1
ec2-54-244-82-8: debug:64 1
ec2-34-219-204-184: debug:3072 1
ec2-34-219-204-184: debug:3072 1
ec2-54-244-82-8: debug:64 1
ec2-54-244-82-8: debug:48 1
ec2-54-244-82-8: debug:48 1
ec2-54-244-82-8: debug:48 1
ec2-54-244-82-8: debug:64 1
ec2-54-244-82-8: debug:64 1
ec2-54-244-82-8: debug:48 1debug:48 1
ec2-54-244-82-8: 
ec2-54-244-82-8: debug:64 1
ec2-54-244-82-8: debug:48 1
ec2-54-244-82-8: debug:64 1
ec2-54-244-82-8: debug:64 1
ec2-54-244-82-8: debug:48 1
ec2-54-244-82-8: debug:64 1
ec2-54-244-82-8: debug:48 1
ec2-54-244-82-8: debug:64 1
ec2-54-244-82-8: debug:64 1
ec2-34-219-204-184: debug:4096 1debug:4096 1debug:4096 1
ec2-34-219-204-184: 
ec2-34-219-204-184: 
ec2-34-219-204-184: debug:4096 1
ec2-34-219-204-184: debug:3072 1
ec2-34-219-204-184: debug:3072 1
ec2-34-219-204-184: debug:3072 1
ec2-34-219-204-184: debug:3072 1
ec2-34-219-204-184: debug:4096 1
ec2-34-219-204-184: debug:4096 1
ec2-34-219-204-184: debug:4096 1
ec2-34-219-204-184: debug:4096 1
ec2-34-219-204-184: debug:3072 1
ec2-34-219-204-184: debug:3072 1
ec2-34-219-204-184: debug:3072 1
ec2-34-219-204-184: debug:3072 1
ec2-34-219-204-184: debug:4096 1
ec2-34-219-204-184: debug:4096 1
ec2-34-219-204-184: debug:4096 1
ec2-34-219-204-184: debug:4096 1
ec2-34-219-204-184: debug:3072 1
ec2-34-219-204-184: debug:3072 1
ec2-34-219-204-184: debug:3072 1
ec2-34-219-204-184: debug:3072 1
ec2-34-219-204-184: debug:4096 1
ec2-34-219-204-184: debug:4096 1
ec2-34-219-204-184: debug:4096 1
ec2-34-219-204-184: debug:4096 1
ec2-34-219-204-184: debug:3072 1
ec2-34-219-204-184: debug:3072 1
ec2-34-219-204-184: debug:4096 1
ec2-34-219-204-184: debug:3072 1
ec2-34-219-204-184: debug:3072 1
ec2-34-219-204-184: debug:4096 1
ec2-34-219-204-184: debug:4096 1
ec2-34-219-204-184: debug:4096 1
ec2-34-219-204-184: debug:3072 1
ec2-34-219-204-184: debug:3072 1
ec2-34-219-204-184: debug:3072 1
ec2-34-219-204-184: debug:3072 1
ec2-34-219-204-184: debug:4096 1
ec2-34-219-204-184: debug:4096 1
ec2-34-219-204-184: debug:4096 1
ec2-34-219-204-184: debug:4096 1
ec2-34-219-204-184: debug:3072 1
ec2-34-219-204-184: debug:3072 1
ec2-34-219-204-184: debug:4096 1
ec2-34-219-204-184: debug:3072 1
ec2-34-219-204-184: debug:3072 1
ec2-34-219-204-184: debug:4096 1
ec2-34-219-204-184: debug:4096 1
ec2-34-219-204-184: debug:4096 1
ec2-34-219-204-184: debug:3072 1
ec2-34-219-204-184: debug:3072 1
ec2-34-219-204-184: debug:3072 1
ec2-34-219-204-184: debug:3072 1
ec2-34-219-204-184: debug:4096 1
ec2-34-219-204-184: debug:4096 1
ec2-34-219-204-184: debug:4096 1
ec2-34-219-204-184: debug:4096 1
ec2-34-219-204-184: debug:3072 1
ec2-34-219-204-184: debug:3072 1
ec2-34-219-204-184: debug:3072 1
ec2-34-219-204-184: debug:4096 1
ec2-34-219-204-184: debug:4096 1
ec2-34-219-204-184: debug:3072 1
ec2-34-219-204-184: debug:4096 1
ec2-34-219-204-184: debug:4096 1
ec2-35-90-28-66: debug:64 1debug:64 1debug:64 1debug:64 1
ec2-35-90-28-66: 
ec2-35-90-28-66: 
ec2-35-90-28-66: 
ec2-35-90-28-66: debug:48 1debug:48 1debug:48 1debug:48 1
ec2-35-90-28-66: 
ec2-35-90-28-66: 
ec2-35-90-28-66: 
ec2-35-90-28-66: debug:64 1
ec2-35-90-28-66: debug:48 1
ec2-35-90-28-66: debug:64 1
ec2-35-90-28-66: debug:48 1
ec2-35-90-28-66: debug:64 1debug:64 1
ec2-35-90-28-66: 
ec2-35-90-28-66: debug:48 1
ec2-35-90-28-66: debug:48 1
ec2-35-90-28-66: debug:64 1
ec2-35-90-28-66: debug:48 1
ec2-35-90-28-66: debug:64 1
ec2-35-90-28-66: debug:48 1
ec2-35-90-28-66: debug:64 1
ec2-35-90-28-66: debug:64 1
ec2-35-90-28-66: debug:64 1
ec2-35-90-28-66: debug:48 1
ec2-35-90-28-66: debug:64 1
ec2-35-90-28-66: debug:48 1
ec2-35-90-28-66: debug:64 1
ec2-35-90-28-66: debug:64 1
ec2-54-244-82-8: --------------------------initializing deepspeed-------------------------------
ec2-54-244-82-8: using pipeline Engine
ec2-54-244-82-8: zero is enabaled: False ---------------
ec2-54-244-82-8: ds check: 64 1 16
ec2-54-244-82-8: haha {'_param_dict': {'train_micro_batch_size_per_gpu': 1, 'gradient_accumulation_steps': 16, 'gradient_clipping': 1.0, 'steps_per_print': 10, 'wall_clock_breakdown': True, 'fp16': {'enabled': True, 'loss_scale': 0, 'loss_scale_window': 1000, 'hysteresis': 2, 'min_loss_scale': 1}, 'zero_allow_untested_optimizer': False, 'fp32_allreduce': True}, 'global_rank': 6, 'world_size': 4, 'elasticity_enabled': False, 'train_batch_size': 64, 'train_micro_batch_size_per_gpu': 1, 'gradient_accumulation_steps': 16, 'steps_per_print': 10, 'dump_state': False, 'disable_allgather': False, 'allreduce_always_fp32': True, 'prescale_gradients': False, 'gradient_predivide_factor': 1.0, 'sparse_gradients_enabled': False, 'zero_config': {
ec2-54-244-82-8:     "allgather_bucket_size": 500000000,
ec2-54-244-82-8:     "allgather_partitions": true,
ec2-54-244-82-8:     "contiguous_gradients": false,
ec2-54-244-82-8:     "cpu_offload": false,
ec2-54-244-82-8:     "cpu_offload_params": false,
ec2-54-244-82-8:     "cpu_offload_use_pin_memory": "cpu_offload_use_pin_memory",
ec2-54-244-82-8:     "elastic_checkpoint": true,
ec2-54-244-82-8:     "load_from_fp32_weights": true,
ec2-54-244-82-8:     "max_live_parameters": 1000000000,
ec2-54-244-82-8:     "max_reuse_distance": 1000000000,
ec2-54-244-82-8:     "overlap_comm": false,
ec2-54-244-82-8:     "param_persistence_threshold": 100000,
ec2-54-244-82-8:     "prefetch_bucket_size": 50000000,
ec2-54-244-82-8:     "reduce_bucket_size": 500000000,
ec2-54-244-82-8:     "reduce_scatter": true,
ec2-54-244-82-8:     "stage": 0,
ec2-54-244-82-8:     "sub_group_size": 1000000000000
ec2-54-244-82-8: }, 'zero_optimization_stage': 0, 'zero_enabled': False, 'activation_checkpointing_config': {
ec2-54-244-82-8:     "contiguous_memory_optimization": false,
ec2-54-244-82-8:     "cpu_checkpointing": false,
ec2-54-244-82-8:     "number_checkpoints": null,
ec2-54-244-82-8:     "partition_activations": false,
ec2-54-244-82-8:     "profile": false,
ec2-54-244-82-8:     "synchronize_checkpoint_boundary": false
ec2-54-244-82-8: }, 'gradient_clipping': 1.0, 'fp16_enabled': True, 'amp_enabled': False, 'amp_params': False, 'loss_scale': 0, 'initial_dynamic_scale': 4294967296, 'dynamic_loss_scale_args': {'init_scale': 4294967296, 'scale_window': 1000, 'delayed_shift': 2, 'min_scale': 1}, 'optimizer_name': None, 'optimizer_params': None, 'optimizer_legacy_fusion': False, 'zero_allow_untested_optimizer': False, 'scheduler_name': None, 'scheduler_params': None, 'wall_clock_breakdown': True, 'flops_profiler_config': {
ec2-54-244-82-8:     "detailed": true,
ec2-54-244-82-8:     "enabled": false,
ec2-54-244-82-8:     "module_depth": -1,
ec2-54-244-82-8:     "profile_step": 1,
ec2-54-244-82-8:     "top_modules": 3
ec2-54-244-82-8: }, 'memory_breakdown': False, 'tensorboard_enabled': False, 'tensorboard_output_path': '', 'tensorboard_job_name': 'DeepSpeedJobName', 'sparse_attention': None, 'pipeline': {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}, 'pld_enabled': False, 'pld_params': False, 'checkpoint_tag_validation_enabled': True, 'checkpoint_tag_validation_fail': False}
ec2-54-244-82-8: --------------------------initializing deepspeed-------------------------------
ec2-54-244-82-8: using pipeline Engine
ec2-54-244-82-8: zero is enabaled: False ---------------
ec2-54-244-82-8: ds check: 64 1 16
ec2-54-244-82-8: haha {'_param_dict': {'train_micro_batch_size_per_gpu': 1, 'gradient_accumulation_steps': 16, 'gradient_clipping': 1.0, 'steps_per_print': 10, 'wall_clock_breakdown': True, 'fp16': {'enabled': True, 'loss_scale': 0, 'loss_scale_window': 1000, 'hysteresis': 2, 'min_loss_scale': 1}, 'zero_allow_untested_optimizer': False, 'fp32_allreduce': True}, 'global_rank': 7, 'world_size': 4, 'elasticity_enabled': False, 'train_batch_size': 64, 'train_micro_batch_size_per_gpu': 1, 'gradient_accumulation_steps': 16, 'steps_per_print': 10, 'dump_state': False, 'disable_allgather': False, 'allreduce_always_fp32': True, 'prescale_gradients': False, 'gradient_predivide_factor': 1.0, 'sparse_gradients_enabled': False, 'zero_config': {
ec2-54-244-82-8:     "allgather_bucket_size": 500000000,
ec2-54-244-82-8:     "allgather_partitions": true,
ec2-54-244-82-8:     "contiguous_gradients": false,
ec2-54-244-82-8:     "cpu_offload": false,
ec2-54-244-82-8:     "cpu_offload_params": false,
ec2-54-244-82-8:     "cpu_offload_use_pin_memory": "cpu_offload_use_pin_memory",
ec2-54-244-82-8:     "elastic_checkpoint": true,
ec2-54-244-82-8:     "load_from_fp32_weights": true,
ec2-54-244-82-8:     "max_live_parameters": 1000000000,
ec2-54-244-82-8:     "max_reuse_distance": 1000000000,
ec2-54-244-82-8:     "overlap_comm": false,
ec2-54-244-82-8:     "param_persistence_threshold": 100000,
ec2-54-244-82-8:     "prefetch_bucket_size": 50000000,
ec2-54-244-82-8:     "reduce_bucket_size": 500000000,
ec2-54-244-82-8:     "reduce_scatter": true,
ec2-54-244-82-8:     "stage": 0,
ec2-54-244-82-8:     "sub_group_size": 1000000000000
ec2-54-244-82-8: }, 'zero_optimization_stage': 0, 'zero_enabled': False, 'activation_checkpointing_config': {
ec2-54-244-82-8:     "contiguous_memory_optimization": false,
ec2-54-244-82-8:     "cpu_checkpointing": false,
ec2-54-244-82-8:     "number_checkpoints": null,
ec2-54-244-82-8:     "partition_activations": false,
ec2-54-244-82-8:     "profile": false,
ec2-54-244-82-8:     "synchronize_checkpoint_boundary": false
ec2-54-244-82-8: }, 'gradient_clipping': 1.0, 'fp16_enabled': True, 'amp_enabled': False, 'amp_params': False, 'loss_scale': 0, 'initial_dynamic_scale': 4294967296, 'dynamic_loss_scale_args': {'init_scale': 4294967296, 'scale_window': 1000, 'delayed_shift': 2, 'min_scale': 1}, 'optimizer_name': None, 'optimizer_params': None, 'optimizer_legacy_fusion': False, 'zero_allow_untested_optimizer': False, 'scheduler_name': None, 'scheduler_params': None, 'wall_clock_breakdown': True, 'flops_profiler_config': {
ec2-54-244-82-8:     "detailed": true,
ec2-54-244-82-8:     "enabled": false,
ec2-54-244-82-8:     "module_depth": -1,
ec2-54-244-82-8:     "profile_step": 1,
ec2-54-244-82-8:     "top_modules": 3
ec2-54-244-82-8: }, 'memory_breakdown': False, 'tensorboard_enabled': False, 'tensorboard_output_path': '', 'tensorboard_job_name': 'DeepSpeedJobName', 'sparse_attention': None, 'pipeline': {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}, 'pld_enabled': False, 'pld_params': False, 'checkpoint_tag_validation_enabled': True, 'checkpoint_tag_validation_fail': False}
ec2-35-90-65-226: --------------------------initializing deepspeed-------------------------------
ec2-35-90-65-226: using pipeline Engine
ec2-35-90-65-226: zero is enabaled: False ---------------
ec2-35-90-65-226: ds check: 64 1 16
ec2-35-90-65-226: haha {'_param_dict': {'train_micro_batch_size_per_gpu': 1, 'gradient_accumulation_steps': 16, 'gradient_clipping': 1.0, 'steps_per_print': 10, 'wall_clock_breakdown': True, 'fp16': {'enabled': True, 'loss_scale': 0, 'loss_scale_window': 1000, 'hysteresis': 2, 'min_loss_scale': 1}, 'zero_allow_untested_optimizer': False, 'fp32_allreduce': True}, 'global_rank': 11, 'world_size': 4, 'elasticity_enabled': False, 'train_batch_size': 64, 'train_micro_batch_size_per_gpu': 1, 'gradient_accumulation_steps': 16, 'steps_per_print': 10, 'dump_state': False, 'disable_allgather': False, 'allreduce_always_fp32': True, 'prescale_gradients': False, 'gradient_predivide_factor': 1.0, 'sparse_gradients_enabled': False, 'zero_config': {
ec2-35-90-65-226:     "allgather_bucket_size": 500000000,
ec2-35-90-65-226:     "allgather_partitions": true,
ec2-35-90-65-226:     "contiguous_gradients": false,
ec2-35-90-65-226:     "cpu_offload": false,
ec2-35-90-65-226:     "cpu_offload_params": false,
ec2-35-90-65-226:     "cpu_offload_use_pin_memory": "cpu_offload_use_pin_memory",
ec2-35-90-65-226:     "elastic_checkpoint": true,
ec2-35-90-65-226:     "load_from_fp32_weights": true,
ec2-35-90-65-226:     "max_live_parameters": 1000000000,
ec2-35-90-65-226:     "max_reuse_distance": 1000000000,
ec2-35-90-65-226:     "overlap_comm": false,
ec2-35-90-65-226:     "param_persistence_threshold": 100000,
ec2-35-90-65-226:     "prefetch_bucket_size": 50000000,
ec2-35-90-65-226:     "reduce_bucket_size": 500000000,
ec2-35-90-65-226:     "reduce_scatter": true,
ec2-35-90-65-226:     "stage": 0,
ec2-35-90-65-226:     "sub_group_size": 1000000000000
ec2-35-90-65-226: }, 'zero_optimization_stage': 0, 'zero_enabled': False, 'activation_checkpointing_config': {
ec2-35-90-65-226:     "contiguous_memory_optimization": false,
ec2-35-90-65-226:     "cpu_checkpointing": false,
ec2-35-90-65-226:     "number_checkpoints": null,
ec2-35-90-65-226:     "partition_activations": false,
ec2-35-90-65-226:     "profile": false,
ec2-35-90-65-226:     "synchronize_checkpoint_boundary": false
ec2-35-90-65-226: }, 'gradient_clipping': 1.0, 'fp16_enabled': True, 'amp_enabled': False, 'amp_params': False, 'loss_scale': 0, 'initial_dynamic_scale': 4294967296, 'dynamic_loss_scale_args': {'init_scale': 4294967296, 'scale_window': 1000, 'delayed_shift': 2, 'min_scale': 1}, 'optimizer_name': None, 'optimizer_params': None, 'optimizer_legacy_fusion': False, 'zero_allow_untested_optimizer': False, 'scheduler_name': None, 'scheduler_params': None, 'wall_clock_breakdown': True, 'flops_profiler_config': {
ec2-35-90-65-226:     "detailed": true,
ec2-35-90-65-226:     "enabled": false,
ec2-35-90-65-226:     "module_depth": -1,
ec2-35-90-65-226:     "profile_step": 1,
ec2-35-90-65-226:     "top_modules": 3
ec2-35-90-65-226: }, 'memory_breakdown': False, 'tensorboard_enabled': False, 'tensorboard_output_path': '', 'tensorboard_job_name': 'DeepSpeedJobName', 'sparse_attention': None, 'pipeline': {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}, 'pld_enabled': False, 'pld_params': False, 'checkpoint_tag_validation_enabled': True, 'checkpoint_tag_validation_fail': False}
ec2-54-244-82-8:  > number of parameters on model parallel rank 0: 43444398
ec2-35-90-65-226:  > number of parameters on model parallel rank 0: 40585
ec2-54-244-82-8: --------------------------initializing deepspeed-------------------------------
ec2-54-244-82-8: using pipeline Engine
ec2-54-244-82-8: zero is enabaled: False ---------------
ec2-54-244-82-8: ds check: 64 1 16
ec2-54-244-82-8: haha {'_param_dict': {'train_micro_batch_size_per_gpu': 1, 'gradient_accumulation_steps': 16, 'gradient_clipping': 1.0, 'steps_per_print': 10, 'wall_clock_breakdown': True, 'fp16': {'enabled': True, 'loss_scale': 0, 'loss_scale_window': 1000, 'hysteresis': 2, 'min_loss_scale': 1}, 'zero_allow_untested_optimizer': False, 'fp32_allreduce': True}, 'global_rank': 4, 'world_size': 4, 'elasticity_enabled': False, 'train_batch_size': 64, 'train_micro_batch_size_per_gpu': 1, 'gradient_accumulation_steps': 16, 'steps_per_print': 10, 'dump_state': False, 'disable_allgather': False, 'allreduce_always_fp32': True, 'prescale_gradients': False, 'gradient_predivide_factor': 1.0, 'sparse_gradients_enabled': False, 'zero_config': {
ec2-54-244-82-8:     "allgather_bucket_size": 500000000,
ec2-54-244-82-8:     "allgather_partitions": true,
ec2-54-244-82-8:     "contiguous_gradients": false,
ec2-54-244-82-8:     "cpu_offload": false,
ec2-54-244-82-8:     "cpu_offload_params": false,
ec2-54-244-82-8:     "cpu_offload_use_pin_memory": "cpu_offload_use_pin_memory",
ec2-54-244-82-8:     "elastic_checkpoint": true,
ec2-54-244-82-8:     "load_from_fp32_weights": true,
ec2-54-244-82-8:     "max_live_parameters": 1000000000,
ec2-54-244-82-8:     "max_reuse_distance": 1000000000,
ec2-54-244-82-8:     "overlap_comm": false,
ec2-54-244-82-8:     "param_persistence_threshold": 100000,
ec2-54-244-82-8:     "prefetch_bucket_size": 50000000,
ec2-54-244-82-8:     "reduce_bucket_size": 500000000,
ec2-54-244-82-8:     "reduce_scatter": true,
ec2-54-244-82-8:     "stage": 0,
ec2-54-244-82-8:     "sub_group_size": 1000000000000
ec2-54-244-82-8: }, 'zero_optimization_stage': 0, 'zero_enabled': False, 'activation_checkpointing_config': {
ec2-54-244-82-8:     "contiguous_memory_optimization": false,
ec2-54-244-82-8:     "cpu_checkpointing": false,
ec2-54-244-82-8:     "number_checkpoints": null,
ec2-54-244-82-8:     "partition_activations": false,
ec2-54-244-82-8:     "profile": false,
ec2-54-244-82-8:     "synchronize_checkpoint_boundary": false
ec2-54-244-82-8: }, 'gradient_clipping': 1.0, 'fp16_enabled': True, 'amp_enabled': False, 'amp_params': False, 'loss_scale': 0, 'initial_dynamic_scale': 4294967296, 'dynamic_loss_scale_args': {'init_scale': 4294967296, 'scale_window': 1000, 'delayed_shift': 2, 'min_scale': 1}, 'optimizer_name': None, 'optimizer_params': None, 'optimizer_legacy_fusion': False, 'zero_allow_untested_optimizer': False, 'scheduler_name': None, 'scheduler_params': None, 'wall_clock_breakdown': True, 'flops_profiler_config': {
ec2-54-244-82-8:     "detailed": true,
ec2-54-244-82-8:     "enabled": false,
ec2-54-244-82-8:     "module_depth": -1,
ec2-54-244-82-8:     "profile_step": 1,
ec2-54-244-82-8:     "top_modules": 3
ec2-54-244-82-8: }, 'memory_breakdown': False, 'tensorboard_enabled': False, 'tensorboard_output_path': '', 'tensorboard_job_name': 'DeepSpeedJobName', 'sparse_attention': None, 'pipeline': {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}, 'pld_enabled': False, 'pld_params': False, 'checkpoint_tag_validation_enabled': True, 'checkpoint_tag_validation_fail': False}
ec2-35-90-65-226: --------------------------initializing deepspeed-------------------------------
ec2-35-90-65-226: using pipeline Engine
ec2-35-90-65-226: zero is enabaled: False ---------------
ec2-35-90-65-226: ds check: 64 1 16
ec2-35-90-65-226: haha {'_param_dict': {'train_micro_batch_size_per_gpu': 1, 'gradient_accumulation_steps': 16, 'gradient_clipping': 1.0, 'steps_per_print': 10, 'wall_clock_breakdown': True, 'fp16': {'enabled': True, 'loss_scale': 0, 'loss_scale_window': 1000, 'hysteresis': 2, 'min_loss_scale': 1}, 'zero_allow_untested_optimizer': False, 'fp32_allreduce': True}, 'global_rank': 8, 'world_size': 4, 'elasticity_enabled': False, 'train_batch_size': 64, 'train_micro_batch_size_per_gpu': 1, 'gradient_accumulation_steps': 16, 'steps_per_print': 10, 'dump_state': False, 'disable_allgather': False, 'allreduce_always_fp32': True, 'prescale_gradients': False, 'gradient_predivide_factor': 1.0, 'sparse_gradients_enabled': False, 'zero_config': {
ec2-35-90-65-226:     "allgather_bucket_size": 500000000,
ec2-35-90-65-226:     "allgather_partitions": true,
ec2-35-90-65-226:     "contiguous_gradients": false,
ec2-35-90-65-226:     "cpu_offload": false,
ec2-35-90-65-226:     "cpu_offload_params": false,
ec2-35-90-65-226:     "cpu_offload_use_pin_memory": "cpu_offload_use_pin_memory",
ec2-35-90-65-226:     "elastic_checkpoint": true,
ec2-35-90-65-226:     "load_from_fp32_weights": true,
ec2-35-90-65-226:     "max_live_parameters": 1000000000,
ec2-35-90-65-226:     "max_reuse_distance": 1000000000,
ec2-35-90-65-226:     "overlap_comm": false,
ec2-35-90-65-226:     "param_persistence_threshold": 100000,
ec2-35-90-65-226:     "prefetch_bucket_size": 50000000,
ec2-35-90-65-226:     "reduce_bucket_size": 500000000,
ec2-35-90-65-226:     "reduce_scatter": true,
ec2-35-90-65-226:     "stage": 0,
ec2-35-90-65-226:     "sub_group_size": 1000000000000
ec2-35-90-65-226: }, 'zero_optimization_stage': 0, 'zero_enabled': False, 'activation_checkpointing_config': {
ec2-35-90-65-226:     "contiguous_memory_optimization": false,
ec2-35-90-65-226:     "cpu_checkpointing": false,
ec2-35-90-65-226:     "number_checkpoints": null,
ec2-35-90-65-226:     "partition_activations": false,
ec2-35-90-65-226:     "profile": false,
ec2-35-90-65-226:     "synchronize_checkpoint_boundary": false
ec2-35-90-65-226: }, 'gradient_clipping': 1.0, 'fp16_enabled': True, 'amp_enabled': False, 'amp_params': False, 'loss_scale': 0, 'initial_dynamic_scale': 4294967296, 'dynamic_loss_scale_args': {'init_scale': 4294967296, 'scale_window': 1000, 'delayed_shift': 2, 'min_scale': 1}, 'optimizer_name': None, 'optimizer_params': None, 'optimizer_legacy_fusion': False, 'zero_allow_untested_optimizer': False, 'scheduler_name': None, 'scheduler_params': None, 'wall_clock_breakdown': True, 'flops_profiler_config': {
ec2-35-90-65-226:     "detailed": true,
ec2-35-90-65-226:     "enabled": false,
ec2-35-90-65-226:     "module_depth": -1,
ec2-35-90-65-226:     "profile_step": 1,
ec2-35-90-65-226:     "top_modules": 3
ec2-35-90-65-226: }, 'memory_breakdown': False, 'tensorboard_enabled': False, 'tensorboard_output_path': '', 'tensorboard_job_name': 'DeepSpeedJobName', 'sparse_attention': None, 'pipeline': {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}, 'pld_enabled': False, 'pld_params': False, 'checkpoint_tag_validation_enabled': True, 'checkpoint_tag_validation_fail': False}
ec2-35-90-65-226: --------------------------initializing deepspeed-------------------------------
ec2-35-90-65-226: using pipeline Engine
ec2-35-90-65-226: zero is enabaled: False ---------------
ec2-35-90-65-226: ds check: 64 1 16
ec2-35-90-65-226: haha {'_param_dict': {'train_micro_batch_size_per_gpu': 1, 'gradient_accumulation_steps': 16, 'gradient_clipping': 1.0, 'steps_per_print': 10, 'wall_clock_breakdown': True, 'fp16': {'enabled': True, 'loss_scale': 0, 'loss_scale_window': 1000, 'hysteresis': 2, 'min_loss_scale': 1}, 'zero_allow_untested_optimizer': False, 'fp32_allreduce': True}, 'global_rank': 10, 'world_size': 4, 'elasticity_enabled': False, 'train_batch_size': 64, 'train_micro_batch_size_per_gpu': 1, 'gradient_accumulation_steps': 16, 'steps_per_print': 10, 'dump_state': False, 'disable_allgather': False, 'allreduce_always_fp32': True, 'prescale_gradients': False, 'gradient_predivide_factor': 1.0, 'sparse_gradients_enabled': False, 'zero_config': {
ec2-35-90-65-226:     "allgather_bucket_size": 500000000,
ec2-35-90-65-226:     "allgather_partitions": true,
ec2-35-90-65-226:     "contiguous_gradients": false,
ec2-35-90-65-226:     "cpu_offload": false,
ec2-35-90-65-226:     "cpu_offload_params": false,
ec2-35-90-65-226:     "cpu_offload_use_pin_memory": "cpu_offload_use_pin_memory",
ec2-35-90-65-226:     "elastic_checkpoint": true,
ec2-35-90-65-226:     "load_from_fp32_weights": true,
ec2-35-90-65-226:     "max_live_parameters": 1000000000,
ec2-35-90-65-226:     "max_reuse_distance": 1000000000,
ec2-35-90-65-226:     "overlap_comm": false,
ec2-35-90-65-226:     "param_persistence_threshold": 100000,
ec2-35-90-65-226:     "prefetch_bucket_size": 50000000,
ec2-35-90-65-226:     "reduce_bucket_size": 500000000,
ec2-35-90-65-226:     "reduce_scatter": true,
ec2-35-90-65-226:     "stage": 0,
ec2-35-90-65-226:     "sub_group_size": 1000000000000
ec2-35-90-65-226: }, 'zero_optimization_stage': 0, 'zero_enabled': False, 'activation_checkpointing_config': {
ec2-35-90-65-226:     "contiguous_memory_optimization": false,
ec2-35-90-65-226:     "cpu_checkpointing": false,
ec2-35-90-65-226:     "number_checkpoints": null,
ec2-35-90-65-226:     "partition_activations": false,
ec2-35-90-65-226:     "profile": false,
ec2-35-90-65-226:     "synchronize_checkpoint_boundary": false
ec2-35-90-65-226: }, 'gradient_clipping': 1.0, 'fp16_enabled': True, 'amp_enabled': False, 'amp_params': False, 'loss_scale': 0, 'initial_dynamic_scale': 4294967296, 'dynamic_loss_scale_args': {'init_scale': 4294967296, 'scale_window': 1000, 'delayed_shift': 2, 'min_scale': 1}, 'optimizer_name': None, 'optimizer_params': None, 'optimizer_legacy_fusion': False, 'zero_allow_untested_optimizer': False, 'scheduler_name': None, 'scheduler_params': None, 'wall_clock_breakdown': True, 'flops_profiler_config': {
ec2-35-90-65-226:     "detailed": true,
ec2-35-90-65-226:     "enabled": false,
ec2-35-90-65-226:     "module_depth": -1,
ec2-35-90-65-226:     "profile_step": 1,
ec2-35-90-65-226:     "top_modules": 3
ec2-35-90-65-226: }, 'memory_breakdown': False, 'tensorboard_enabled': False, 'tensorboard_output_path': '', 'tensorboard_job_name': 'DeepSpeedJobName', 'sparse_attention': None, 'pipeline': {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}, 'pld_enabled': False, 'pld_params': False, 'checkpoint_tag_validation_enabled': True, 'checkpoint_tag_validation_fail': False}
ec2-54-244-82-8: NCCL version 2.7.8+cuda11.0
ec2-35-90-65-226: NCCL version 2.7.8+cuda11.0
ec2-35-90-65-226: --------------------------initializing deepspeed-------------------------------
ec2-35-90-65-226: using pipeline Engine
ec2-35-90-65-226: zero is enabaled: False ---------------
ec2-35-90-65-226: ds check: 64 1 16
ec2-35-90-65-226: haha {'_param_dict': {'train_micro_batch_size_per_gpu': 1, 'gradient_accumulation_steps': 16, 'gradient_clipping': 1.0, 'steps_per_print': 10, 'wall_clock_breakdown': True, 'fp16': {'enabled': True, 'loss_scale': 0, 'loss_scale_window': 1000, 'hysteresis': 2, 'min_loss_scale': 1}, 'zero_allow_untested_optimizer': False, 'fp32_allreduce': True}, 'global_rank': 9, 'world_size': 4, 'elasticity_enabled': False, 'train_batch_size': 64, 'train_micro_batch_size_per_gpu': 1, 'gradient_accumulation_steps': 16, 'steps_per_print': 10, 'dump_state': False, 'disable_allgather': False, 'allreduce_always_fp32': True, 'prescale_gradients': False, 'gradient_predivide_factor': 1.0, 'sparse_gradients_enabled': False, 'zero_config': {
ec2-35-90-65-226:     "allgather_bucket_size": 500000000,
ec2-35-90-65-226:     "allgather_partitions": true,
ec2-35-90-65-226:     "contiguous_gradients": false,
ec2-35-90-65-226:     "cpu_offload": false,
ec2-35-90-65-226:     "cpu_offload_params": false,
ec2-35-90-65-226:     "cpu_offload_use_pin_memory": "cpu_offload_use_pin_memory",
ec2-35-90-65-226:     "elastic_checkpoint": true,
ec2-35-90-65-226:     "load_from_fp32_weights": true,
ec2-35-90-65-226:     "max_live_parameters": 1000000000,
ec2-35-90-65-226:     "max_reuse_distance": 1000000000,
ec2-35-90-65-226:     "overlap_comm": false,
ec2-35-90-65-226:     "param_persistence_threshold": 100000,
ec2-35-90-65-226:     "prefetch_bucket_size": 50000000,
ec2-35-90-65-226:     "reduce_bucket_size": 500000000,
ec2-35-90-65-226:     "reduce_scatter": true,
ec2-35-90-65-226:     "stage": 0,
ec2-35-90-65-226:     "sub_group_size": 1000000000000
ec2-35-90-65-226: }, 'zero_optimization_stage': 0, 'zero_enabled': False, 'activation_checkpointing_config': {
ec2-35-90-65-226:     "contiguous_memory_optimization": false,
ec2-35-90-65-226:     "cpu_checkpointing": false,
ec2-35-90-65-226:     "number_checkpoints": null,
ec2-35-90-65-226:     "partition_activations": false,
ec2-35-90-65-226:     "profile": false,
ec2-35-90-65-226:     "synchronize_checkpoint_boundary": false
ec2-35-90-65-226: }, 'gradient_clipping': 1.0, 'fp16_enabled': True, 'amp_enabled': False, 'amp_params': False, 'loss_scale': 0, 'initial_dynamic_scale': 4294967296, 'dynamic_loss_scale_args': {'init_scale': 4294967296, 'scale_window': 1000, 'delayed_shift': 2, 'min_scale': 1}, 'optimizer_name': None, 'optimizer_params': None, 'optimizer_legacy_fusion': False, 'zero_allow_untested_optimizer': False, 'scheduler_name': None, 'scheduler_params': None, 'wall_clock_breakdown': True, 'flops_profiler_config': {
ec2-35-90-65-226:     "detailed": true,
ec2-35-90-65-226:     "enabled": false,
ec2-35-90-65-226:     "module_depth": -1,
ec2-35-90-65-226:     "profile_step": 1,
ec2-35-90-65-226:     "top_modules": 3
ec2-35-90-65-226: }, 'memory_breakdown': False, 'tensorboard_enabled': False, 'tensorboard_output_path': '', 'tensorboard_job_name': 'DeepSpeedJobName', 'sparse_attention': None, 'pipeline': {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}, 'pld_enabled': False, 'pld_params': False, 'checkpoint_tag_validation_enabled': True, 'checkpoint_tag_validation_fail': False}
ec2-54-244-82-8: --------------------------initializing deepspeed-------------------------------
ec2-54-244-82-8: using pipeline Engine
ec2-54-244-82-8: zero is enabaled: False ---------------
ec2-54-244-82-8: ds check: 64 1 16
ec2-54-244-82-8: haha {'_param_dict': {'train_micro_batch_size_per_gpu': 1, 'gradient_accumulation_steps': 16, 'gradient_clipping': 1.0, 'steps_per_print': 10, 'wall_clock_breakdown': True, 'fp16': {'enabled': True, 'loss_scale': 0, 'loss_scale_window': 1000, 'hysteresis': 2, 'min_loss_scale': 1}, 'zero_allow_untested_optimizer': False, 'fp32_allreduce': True}, 'global_rank': 5, 'world_size': 4, 'elasticity_enabled': False, 'train_batch_size': 64, 'train_micro_batch_size_per_gpu': 1, 'gradient_accumulation_steps': 16, 'steps_per_print': 10, 'dump_state': False, 'disable_allgather': False, 'allreduce_always_fp32': True, 'prescale_gradients': False, 'gradient_predivide_factor': 1.0, 'sparse_gradients_enabled': False, 'zero_config': {
ec2-54-244-82-8:     "allgather_bucket_size": 500000000,
ec2-54-244-82-8:     "allgather_partitions": true,
ec2-54-244-82-8:     "contiguous_gradients": false,
ec2-54-244-82-8:     "cpu_offload": false,
ec2-54-244-82-8:     "cpu_offload_params": false,
ec2-54-244-82-8:     "cpu_offload_use_pin_memory": "cpu_offload_use_pin_memory",
ec2-54-244-82-8:     "elastic_checkpoint": true,
ec2-54-244-82-8:     "load_from_fp32_weights": true,
ec2-54-244-82-8:     "max_live_parameters": 1000000000,
ec2-54-244-82-8:     "max_reuse_distance": 1000000000,
ec2-54-244-82-8:     "overlap_comm": false,
ec2-54-244-82-8:     "param_persistence_threshold": 100000,
ec2-54-244-82-8:     "prefetch_bucket_size": 50000000,
ec2-54-244-82-8:     "reduce_bucket_size": 500000000,
ec2-54-244-82-8:     "reduce_scatter": true,
ec2-54-244-82-8:     "stage": 0,
ec2-54-244-82-8:     "sub_group_size": 1000000000000
ec2-54-244-82-8: }, 'zero_optimization_stage': 0, 'zero_enabled': False, 'activation_checkpointing_config': {
ec2-54-244-82-8:     "contiguous_memory_optimization": false,
ec2-54-244-82-8:     "cpu_checkpointing": false,
ec2-54-244-82-8:     "number_checkpoints": null,
ec2-54-244-82-8:     "partition_activations": false,
ec2-54-244-82-8:     "profile": false,
ec2-54-244-82-8:     "synchronize_checkpoint_boundary": false
ec2-54-244-82-8: }, 'gradient_clipping': 1.0, 'fp16_enabled': True, 'amp_enabled': False, 'amp_params': False, 'loss_scale': 0, 'initial_dynamic_scale': 4294967296, 'dynamic_loss_scale_args': {'init_scale': 4294967296, 'scale_window': 1000, 'delayed_shift': 2, 'min_scale': 1}, 'optimizer_name': None, 'optimizer_params': None, 'optimizer_legacy_fusion': False, 'zero_allow_untested_optimizer': False, 'scheduler_name': None, 'scheduler_params': None, 'wall_clock_breakdown': True, 'flops_profiler_config': {
ec2-54-244-82-8:     "detailed": true,
ec2-54-244-82-8:     "enabled": false,
ec2-54-244-82-8:     "module_depth": -1,
ec2-54-244-82-8:     "profile_step": 1,
ec2-54-244-82-8:     "top_modules": 3
ec2-54-244-82-8: }, 'memory_breakdown': False, 'tensorboard_enabled': False, 'tensorboard_output_path': '', 'tensorboard_job_name': 'DeepSpeedJobName', 'sparse_attention': None, 'pipeline': {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}, 'pld_enabled': False, 'pld_params': False, 'checkpoint_tag_validation_enabled': True, 'checkpoint_tag_validation_fail': False}
ec2-54-244-82-8: ip-172-31-44-10:14966:16988 [2] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64
ec2-54-244-82-8: ip-172-31-44-10:14967:16987 [3] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64
ec2-54-244-82-8: ip-172-31-44-10:14964:16986 [0] NCCL INFO Channel 00/08 :    0   1   2   3
ec2-54-244-82-8: ip-172-31-44-10:14966:16988 [2] NCCL INFO Trees [0] 1/-1/-1->2->3|3->2->1/-1/-1 [1] 3/-1/-1->2->1|1->2->3/-1/-1 [2] 1/-1/-1->2->3|3->2->1/-1/-1 [3] 3/-1/-1->2->1|1->2->3/-1/-1 [4] 1/-1/-1->2->3|3->2->1/-1/-1 [5] 3/-1/-1->2->1|1->2->3/-1/-1 [6] 1/-1/-1->2->3|3->2->1/-1/-1 [7] 3/-1/-1->2->1|1->2->3/-1/-1
ec2-54-244-82-8: ip-172-31-44-10:14967:16987 [3] NCCL INFO Trees [0] 2/-1/-1->3->0|0->3->2/-1/-1 [1] 0/-1/-1->3->2|2->3->0/-1/-1 [2] 2/-1/-1->3->0|0->3->2/-1/-1 [3] 0/-1/-1->3->2|2->3->0/-1/-1 [4] 2/-1/-1->3->0|0->3->2/-1/-1 [5] 0/-1/-1->3->2|2->3->0/-1/-1 [6] 2/-1/-1->3->0|0->3->2/-1/-1 [7] 0/-1/-1->3->2|2->3->0/-1/-1
ec2-54-244-82-8: ip-172-31-44-10:14964:16986 [0] NCCL INFO Channel 01/08 :    0   3   2   1
ec2-54-244-82-8: ip-172-31-44-10:14964:16986 [0] NCCL INFO Channel 02/08 :    0   3   1   2
ec2-54-244-82-8: ip-172-31-44-10:14964:16986 [0] NCCL INFO Channel 03/08 :    0   2   1   3
ec2-54-244-82-8: ip-172-31-44-10:14965:16989 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64
ec2-54-244-82-8: ip-172-31-44-10:14964:16986 [0] NCCL INFO Channel 04/08 :    0   1   2   3
ec2-54-244-82-8: ip-172-31-44-10:14964:16986 [0] NCCL INFO Channel 05/08 :    0   3   2   1
ec2-54-244-82-8: ip-172-31-44-10:14964:16986 [0] NCCL INFO Channel 06/08 :    0   3   1   2
ec2-54-244-82-8: ip-172-31-44-10:14964:16986 [0] NCCL INFO Channel 07/08 :    0   2   1   3
ec2-54-244-82-8: ip-172-31-44-10:14965:16989 [1] NCCL INFO Trees [0] -1/-1/-1->1->2|2->1->-1/-1/-1 [1] 2/-1/-1->1->-1|-1->1->2/-1/-1 [2] -1/-1/-1->1->2|2->1->-1/-1/-1 [3] 2/-1/-1->1->-1|-1->1->2/-1/-1 [4] -1/-1/-1->1->2|2->1->-1/-1/-1 [5] 2/-1/-1->1->-1|-1->1->2/-1/-1 [6] -1/-1/-1->1->2|2->1->-1/-1/-1 [7] 2/-1/-1->1->-1|-1->1->2/-1/-1
ec2-54-244-82-8: ip-172-31-44-10:14964:16986 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64
ec2-54-244-82-8: ip-172-31-44-10:14964:16986 [0] NCCL INFO Trees [0] 3/-1/-1->0->-1|-1->0->3/-1/-1 [1] -1/-1/-1->0->3|3->0->-1/-1/-1 [2] 3/-1/-1->0->-1|-1->0->3/-1/-1 [3] -1/-1/-1->0->3|3->0->-1/-1/-1 [4] 3/-1/-1->0->-1|-1->0->3/-1/-1 [5] -1/-1/-1->0->3|3->0->-1/-1/-1 [6] 3/-1/-1->0->-1|-1->0->3/-1/-1 [7] -1/-1/-1->0->3|3->0->-1/-1/-1
ec2-35-90-65-226: ip-172-31-38-78:3917:4921 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64
ec2-35-90-65-226: ip-172-31-38-78:3918:4917 [2] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64
ec2-35-90-65-226: ip-172-31-38-78:3918:4917 [2] NCCL INFO Trees [0] 1/-1/-1->2->3|3->2->1/-1/-1 [1] 3/-1/-1->2->1|1->2->3/-1/-1 [2] 1/-1/-1->2->3|3->2->1/-1/-1 [3] 3/-1/-1->2->1|1->2->3/-1/-1 [4] 1/-1/-1->2->3|3->2->1/-1/-1 [5] 3/-1/-1->2->1|1->2->3/-1/-1 [6] 1/-1/-1->2->3|3->2->1/-1/-1 [7] 3/-1/-1->2->1|1->2->3/-1/-1
ec2-35-90-65-226: ip-172-31-38-78:3919:4916 [3] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64
ec2-35-90-65-226: ip-172-31-38-78:3917:4921 [1] NCCL INFO Trees [0] -1/-1/-1->1->2|2->1->-1/-1/-1 [1] 2/-1/-1->1->-1|-1->1->2/-1/-1 [2] -1/-1/-1->1->2|2->1->-1/-1/-1 [3] 2/-1/-1->1->-1|-1->1->2/-1/-1 [4] -1/-1/-1->1->2|2->1->-1/-1/-1 [5] 2/-1/-1->1->-1|-1->1->2/-1/-1 [6] -1/-1/-1->1->2|2->1->-1/-1/-1 [7] 2/-1/-1->1->-1|-1->1->2/-1/-1
ec2-35-90-65-226: ip-172-31-38-78:3916:4915 [0] NCCL INFO Channel 00/08 :    0   1   2   3
ec2-35-90-65-226: ip-172-31-38-78:3916:4915 [0] NCCL INFO Channel 01/08 :    0   3   2   1
ec2-35-90-65-226: ip-172-31-38-78:3916:4915 [0] NCCL INFO Channel 02/08 :    0   3   1   2
ec2-35-90-65-226: ip-172-31-38-78:3919:4916 [3] NCCL INFO Trees [0] 2/-1/-1->3->0|0->3->2/-1/-1 [1] 0/-1/-1->3->2|2->3->0/-1/-1 [2] 2/-1/-1->3->0|0->3->2/-1/-1 [3] 0/-1/-1->3->2|2->3->0/-1/-1 [4] 2/-1/-1->3->0|0->3->2/-1/-1 [5] 0/-1/-1->3->2|2->3->0/-1/-1 [6] 2/-1/-1->3->0|0->3->2/-1/-1 [7] 0/-1/-1->3->2|2->3->0/-1/-1
ec2-35-90-65-226: ip-172-31-38-78:3916:4915 [0] NCCL INFO Channel 03/08 :    0   2   1   3
ec2-35-90-65-226: ip-172-31-38-78:3916:4915 [0] NCCL INFO Channel 04/08 :    0   1   2   3
ec2-35-90-65-226: ip-172-31-38-78:3916:4915 [0] NCCL INFO Channel 05/08 :    0   3   2   1
ec2-35-90-65-226: ip-172-31-38-78:3916:4915 [0] NCCL INFO Channel 06/08 :    0   3   1   2
ec2-35-90-65-226: ip-172-31-38-78:3916:4915 [0] NCCL INFO Channel 07/08 :    0   2   1   3
ec2-35-90-65-226: ip-172-31-38-78:3916:4915 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64
ec2-35-90-65-226: ip-172-31-38-78:3916:4915 [0] NCCL INFO Trees [0] 3/-1/-1->0->-1|-1->0->3/-1/-1 [1] -1/-1/-1->0->3|3->0->-1/-1/-1 [2] 3/-1/-1->0->-1|-1->0->3/-1/-1 [3] -1/-1/-1->0->3|3->0->-1/-1/-1 [4] 3/-1/-1->0->-1|-1->0->3/-1/-1 [5] -1/-1/-1->0->3|3->0->-1/-1/-1 [6] 3/-1/-1->0->-1|-1->0->3/-1/-1 [7] -1/-1/-1->0->3|3->0->-1/-1/-1
ec2-54-244-82-8: ip-172-31-44-10:14965:16989 [1] NCCL INFO Channel 00 : 1[1c0] -> 2[1d0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14966:16988 [2] NCCL INFO Channel 00 : 2[1d0] -> 3[1e0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14967:16987 [3] NCCL INFO Channel 00 : 3[1e0] -> 0[1b0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14964:16986 [0] NCCL INFO Channel 00 : 0[1b0] -> 1[1c0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3917:4921 [1] NCCL INFO Channel 00 : 1[1c0] -> 2[1d0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3918:4917 [2] NCCL INFO Channel 00 : 2[1d0] -> 3[1e0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3919:4916 [3] NCCL INFO Channel 00 : 3[1e0] -> 0[1b0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3916:4915 [0] NCCL INFO Channel 00 : 0[1b0] -> 1[1c0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14964:16986 [0] NCCL INFO Channel 00 : 0[1b0] -> 3[1e0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14966:16988 [2] NCCL INFO Channel 00 : 2[1d0] -> 1[1c0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14967:16987 [3] NCCL INFO Channel 00 : 3[1e0] -> 2[1d0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3916:4915 [0] NCCL INFO Channel 00 : 0[1b0] -> 3[1e0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3918:4917 [2] NCCL INFO Channel 00 : 2[1d0] -> 1[1c0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3919:4916 [3] NCCL INFO Channel 00 : 3[1e0] -> 2[1d0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14964:16986 [0] NCCL INFO Channel 01 : 0[1b0] -> 3[1e0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14965:16989 [1] NCCL INFO Channel 01 : 1[1c0] -> 0[1b0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14966:16988 [2] NCCL INFO Channel 01 : 2[1d0] -> 1[1c0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3916:4915 [0] NCCL INFO Channel 01 : 0[1b0] -> 3[1e0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14967:16987 [3] NCCL INFO Channel 01 : 3[1e0] -> 2[1d0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3917:4921 [1] NCCL INFO Channel 01 : 1[1c0] -> 0[1b0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3918:4917 [2] NCCL INFO Channel 01 : 2[1d0] -> 1[1c0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3919:4916 [3] NCCL INFO Channel 01 : 3[1e0] -> 2[1d0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14965:16989 [1] NCCL INFO Channel 01 : 1[1c0] -> 2[1d0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14966:16988 [2] NCCL INFO Channel 01 : 2[1d0] -> 3[1e0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3917:4921 [1] NCCL INFO Channel 01 : 1[1c0] -> 2[1d0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14967:16987 [3] NCCL INFO Channel 01 : 3[1e0] -> 0[1b0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3918:4917 [2] NCCL INFO Channel 01 : 2[1d0] -> 3[1e0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3919:4916 [3] NCCL INFO Channel 01 : 3[1e0] -> 0[1b0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14965:16989 [1] NCCL INFO Channel 02 : 1[1c0] -> 2[1d0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3917:4921 [1] NCCL INFO Channel 02 : 1[1c0] -> 2[1d0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14964:16986 [0] NCCL INFO Channel 02 : 0[1b0] -> 3[1e0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14966:16988 [2] NCCL INFO Channel 02 : 2[1d0] -> 0[1b0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14967:16987 [3] NCCL INFO Channel 02 : 3[1e0] -> 1[1c0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3916:4915 [0] NCCL INFO Channel 02 : 0[1b0] -> 3[1e0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3918:4917 [2] NCCL INFO Channel 02 : 2[1d0] -> 0[1b0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3919:4916 [3] NCCL INFO Channel 02 : 3[1e0] -> 1[1c0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14966:16988 [2] NCCL INFO Channel 02 : 2[1d0] -> 3[1e0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14967:16987 [3] NCCL INFO Channel 02 : 3[1e0] -> 0[1b0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3918:4917 [2] NCCL INFO Channel 02 : 2[1d0] -> 3[1e0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3919:4916 [3] NCCL INFO Channel 02 : 3[1e0] -> 0[1b0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14966:16988 [2] NCCL INFO Channel 02 : 2[1d0] -> 1[1c0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14967:16987 [3] NCCL INFO Channel 02 : 3[1e0] -> 2[1d0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3918:4917 [2] NCCL INFO Channel 02 : 2[1d0] -> 1[1c0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14964:16986 [0] NCCL INFO Channel 03 : 0[1b0] -> 2[1d0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3919:4916 [3] NCCL INFO Channel 02 : 3[1e0] -> 2[1d0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3916:4915 [0] NCCL INFO Channel 03 : 0[1b0] -> 2[1d0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14965:16989 [1] NCCL INFO Channel 03 : 1[1c0] -> 3[1e0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14966:16988 [2] NCCL INFO Channel 03 : 2[1d0] -> 1[1c0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14967:16987 [3] NCCL INFO Channel 03 : 3[1e0] -> 0[1b0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3917:4921 [1] NCCL INFO Channel 03 : 1[1c0] -> 3[1e0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3919:4916 [3] NCCL INFO Channel 03 : 3[1e0] -> 0[1b0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3918:4917 [2] NCCL INFO Channel 03 : 2[1d0] -> 1[1c0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14965:16989 [1] NCCL INFO Channel 03 : 1[1c0] -> 2[1d0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14964:16986 [0] NCCL INFO Channel 03 : 0[1b0] -> 3[1e0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14967:16987 [3] NCCL INFO Channel 03 : 3[1e0] -> 2[1d0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3916:4915 [0] NCCL INFO Channel 03 : 0[1b0] -> 3[1e0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3917:4921 [1] NCCL INFO Channel 03 : 1[1c0] -> 2[1d0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3919:4916 [3] NCCL INFO Channel 03 : 3[1e0] -> 2[1d0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14964:16986 [0] NCCL INFO Channel 04 : 0[1b0] -> 1[1c0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14966:16988 [2] NCCL INFO Channel 03 : 2[1d0] -> 3[1e0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3916:4915 [0] NCCL INFO Channel 04 : 0[1b0] -> 1[1c0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3918:4917 [2] NCCL INFO Channel 03 : 2[1d0] -> 3[1e0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14965:16989 [1] NCCL INFO Channel 04 : 1[1c0] -> 2[1d0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14967:16987 [3] NCCL INFO Channel 04 : 3[1e0] -> 0[1b0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3917:4921 [1] NCCL INFO Channel 04 : 1[1c0] -> 2[1d0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14966:16988 [2] NCCL INFO Channel 04 : 2[1d0] -> 3[1e0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3919:4916 [3] NCCL INFO Channel 04 : 3[1e0] -> 0[1b0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14964:16986 [0] NCCL INFO Channel 04 : 0[1b0] -> 3[1e0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3918:4917 [2] NCCL INFO Channel 04 : 2[1d0] -> 3[1e0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14967:16987 [3] NCCL INFO Channel 04 : 3[1e0] -> 2[1d0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3916:4915 [0] NCCL INFO Channel 04 : 0[1b0] -> 3[1e0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14966:16988 [2] NCCL INFO Channel 04 : 2[1d0] -> 1[1c0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3919:4916 [3] NCCL INFO Channel 04 : 3[1e0] -> 2[1d0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14964:16986 [0] NCCL INFO Channel 05 : 0[1b0] -> 3[1e0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3918:4917 [2] NCCL INFO Channel 04 : 2[1d0] -> 1[1c0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14965:16989 [1] NCCL INFO Channel 05 : 1[1c0] -> 0[1b0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14967:16987 [3] NCCL INFO Channel 05 : 3[1e0] -> 2[1d0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14966:16988 [2] NCCL INFO Channel 05 : 2[1d0] -> 1[1c0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3916:4915 [0] NCCL INFO Channel 05 : 0[1b0] -> 3[1e0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3919:4916 [3] NCCL INFO Channel 05 : 3[1e0] -> 2[1d0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3917:4921 [1] NCCL INFO Channel 05 : 1[1c0] -> 0[1b0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14965:16989 [1] NCCL INFO Channel 05 : 1[1c0] -> 2[1d0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3918:4917 [2] NCCL INFO Channel 05 : 2[1d0] -> 1[1c0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14967:16987 [3] NCCL INFO Channel 05 : 3[1e0] -> 0[1b0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14966:16988 [2] NCCL INFO Channel 05 : 2[1d0] -> 3[1e0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3917:4921 [1] NCCL INFO Channel 05 : 1[1c0] -> 2[1d0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3919:4916 [3] NCCL INFO Channel 05 : 3[1e0] -> 0[1b0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14965:16989 [1] NCCL INFO Channel 06 : 1[1c0] -> 2[1d0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14964:16986 [0] NCCL INFO Channel 06 : 0[1b0] -> 3[1e0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3918:4917 [2] NCCL INFO Channel 05 : 2[1d0] -> 3[1e0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14967:16987 [3] NCCL INFO Channel 06 : 3[1e0] -> 1[1c0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14966:16988 [2] NCCL INFO Channel 06 : 2[1d0] -> 0[1b0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3917:4921 [1] NCCL INFO Channel 06 : 1[1c0] -> 2[1d0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3916:4915 [0] NCCL INFO Channel 06 : 0[1b0] -> 3[1e0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14966:16988 [2] NCCL INFO Channel 06 : 2[1d0] -> 3[1e0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3919:4916 [3] NCCL INFO Channel 06 : 3[1e0] -> 1[1c0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14967:16987 [3] NCCL INFO Channel 06 : 3[1e0] -> 0[1b0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3918:4917 [2] NCCL INFO Channel 06 : 2[1d0] -> 0[1b0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14966:16988 [2] NCCL INFO Channel 06 : 2[1d0] -> 1[1c0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14967:16987 [3] NCCL INFO Channel 06 : 3[1e0] -> 2[1d0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14964:16986 [0] NCCL INFO Channel 07 : 0[1b0] -> 2[1d0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3918:4917 [2] NCCL INFO Channel 06 : 2[1d0] -> 3[1e0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3919:4916 [3] NCCL INFO Channel 06 : 3[1e0] -> 0[1b0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14965:16989 [1] NCCL INFO Channel 07 : 1[1c0] -> 3[1e0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14967:16987 [3] NCCL INFO Channel 07 : 3[1e0] -> 0[1b0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14966:16988 [2] NCCL INFO Channel 07 : 2[1d0] -> 1[1c0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3918:4917 [2] NCCL INFO Channel 06 : 2[1d0] -> 1[1c0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3919:4916 [3] NCCL INFO Channel 06 : 3[1e0] -> 2[1d0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3916:4915 [0] NCCL INFO Channel 07 : 0[1b0] -> 2[1d0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14964:16986 [0] NCCL INFO Channel 07 : 0[1b0] -> 3[1e0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14965:16989 [1] NCCL INFO Channel 07 : 1[1c0] -> 2[1d0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14964:16986 [0] NCCL INFO 8 coll channels, 8 p2p channels, 2 p2p channels per peer
ec2-54-244-82-8: ip-172-31-44-10:14967:16987 [3] NCCL INFO Channel 07 : 3[1e0] -> 2[1d0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14964:16986 [0] NCCL INFO comm 0x7f8fc8001060 rank 0 nranks 4 cudaDev 0 busId 1b0 - Init COMPLETE
ec2-35-90-65-226: ip-172-31-38-78:3919:4916 [3] NCCL INFO Channel 07 : 3[1e0] -> 0[1b0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14964:14964 [0] NCCL INFO Launch mode Parallel
ec2-35-90-65-226: ip-172-31-38-78:3917:4921 [1] NCCL INFO Channel 07 : 1[1c0] -> 3[1e0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3918:4917 [2] NCCL INFO Channel 07 : 2[1d0] -> 1[1c0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14965:16989 [1] NCCL INFO 8 coll channels, 8 p2p channels, 2 p2p channels per peer
ec2-54-244-82-8: ip-172-31-44-10:14966:16988 [2] NCCL INFO Channel 07 : 2[1d0] -> 3[1e0] via P2P/IPC
ec2-54-244-82-8: ip-172-31-44-10:14965:16989 [1] NCCL INFO comm 0x7f2398001060 rank 1 nranks 4 cudaDev 1 busId 1c0 - Init COMPLETE
ec2-54-244-82-8: ip-172-31-44-10:14967:16987 [3] NCCL INFO 8 coll channels, 8 p2p channels, 2 p2p channels per peer
ec2-54-244-82-8: ip-172-31-44-10:14967:16987 [3] NCCL INFO comm 0x7fcfdc001060 rank 3 nranks 4 cudaDev 3 busId 1e0 - Init COMPLETE
ec2-54-244-82-8: ip-172-31-44-10:14966:16988 [2] NCCL INFO 8 coll channels, 8 p2p channels, 2 p2p channels per peer
ec2-54-244-82-8: ip-172-31-44-10:14966:16988 [2] NCCL INFO comm 0x7f4b10001060 rank 2 nranks 4 cudaDev 2 busId 1d0 - Init COMPLETE
ec2-35-90-65-226: ip-172-31-38-78:3916:4915 [0] NCCL INFO Channel 07 : 0[1b0] -> 3[1e0] via P2P/IPC
ec2-54-244-82-8: [2022-10-08 14:54:32,146] [INFO] [engine.py:596:_configure_optimizer] Removing param_group that has no 'params'in the client Optimizer
ec2-35-90-65-226: ip-172-31-38-78:3917:4921 [1] NCCL INFO Channel 07 : 1[1c0] -> 2[1d0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3916:4915 [0] NCCL INFO 8 coll channels, 8 p2p channels, 2 p2p channels per peer
ec2-35-90-65-226: ip-172-31-38-78:3916:4915 [0] NCCL INFO comm 0x7f886c001060 rank 0 nranks 4 cudaDev 0 busId 1b0 - Init COMPLETE
ec2-35-90-65-226: ip-172-31-38-78:3919:4916 [3] NCCL INFO Channel 07 : 3[1e0] -> 2[1d0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3916:3916 [0] NCCL INFO Launch mode Parallel
ec2-54-244-82-8: [2022-10-08 14:54:32,148] [INFO] [engine.py:596:_configure_optimizer] Removing param_group that has no 'params'in the client Optimizer
ec2-54-244-82-8: [2022-10-08 14:54:32,149] [INFO] [engine.py:596:_configure_optimizer] Removing param_group that has no 'params'in the client Optimizer
ec2-54-244-82-8: [2022-10-08 14:54:32,149] [INFO] [engine.py:596:_configure_optimizer] Removing param_group that has no 'params'in the client Optimizer
ec2-35-90-65-226: ip-172-31-38-78:3917:4921 [1] NCCL INFO 8 coll channels, 8 p2p channels, 2 p2p channels per peer
ec2-35-90-65-226: ip-172-31-38-78:3918:4917 [2] NCCL INFO Channel 07 : 2[1d0] -> 3[1e0] via P2P/IPC
ec2-35-90-65-226: ip-172-31-38-78:3917:4921 [1] NCCL INFO comm 0x7f2054001060 rank 1 nranks 4 cudaDev 1 busId 1c0 - Init COMPLETE
ec2-35-90-65-226: [2022-10-08 14:54:32,151] [INFO] [engine.py:596:_configure_optimizer] Removing param_group that has no 'params'in the client Optimizer
ec2-35-90-65-226: ip-172-31-38-78:3919:4916 [3] NCCL INFO 8 coll channels, 8 p2p channels, 2 p2p channels per peer
ec2-35-90-65-226: ip-172-31-38-78:3919:4916 [3] NCCL INFO comm 0x7f5234001060 rank 3 nranks 4 cudaDev 3 busId 1e0 - Init COMPLETE
ec2-35-90-65-226: ip-172-31-38-78:3918:4917 [2] NCCL INFO 8 coll channels, 8 p2p channels, 2 p2p channels per peer
ec2-35-90-65-226: ip-172-31-38-78:3918:4917 [2] NCCL INFO comm 0x7f6124001060 rank 2 nranks 4 cudaDev 2 busId 1d0 - Init COMPLETE
ec2-35-90-65-226: [2022-10-08 14:54:32,154] [INFO] [engine.py:596:_configure_optimizer] Removing param_group that has no 'params'in the client Optimizer
ec2-35-90-65-226: [2022-10-08 14:54:32,155] [INFO] [engine.py:596:_configure_optimizer] Removing param_group that has no 'params'in the client Optimizer
ec2-35-90-65-226: [2022-10-08 14:54:32,155] [INFO] [engine.py:596:_configure_optimizer] Removing param_group that has no 'params'in the client Optimizer
ec2-35-90-65-226: Using /home/ubuntu/.cache/torch_extensions as PyTorch extensions root...Using /home/ubuntu/.cache/torch_extensions as PyTorch extensions root...Using /home/ubuntu/.cache/torch_extensions as PyTorch extensions root...Using /home/ubuntu/.cache/torch_extensions as PyTorch extensions root...
ec2-35-90-65-226: 
ec2-35-90-65-226: 
ec2-35-90-65-226: 
ec2-54-244-82-8: Using /home/ubuntu/.cache/torch_extensions as PyTorch extensions root...Using /home/ubuntu/.cache/torch_extensions as PyTorch extensions root...Using /home/ubuntu/.cache/torch_extensions as PyTorch extensions root...Using /home/ubuntu/.cache/torch_extensions as PyTorch extensions root...
ec2-54-244-82-8: 
ec2-54-244-82-8: 
ec2-54-244-82-8: 
ec2-34-219-204-184: --------------------------initializing deepspeed-------------------------------
ec2-34-219-204-184: using pipeline Engine
ec2-34-219-204-184: zero is enabaled: False ---------------
ec2-34-219-204-184: ds check: 64 1 16
ec2-34-219-204-184: haha {'_param_dict': {'train_micro_batch_size_per_gpu': 1, 'gradient_accumulation_steps': 16, 'gradient_clipping': 1.0, 'steps_per_print': 10, 'wall_clock_breakdown': True, 'fp16': {'enabled': True, 'loss_scale': 0, 'loss_scale_window': 1000, 'hysteresis': 2, 'min_loss_scale': 1}, 'zero_allow_untested_optimizer': False, 'fp32_allreduce': True}, 'global_rank': 2, 'world_size': 4, 'elasticity_enabled': False, 'train_batch_size': 64, 'train_micro_batch_size_per_gpu': 1, 'gradient_accumulation_steps': 16, 'steps_per_print': 10, 'dump_state': False, 'disable_allgather': False, 'allreduce_always_fp32': True, 'prescale_gradients': False, 'gradient_predivide_factor': 1.0, 'sparse_gradients_enabled': False, 'zero_config': {
ec2-34-219-204-184:     "allgather_bucket_size": 500000000,
ec2-34-219-204-184:     "allgather_partitions": true,
ec2-34-219-204-184:     "contiguous_gradients": false,
ec2-34-219-204-184:     "cpu_offload": false,
ec2-34-219-204-184:     "cpu_offload_params": false,
ec2-34-219-204-184:     "cpu_offload_use_pin_memory": "cpu_offload_use_pin_memory",
ec2-34-219-204-184:     "elastic_checkpoint": true,
ec2-34-219-204-184:     "load_from_fp32_weights": true,
ec2-34-219-204-184:     "max_live_parameters": 1000000000,
ec2-34-219-204-184:     "max_reuse_distance": 1000000000,
ec2-34-219-204-184:     "overlap_comm": false,
ec2-34-219-204-184:     "param_persistence_threshold": 100000,
ec2-34-219-204-184:     "prefetch_bucket_size": 50000000,
ec2-34-219-204-184:     "reduce_bucket_size": 500000000,
ec2-34-219-204-184:     "reduce_scatter": true,
ec2-34-219-204-184:     "stage": 0,
ec2-34-219-204-184:     "sub_group_size": 1000000000000
ec2-34-219-204-184: }, 'zero_optimization_stage': 0, 'zero_enabled': False, 'activation_checkpointing_config': {
ec2-34-219-204-184:     "contiguous_memory_optimization": false,
ec2-34-219-204-184:     "cpu_checkpointing": false,
ec2-34-219-204-184:     "number_checkpoints": null,
ec2-34-219-204-184:     "partition_activations": false,
ec2-34-219-204-184:     "profile": false,
ec2-34-219-204-184:     "synchronize_checkpoint_boundary": false
ec2-34-219-204-184: }, 'gradient_clipping': 1.0, 'fp16_enabled': True, 'amp_enabled': False, 'amp_params': False, 'loss_scale': 0, 'initial_dynamic_scale': 4294967296, 'dynamic_loss_scale_args': {'init_scale': 4294967296, 'scale_window': 1000, 'delayed_shift': 2, 'min_scale': 1}, 'optimizer_name': None, 'optimizer_params': None, 'optimizer_legacy_fusion': False, 'zero_allow_untested_optimizer': False, 'scheduler_name': None, 'scheduler_params': None, 'wall_clock_breakdown': True, 'flops_profiler_config': {
ec2-34-219-204-184:     "detailed": true,
ec2-34-219-204-184:     "enabled": false,
ec2-34-219-204-184:     "module_depth": -1,
ec2-34-219-204-184:     "profile_step": 1,
ec2-34-219-204-184:     "top_modules": 3
ec2-34-219-204-184: }, 'memory_breakdown': False, 'tensorboard_enabled': False, 'tensorboard_output_path': '', 'tensorboard_job_name': 'DeepSpeedJobName', 'sparse_attention': None, 'pipeline': {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}, 'pld_enabled': False, 'pld_params': False, 'checkpoint_tag_validation_enabled': True, 'checkpoint_tag_validation_fail': False}
ec2-34-219-204-184:  > number of parameters on model parallel rank 0: 155972781
ec2-34-219-204-184: DeepSpeed is enabled.
ec2-34-219-204-184: --------------------------initializing deepspeed-------------------------------
ec2-34-219-204-184: [2022-10-08 14:54:32,284] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed info: version=0.3.13+a0c809e, git-hash=a0c809e, git-branch=master
ec2-34-219-204-184: using pipeline Engine
ec2-34-219-204-184: zero is enabaled: False ---------------
ec2-34-219-204-184: ds check: 64 1 16
ec2-34-219-204-184: haha {'_param_dict': {'train_micro_batch_size_per_gpu': 1, 'gradient_accumulation_steps': 16, 'gradient_clipping': 1.0, 'steps_per_print': 10, 'wall_clock_breakdown': True, 'fp16': {'enabled': True, 'loss_scale': 0, 'loss_scale_window': 1000, 'hysteresis': 2, 'min_loss_scale': 1}, 'zero_allow_untested_optimizer': False, 'fp32_allreduce': True}, 'global_rank': 0, 'world_size': 4, 'elasticity_enabled': False, 'train_batch_size': 64, 'train_micro_batch_size_per_gpu': 1, 'gradient_accumulation_steps': 16, 'steps_per_print': 10, 'dump_state': False, 'disable_allgather': False, 'allreduce_always_fp32': True, 'prescale_gradients': False, 'gradient_predivide_factor': 1.0, 'sparse_gradients_enabled': False, 'zero_config': {
ec2-34-219-204-184:     "allgather_bucket_size": 500000000,
ec2-34-219-204-184:     "allgather_partitions": true,
ec2-34-219-204-184:     "contiguous_gradients": false,
ec2-34-219-204-184:     "cpu_offload": false,
ec2-34-219-204-184:     "cpu_offload_params": false,
ec2-34-219-204-184:     "cpu_offload_use_pin_memory": "cpu_offload_use_pin_memory",
ec2-34-219-204-184:     "elastic_checkpoint": true,
ec2-34-219-204-184:     "load_from_fp32_weights": true,
ec2-34-219-204-184:     "max_live_parameters": 1000000000,
ec2-34-219-204-184:     "max_reuse_distance": 1000000000,
ec2-34-219-204-184:     "overlap_comm": false,
ec2-34-219-204-184:     "param_persistence_threshold": 100000,
ec2-34-219-204-184:     "prefetch_bucket_size": 50000000,
ec2-34-219-204-184:     "reduce_bucket_size": 500000000,
ec2-34-219-204-184:     "reduce_scatter": true,
ec2-34-219-204-184:     "stage": 0,
ec2-34-219-204-184:     "sub_group_size": 1000000000000
ec2-34-219-204-184: }, 'zero_optimization_stage': 0, 'zero_enabled': False, 'activation_checkpointing_config': {
ec2-34-219-204-184:     "contiguous_memory_optimization": false,
ec2-34-219-204-184:     "cpu_checkpointing": false,
ec2-34-219-204-184:     "number_checkpoints": null,
ec2-34-219-204-184:     "partition_activations": false,
ec2-34-219-204-184:     "profile": false,
ec2-34-219-204-184:     "synchronize_checkpoint_boundary": false
ec2-34-219-204-184: }, 'gradient_clipping': 1.0, 'fp16_enabled': True, 'amp_enabled': False, 'amp_params': False, 'loss_scale': 0, 'initial_dynamic_scale': 4294967296, 'dynamic_loss_scale_args': {'init_scale': 4294967296, 'scale_window': 1000, 'delayed_shift': 2, 'min_scale': 1}, 'optimizer_name': None, 'optimizer_params': None, 'optimizer_legacy_fusion': False, 'zero_allow_untested_optimizer': False, 'scheduler_name': None, 'scheduler_params': None, 'wall_clock_breakdown': True, 'flops_profiler_config': {
ec2-34-219-204-184:     "detailed": true,
ec2-34-219-204-184:     "enabled": false,
ec2-34-219-204-184:     "module_depth": -1,
ec2-34-219-204-184:     "profile_step": 1,
ec2-34-219-204-184:     "top_modules": 3
ec2-34-219-204-184: }, 'memory_breakdown': False, 'tensorboard_enabled': False, 'tensorboard_output_path': '', 'tensorboard_job_name': 'DeepSpeedJobName', 'sparse_attention': None, 'pipeline': {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}, 'pld_enabled': False, 'pld_params': False, 'checkpoint_tag_validation_enabled': True, 'checkpoint_tag_validation_fail': False}
ec2-34-219-204-184: --------------------------initializing deepspeed-------------------------------
ec2-34-219-204-184: using pipeline Engine
ec2-34-219-204-184: zero is enabaled: False ---------------
ec2-34-219-204-184: ds check: 64 1 16
ec2-34-219-204-184: haha {'_param_dict': {'train_micro_batch_size_per_gpu': 1, 'gradient_accumulation_steps': 16, 'gradient_clipping': 1.0, 'steps_per_print': 10, 'wall_clock_breakdown': True, 'fp16': {'enabled': True, 'loss_scale': 0, 'loss_scale_window': 1000, 'hysteresis': 2, 'min_loss_scale': 1}, 'zero_allow_untested_optimizer': False, 'fp32_allreduce': True}, 'global_rank': 1, 'world_size': 4, 'elasticity_enabled': False, 'train_batch_size': 64, 'train_micro_batch_size_per_gpu': 1, 'gradient_accumulation_steps': 16, 'steps_per_print': 10, 'dump_state': False, 'disable_allgather': False, 'allreduce_always_fp32': True, 'prescale_gradients': False, 'gradient_predivide_factor': 1.0, 'sparse_gradients_enabled': False, 'zero_config': {
ec2-34-219-204-184:     "allgather_bucket_size": 500000000,
ec2-34-219-204-184:     "allgather_partitions": true,
ec2-34-219-204-184:     "contiguous_gradients": false,
ec2-34-219-204-184:     "cpu_offload": false,
ec2-34-219-204-184:     "cpu_offload_params": false,
ec2-34-219-204-184:     "cpu_offload_use_pin_memory": "cpu_offload_use_pin_memory",
ec2-34-219-204-184:     "elastic_checkpoint": true,
ec2-34-219-204-184:     "load_from_fp32_weights": true,
ec2-34-219-204-184:     "max_live_parameters": 1000000000,
ec2-34-219-204-184:     "max_reuse_distance": 1000000000,
ec2-34-219-204-184:     "overlap_comm": false,
ec2-34-219-204-184:     "param_persistence_threshold": 100000,
ec2-34-219-204-184:     "prefetch_bucket_size": 50000000,
ec2-34-219-204-184:     "reduce_bucket_size": 500000000,
ec2-34-219-204-184:     "reduce_scatter": true,
ec2-34-219-204-184:     "stage": 0,
ec2-34-219-204-184:     "sub_group_size": 1000000000000
ec2-34-219-204-184: }, 'zero_optimization_stage': 0, 'zero_enabled': False, 'activation_checkpointing_config': {
ec2-34-219-204-184:     "contiguous_memory_optimization": false,
ec2-34-219-204-184:     "cpu_checkpointing": false,
ec2-34-219-204-184:     "number_checkpoints": null,
ec2-34-219-204-184:     "partition_activations": false,
ec2-34-219-204-184:     "profile": false,
ec2-34-219-204-184:     "synchronize_checkpoint_boundary": false
ec2-34-219-204-184: }, 'gradient_clipping': 1.0, 'fp16_enabled': True, 'amp_enabled': False, 'amp_params': False, 'loss_scale': 0, 'initial_dynamic_scale': 4294967296, 'dynamic_loss_scale_args': {'init_scale': 4294967296, 'scale_window': 1000, 'delayed_shift': 2, 'min_scale': 1}, 'optimizer_name': None, 'optimizer_params': None, 'optimizer_legacy_fusion': False, 'zero_allow_untested_optimizer': False, 'scheduler_name': None, 'scheduler_params': None, 'wall_clock_breakdown': True, 'flops_profiler_config': {
ec2-34-219-204-184:     "detailed": true,
ec2-34-219-204-184:     "enabled": false,
ec2-34-219-204-184:     "module_depth": -1,
ec2-34-219-204-184:     "profile_step": 1,
ec2-34-219-204-184:     "top_modules": 3
ec2-34-219-204-184: }, 'memory_breakdown': False, 'tensorboard_enabled': False, 'tensorboard_output_path': '', 'tensorboard_job_name': 'DeepSpeedJobName', 'sparse_attention': None, 'pipeline': {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}, 'pld_enabled': False, 'pld_params': False, 'checkpoint_tag_validation_enabled': True, 'checkpoint_tag_validation_fail': False}
ec2-34-219-204-184: --------------------------initializing deepspeed-------------------------------
ec2-34-219-204-184: using pipeline Engine
ec2-34-219-204-184: zero is enabaled: False ---------------
ec2-34-219-204-184: ds check: 64 1 16
ec2-34-219-204-184: haha {'_param_dict': {'train_micro_batch_size_per_gpu': 1, 'gradient_accumulation_steps': 16, 'gradient_clipping': 1.0, 'steps_per_print': 10, 'wall_clock_breakdown': True, 'fp16': {'enabled': True, 'loss_scale': 0, 'loss_scale_window': 1000, 'hysteresis': 2, 'min_loss_scale': 1}, 'zero_allow_untested_optimizer': False, 'fp32_allreduce': True}, 'global_rank': 3, 'world_size': 4, 'elasticity_enabled': False, 'train_batch_size': 64, 'train_micro_batch_size_per_gpu': 1, 'gradient_accumulation_steps': 16, 'steps_per_print': 10, 'dump_state': False, 'disable_allgather': False, 'allreduce_always_fp32': True, 'prescale_gradients': False, 'gradient_predivide_factor': 1.0, 'sparse_gradients_enabled': False, 'zero_config': {
ec2-34-219-204-184:     "allgather_bucket_size": 500000000,
ec2-34-219-204-184:     "allgather_partitions": true,
ec2-34-219-204-184:     "contiguous_gradients": false,
ec2-34-219-204-184:     "cpu_offload": false,
ec2-34-219-204-184:     "cpu_offload_params": false,
ec2-34-219-204-184:     "cpu_offload_use_pin_memory": "cpu_offload_use_pin_memory",
ec2-34-219-204-184:     "elastic_checkpoint": true,
ec2-34-219-204-184:     "load_from_fp32_weights": true,
ec2-34-219-204-184:     "max_live_parameters": 1000000000,
ec2-34-219-204-184:     "max_reuse_distance": 1000000000,
ec2-34-219-204-184:     "overlap_comm": false,
ec2-34-219-204-184:     "param_persistence_threshold": 100000,
ec2-34-219-204-184:     "prefetch_bucket_size": 50000000,
ec2-34-219-204-184:     "reduce_bucket_size": 500000000,
ec2-34-219-204-184:     "reduce_scatter": true,
ec2-34-219-204-184:     "stage": 0,
ec2-34-219-204-184:     "sub_group_size": 1000000000000
ec2-34-219-204-184: }, 'zero_optimization_stage': 0, 'zero_enabled': False, 'activation_checkpointing_config': {
ec2-34-219-204-184:     "contiguous_memory_optimization": false,
ec2-34-219-204-184:     "cpu_checkpointing": false,
ec2-34-219-204-184:     "number_checkpoints": null,
ec2-34-219-204-184:     "partition_activations": false,
ec2-34-219-204-184:     "profile": false,
ec2-34-219-204-184:     "synchronize_checkpoint_boundary": false
ec2-34-219-204-184: }, 'gradient_clipping': 1.0, 'fp16_enabled': True, 'amp_enabled': False, 'amp_params': False, 'loss_scale': 0, 'initial_dynamic_scale': 4294967296, 'dynamic_loss_scale_args': {'init_scale': 4294967296, 'scale_window': 1000, 'delayed_shift': 2, 'min_scale': 1}, 'optimizer_name': None, 'optimizer_params': None, 'optimizer_legacy_fusion': False, 'zero_allow_untested_optimizer': False, 'scheduler_name': None, 'scheduler_params': None, 'wall_clock_breakdown': True, 'flops_profiler_config': {
ec2-34-219-204-184:     "detailed": true,
ec2-34-219-204-184:     "enabled": false,
ec2-34-219-204-184:     "module_depth": -1,
ec2-34-219-204-184:     "profile_step": 1,
ec2-34-219-204-184:     "top_modules": 3
ec2-34-219-204-184: }, 'memory_breakdown': False, 'tensorboard_enabled': False, 'tensorboard_output_path': '', 'tensorboard_job_name': 'DeepSpeedJobName', 'sparse_attention': None, 'pipeline': {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}, 'pld_enabled': False, 'pld_params': False, 'checkpoint_tag_validation_enabled': True, 'checkpoint_tag_validation_fail': False}
ec2-35-90-65-226: Emitting ninja build file /home/ubuntu/.cache/torch_extensions/utils/build.ninja...
ec2-35-90-65-226: Building extension module utils...
ec2-35-90-65-226: Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ec2-54-244-82-8: Emitting ninja build file /home/ubuntu/.cache/torch_extensions/utils/build.ninja...
ec2-54-244-82-8: Building extension module utils...
ec2-54-244-82-8: Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ec2-35-90-65-226: ninja: no work to do.
ec2-35-90-65-226: Loading extension module utils...
ec2-35-90-65-226: Time to load utils op: 0.2778611183166504 seconds
ec2-35-90-65-226: Loading extension module utils...Loading extension module utils...Loading extension module utils...
ec2-35-90-65-226: 
ec2-35-90-65-226: 
ec2-34-219-204-184: ip-172-31-41-243:10715:12739 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64
ec2-34-219-204-184: ip-172-31-41-243:10716:12738 [2] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64
ec2-34-219-204-184: ip-172-31-41-243:10715:12739 [1] NCCL INFO Trees [0] -1/-1/-1->1->2|2->1->-1/-1/-1 [1] 2/-1/-1->1->-1|-1->1->2/-1/-1 [2] -1/-1/-1->1->2|2->1->-1/-1/-1 [3] 2/-1/-1->1->-1|-1->1->2/-1/-1 [4] -1/-1/-1->1->2|2->1->-1/-1/-1 [5] 2/-1/-1->1->-1|-1->1->2/-1/-1 [6] -1/-1/-1->1->2|2->1->-1/-1/-1 [7] 2/-1/-1->1->-1|-1->1->2/-1/-1
ec2-34-219-204-184: ip-172-31-41-243:10716:12738 [2] NCCL INFO Trees [0] 1/-1/-1->2->3|3->2->1/-1/-1 [1] 3/-1/-1->2->1|1->2->3/-1/-1 [2] 1/-1/-1->2->3|3->2->1/-1/-1 [3] 3/-1/-1->2->1|1->2->3/-1/-1 [4] 1/-1/-1->2->3|3->2->1/-1/-1 [5] 3/-1/-1->2->1|1->2->3/-1/-1 [6] 1/-1/-1->2->3|3->2->1/-1/-1 [7] 3/-1/-1->2->1|1->2->3/-1/-1
ec2-34-219-204-184: ip-172-31-41-243:10717:12740 [3] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64
ec2-34-219-204-184: ip-172-31-41-243:10714:12737 [0] NCCL INFO Channel 00/08 :    0   1   2   3
ec2-34-219-204-184: ip-172-31-41-243:10714:12737 [0] NCCL INFO Channel 01/08 :    0   3   2   1
ec2-34-219-204-184: ip-172-31-41-243:10714:12737 [0] NCCL INFO Channel 02/08 :    0   3   1   2
ec2-34-219-204-184: ip-172-31-41-243:10717:12740 [3] NCCL INFO Trees [0] 2/-1/-1->3->0|0->3->2/-1/-1 [1] 0/-1/-1->3->2|2->3->0/-1/-1 [2] 2/-1/-1->3->0|0->3->2/-1/-1 [3] 0/-1/-1->3->2|2->3->0/-1/-1 [4] 2/-1/-1->3->0|0->3->2/-1/-1 [5] 0/-1/-1->3->2|2->3->0/-1/-1 [6] 2/-1/-1->3->0|0->3->2/-1/-1 [7] 0/-1/-1->3->2|2->3->0/-1/-1
ec2-34-219-204-184: ip-172-31-41-243:10714:12737 [0] NCCL INFO Channel 03/08 :    0   2   1   3
ec2-34-219-204-184: ip-172-31-41-243:10714:12737 [0] NCCL INFO Channel 04/08 :    0   1   2   3
ec2-34-219-204-184: ip-172-31-41-243:10714:12737 [0] NCCL INFO Channel 05/08 :    0   3   2   1
ec2-34-219-204-184: ip-172-31-41-243:10714:12737 [0] NCCL INFO Channel 06/08 :    0   3   1   2
ec2-34-219-204-184: ip-172-31-41-243:10714:12737 [0] NCCL INFO Channel 07/08 :    0   2   1   3
ec2-34-219-204-184: ip-172-31-41-243:10714:12737 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64
ec2-34-219-204-184: ip-172-31-41-243:10714:12737 [0] NCCL INFO Trees [0] 3/-1/-1->0->-1|-1->0->3/-1/-1 [1] -1/-1/-1->0->3|3->0->-1/-1/-1 [2] 3/-1/-1->0->-1|-1->0->3/-1/-1 [3] -1/-1/-1->0->3|3->0->-1/-1/-1 [4] 3/-1/-1->0->-1|-1->0->3/-1/-1 [5] -1/-1/-1->0->3|3->0->-1/-1/-1 [6] 3/-1/-1->0->-1|-1->0->3/-1/-1 [7] -1/-1/-1->0->3|3->0->-1/-1/-1
ec2-35-90-65-226: Time to load utils op: 0.3059382438659668 secondsTime to load utils op: 0.3059408664703369 secondsTime to load utils op: 0.30594658851623535 seconds
ec2-35-90-65-226: 
ec2-35-90-65-226: 
ec2-34-219-204-184: ip-172-31-41-243:10715:12739 [1] NCCL INFO Channel 00 : 1[1c0] -> 2[1d0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10717:12740 [3] NCCL INFO Channel 00 : 3[1e0] -> 0[1b0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10716:12738 [2] NCCL INFO Channel 00 : 2[1d0] -> 3[1e0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10714:12737 [0] NCCL INFO Channel 00 : 0[1b0] -> 1[1c0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10714:12737 [0] NCCL INFO Channel 00 : 0[1b0] -> 3[1e0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10716:12738 [2] NCCL INFO Channel 00 : 2[1d0] -> 1[1c0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10717:12740 [3] NCCL INFO Channel 00 : 3[1e0] -> 2[1d0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10714:12737 [0] NCCL INFO Channel 01 : 0[1b0] -> 3[1e0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10715:12739 [1] NCCL INFO Channel 01 : 1[1c0] -> 0[1b0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10716:12738 [2] NCCL INFO Channel 01 : 2[1d0] -> 1[1c0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10717:12740 [3] NCCL INFO Channel 01 : 3[1e0] -> 2[1d0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10715:12739 [1] NCCL INFO Channel 01 : 1[1c0] -> 2[1d0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10717:12740 [3] NCCL INFO Channel 01 : 3[1e0] -> 0[1b0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10716:12738 [2] NCCL INFO Channel 01 : 2[1d0] -> 3[1e0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10715:12739 [1] NCCL INFO Channel 02 : 1[1c0] -> 2[1d0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10714:12737 [0] NCCL INFO Channel 02 : 0[1b0] -> 3[1e0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10716:12738 [2] NCCL INFO Channel 02 : 2[1d0] -> 0[1b0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10717:12740 [3] NCCL INFO Channel 02 : 3[1e0] -> 1[1c0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10716:12738 [2] NCCL INFO Channel 02 : 2[1d0] -> 3[1e0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10717:12740 [3] NCCL INFO Channel 02 : 3[1e0] -> 0[1b0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10716:12738 [2] NCCL INFO Channel 02 : 2[1d0] -> 1[1c0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10717:12740 [3] NCCL INFO Channel 02 : 3[1e0] -> 2[1d0] via P2P/IPC
ec2-54-244-82-8: ninja: no work to do.
ec2-34-219-204-184: ip-172-31-41-243:10714:12737 [0] NCCL INFO Channel 03 : 0[1b0] -> 2[1d0] via P2P/IPC
ec2-54-244-82-8: Loading extension module utils...
ec2-34-219-204-184: ip-172-31-41-243:10715:12739 [1] NCCL INFO Channel 03 : 1[1c0] -> 3[1e0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10716:12738 [2] NCCL INFO Channel 03 : 2[1d0] -> 1[1c0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10717:12740 [3] NCCL INFO Channel 03 : 3[1e0] -> 0[1b0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10715:12739 [1] NCCL INFO Channel 03 : 1[1c0] -> 2[1d0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10714:12737 [0] NCCL INFO Channel 03 : 0[1b0] -> 3[1e0] via P2P/IPC
ec2-54-244-82-8: Time to load utils op: 0.2840452194213867 seconds
ec2-34-219-204-184: ip-172-31-41-243:10717:12740 [3] NCCL INFO Channel 03 : 3[1e0] -> 2[1d0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10714:12737 [0] NCCL INFO Channel 04 : 0[1b0] -> 1[1c0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10716:12738 [2] NCCL INFO Channel 03 : 2[1d0] -> 3[1e0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10715:12739 [1] NCCL INFO Channel 04 : 1[1c0] -> 2[1d0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10717:12740 [3] NCCL INFO Channel 04 : 3[1e0] -> 0[1b0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10716:12738 [2] NCCL INFO Channel 04 : 2[1d0] -> 3[1e0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10714:12737 [0] NCCL INFO Channel 04 : 0[1b0] -> 3[1e0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10717:12740 [3] NCCL INFO Channel 04 : 3[1e0] -> 2[1d0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10716:12738 [2] NCCL INFO Channel 04 : 2[1d0] -> 1[1c0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10714:12737 [0] NCCL INFO Channel 05 : 0[1b0] -> 3[1e0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10715:12739 [1] NCCL INFO Channel 05 : 1[1c0] -> 0[1b0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10717:12740 [3] NCCL INFO Channel 05 : 3[1e0] -> 2[1d0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10716:12738 [2] NCCL INFO Channel 05 : 2[1d0] -> 1[1c0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10715:12739 [1] NCCL INFO Channel 05 : 1[1c0] -> 2[1d0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10717:12740 [3] NCCL INFO Channel 05 : 3[1e0] -> 0[1b0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10716:12738 [2] NCCL INFO Channel 05 : 2[1d0] -> 3[1e0] via P2P/IPC
ec2-54-244-82-8: Loading extension module utils...Loading extension module utils...
ec2-54-244-82-8: 
ec2-54-244-82-8: Loading extension module utils...
ec2-34-219-204-184: ip-172-31-41-243:10715:12739 [1] NCCL INFO Channel 06 : 1[1c0] -> 2[1d0] via P2P/IPC
ec2-54-244-82-8: Time to load utils op: 0.30675673484802246 secondsTime to load utils op: 0.3067655563354492 secondsTime to load utils op: 0.30676794052124023 seconds
ec2-54-244-82-8: 
ec2-54-244-82-8: 
ec2-34-219-204-184: ip-172-31-41-243:10714:12737 [0] NCCL INFO Channel 06 : 0[1b0] -> 3[1e0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10717:12740 [3] NCCL INFO Channel 06 : 3[1e0] -> 1[1c0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10716:12738 [2] NCCL INFO Channel 06 : 2[1d0] -> 0[1b0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10716:12738 [2] NCCL INFO Channel 06 : 2[1d0] -> 3[1e0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10717:12740 [3] NCCL INFO Channel 06 : 3[1e0] -> 0[1b0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10716:12738 [2] NCCL INFO Channel 06 : 2[1d0] -> 1[1c0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10717:12740 [3] NCCL INFO Channel 06 : 3[1e0] -> 2[1d0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10714:12737 [0] NCCL INFO Channel 07 : 0[1b0] -> 2[1d0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10715:12739 [1] NCCL INFO Channel 07 : 1[1c0] -> 3[1e0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10716:12738 [2] NCCL INFO Channel 07 : 2[1d0] -> 1[1c0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10717:12740 [3] NCCL INFO Channel 07 : 3[1e0] -> 0[1b0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10715:12739 [1] NCCL INFO Channel 07 : 1[1c0] -> 2[1d0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10714:12737 [0] NCCL INFO Channel 07 : 0[1b0] -> 3[1e0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10714:12737 [0] NCCL INFO 8 coll channels, 8 p2p channels, 2 p2p channels per peer
ec2-34-219-204-184: ip-172-31-41-243:10717:12740 [3] NCCL INFO Channel 07 : 3[1e0] -> 2[1d0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10714:12737 [0] NCCL INFO comm 0x7f2448001060 rank 0 nranks 4 cudaDev 0 busId 1b0 - Init COMPLETE
ec2-34-219-204-184: ip-172-31-41-243:10714:10714 [0] NCCL INFO Launch mode Parallel
ec2-34-219-204-184: ip-172-31-41-243:10715:12739 [1] NCCL INFO 8 coll channels, 8 p2p channels, 2 p2p channels per peer
ec2-34-219-204-184: ip-172-31-41-243:10716:12738 [2] NCCL INFO Channel 07 : 2[1d0] -> 3[1e0] via P2P/IPC
ec2-34-219-204-184: ip-172-31-41-243:10715:12739 [1] NCCL INFO comm 0x7fc1e4001060 rank 1 nranks 4 cudaDev 1 busId 1c0 - Init COMPLETE
ec2-34-219-204-184: ip-172-31-41-243:10717:12740 [3] NCCL INFO 8 coll channels, 8 p2p channels, 2 p2p channels per peer
ec2-34-219-204-184: ip-172-31-41-243:10717:12740 [3] NCCL INFO comm 0x7f7068001060 rank 3 nranks 4 cudaDev 3 busId 1e0 - Init COMPLETE
ec2-34-219-204-184: ip-172-31-41-243:10716:12738 [2] NCCL INFO 8 coll channels, 8 p2p channels, 2 p2p channels per peer
ec2-34-219-204-184: ip-172-31-41-243:10716:12738 [2] NCCL INFO comm 0x7f6740001060 rank 2 nranks 4 cudaDev 2 busId 1d0 - Init COMPLETE
ec2-34-219-204-184: [2022-10-08 14:54:32,564] [INFO] [engine.py:596:_configure_optimizer] Removing param_group that has no 'params'in the client Optimizer
ec2-34-219-204-184: [2022-10-08 14:54:32,564] [INFO] [engine.py:600:_configure_optimizer] Using client Optimizer as basic optimizer
ec2-34-219-204-184: [2022-10-08 14:54:32,564] [INFO] [engine.py:610:_configure_optimizer] DeepSpeed Basic Optimizer = Adam
ec2-34-219-204-184: [2022-10-08 14:54:32,564] [INFO] [logging.py:60:log_dist] [Rank 0] Creating fp16 unfused optimizer with dynamic loss scale
ec2-34-219-204-184: [2022-10-08 14:54:32,564] [INFO] [unfused_optimizer.py:36:__init__] Fused Lamb Legacy : False 
ec2-34-219-204-184: [2022-10-08 14:54:32,566] [INFO] [engine.py:596:_configure_optimizer] Removing param_group that has no 'params'in the client Optimizer
ec2-34-219-204-184: [2022-10-08 14:54:32,568] [INFO] [engine.py:596:_configure_optimizer] Removing param_group that has no 'params'in the client Optimizer
ec2-34-219-204-184: [2022-10-08 14:54:32,569] [INFO] [engine.py:596:_configure_optimizer] Removing param_group that has no 'params'in the client Optimizer
ec2-34-219-204-184: [2022-10-08 14:54:32,795] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed Final Optimizer = Adam
ec2-34-219-204-184: [2022-10-08 14:54:32,795] [INFO] [engine.py:447:_configure_lr_scheduler] DeepSpeed using client LR scheduler
ec2-34-219-204-184: [2022-10-08 14:54:32,795] [INFO] [logging.py:60:log_dist] [Rank 0] DeepSpeed LR Scheduler = <megatron.learning_rates.LinearLrDecay object at 0x7f254404c978>
ec2-34-219-204-184: [2022-10-08 14:54:32,795] [INFO] [logging.py:60:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0001, 0.0001], mom=[(0.0, 0.99), (0.0, 0.99)]
ec2-34-219-204-184: [2022-10-08 14:54:32,795] [INFO] [config.py:744:print] DeepSpeedEngine configuration:
ec2-34-219-204-184: [2022-10-08 14:54:32,795] [INFO] [config.py:748:print]   activation_checkpointing_config  {
ec2-34-219-204-184:     "contiguous_memory_optimization": false,
ec2-34-219-204-184:     "cpu_checkpointing": false,
ec2-34-219-204-184:     "number_checkpoints": null,
ec2-34-219-204-184:     "partition_activations": false,
ec2-34-219-204-184:     "profile": false,
ec2-34-219-204-184:     "synchronize_checkpoint_boundary": false
ec2-34-219-204-184: }
ec2-34-219-204-184: [2022-10-08 14:54:32,795] [INFO] [config.py:748:print]   allreduce_always_fp32 ........ True
ec2-34-219-204-184: [2022-10-08 14:54:32,795] [INFO] [config.py:748:print]   amp_enabled .................. False
ec2-34-219-204-184: [2022-10-08 14:54:32,795] [INFO] [config.py:748:print]   amp_params ................... False
ec2-34-219-204-184: [2022-10-08 14:54:32,796] [INFO] [config.py:748:print]   checkpoint_tag_validation_enabled  True
ec2-34-219-204-184: [2022-10-08 14:54:32,796] [INFO] [config.py:748:print]   checkpoint_tag_validation_fail  False
ec2-34-219-204-184: [2022-10-08 14:54:32,796] [INFO] [config.py:748:print]   disable_allgather ............ False
ec2-34-219-204-184: [2022-10-08 14:54:32,796] [INFO] [config.py:748:print]   dump_state ................... False
ec2-34-219-204-184: [2022-10-08 14:54:32,796] [INFO] [config.py:748:print]   dynamic_loss_scale_args ...... {'init_scale': 4294967296, 'scale_window': 1000, 'delayed_shift': 2, 'min_scale': 1}
ec2-34-219-204-184: [2022-10-08 14:54:32,796] [INFO] [config.py:748:print]   elasticity_enabled ........... False
ec2-34-219-204-184: [2022-10-08 14:54:32,796] [INFO] [config.py:748:print]   flops_profiler_config ........ {
ec2-34-219-204-184:     "detailed": true,
ec2-34-219-204-184:     "enabled": false,
ec2-34-219-204-184:     "module_depth": -1,
ec2-34-219-204-184:     "profile_step": 1,
ec2-34-219-204-184:     "top_modules": 3
ec2-34-219-204-184: }
ec2-34-219-204-184: [2022-10-08 14:54:32,796] [INFO] [config.py:748:print]   fp16_enabled ................. True
ec2-34-219-204-184: [2022-10-08 14:54:32,796] [INFO] [config.py:748:print]   global_rank .................. 0
ec2-34-219-204-184: [2022-10-08 14:54:32,796] [INFO] [config.py:748:print]   gradient_accumulation_steps .. 16
ec2-34-219-204-184: [2022-10-08 14:54:32,796] [INFO] [config.py:748:print]   gradient_clipping ............ 1.0
ec2-34-219-204-184: [2022-10-08 14:54:32,796] [INFO] [config.py:748:print]   gradient_predivide_factor .... 1.0
ec2-34-219-204-184: [2022-10-08 14:54:32,796] [INFO] [config.py:748:print]   initial_dynamic_scale ........ 4294967296
ec2-34-219-204-184: [2022-10-08 14:54:32,796] [INFO] [config.py:748:print]   loss_scale ................... 0
ec2-34-219-204-184: [2022-10-08 14:54:32,796] [INFO] [config.py:748:print]   memory_breakdown ............. False
ec2-34-219-204-184: [2022-10-08 14:54:32,796] [INFO] [config.py:748:print]   optimizer_legacy_fusion ...... False
ec2-34-219-204-184: [2022-10-08 14:54:32,796] [INFO] [config.py:748:print]   optimizer_name ............... None
ec2-34-219-204-184: [2022-10-08 14:54:32,796] [INFO] [config.py:748:print]   optimizer_params ............. None
ec2-34-219-204-184: [2022-10-08 14:54:32,796] [INFO] [config.py:748:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}
ec2-34-219-204-184: [2022-10-08 14:54:32,796] [INFO] [config.py:748:print]   pld_enabled .................. False
ec2-34-219-204-184: [2022-10-08 14:54:32,796] [INFO] [config.py:748:print]   pld_params ................... False
ec2-34-219-204-184: [2022-10-08 14:54:32,796] [INFO] [config.py:748:print]   prescale_gradients ........... False
ec2-34-219-204-184: [2022-10-08 14:54:32,796] [INFO] [config.py:748:print]   scheduler_name ............... None
ec2-34-219-204-184: [2022-10-08 14:54:32,797] [INFO] [config.py:748:print]   scheduler_params ............. None
ec2-34-219-204-184: [2022-10-08 14:54:32,797] [INFO] [config.py:748:print]   sparse_attention ............. None
ec2-34-219-204-184: [2022-10-08 14:54:32,797] [INFO] [config.py:748:print]   sparse_gradients_enabled ..... False
ec2-34-219-204-184: [2022-10-08 14:54:32,797] [INFO] [config.py:748:print]   steps_per_print .............. 10
ec2-34-219-204-184: [2022-10-08 14:54:32,797] [INFO] [config.py:748:print]   tensorboard_enabled .......... False
ec2-34-219-204-184: [2022-10-08 14:54:32,797] [INFO] [config.py:748:print]   tensorboard_job_name ......... DeepSpeedJobName
ec2-34-219-204-184: [2022-10-08 14:54:32,797] [INFO] [config.py:748:print]   tensorboard_output_path ...... 
ec2-34-219-204-184: [2022-10-08 14:54:32,797] [INFO] [config.py:748:print]   train_batch_size ............. 64
ec2-34-219-204-184: [2022-10-08 14:54:32,797] [INFO] [config.py:748:print]   train_micro_batch_size_per_gpu  1
ec2-34-219-204-184: [2022-10-08 14:54:32,797] [INFO] [config.py:748:print]   wall_clock_breakdown ......... True
ec2-34-219-204-184: [2022-10-08 14:54:32,797] [INFO] [config.py:748:print]   world_size ................... 4
ec2-34-219-204-184: [2022-10-08 14:54:32,797] [INFO] [config.py:748:print]   zero_allow_untested_optimizer  False
ec2-34-219-204-184: [2022-10-08 14:54:32,797] [INFO] [config.py:748:print]   zero_config .................. {
ec2-34-219-204-184:     "allgather_bucket_size": 500000000,
ec2-34-219-204-184:     "allgather_partitions": true,
ec2-34-219-204-184:     "contiguous_gradients": false,
ec2-34-219-204-184:     "cpu_offload": false,
ec2-34-219-204-184:     "cpu_offload_params": false,
ec2-34-219-204-184:     "cpu_offload_use_pin_memory": "cpu_offload_use_pin_memory",
ec2-34-219-204-184:     "elastic_checkpoint": true,
ec2-34-219-204-184:     "load_from_fp32_weights": true,
ec2-34-219-204-184:     "max_live_parameters": 1000000000,
ec2-34-219-204-184:     "max_reuse_distance": 1000000000,
ec2-34-219-204-184:     "overlap_comm": false,
ec2-34-219-204-184:     "param_persistence_threshold": 100000,
ec2-34-219-204-184:     "prefetch_bucket_size": 50000000,
ec2-34-219-204-184:     "reduce_bucket_size": 500000000,
ec2-34-219-204-184:     "reduce_scatter": true,
ec2-34-219-204-184:     "stage": 0,
ec2-34-219-204-184:     "sub_group_size": 1000000000000
ec2-34-219-204-184: }
ec2-34-219-204-184: [2022-10-08 14:54:32,797] [INFO] [config.py:748:print]   zero_enabled ................. False
ec2-34-219-204-184: [2022-10-08 14:54:32,797] [INFO] [config.py:748:print]   zero_optimization_stage ...... 0
ec2-34-219-204-184: [2022-10-08 14:54:32,797] [INFO] [config.py:754:print]   json = {
ec2-34-219-204-184:     "fp16":{
ec2-34-219-204-184:         "enabled":true,
ec2-34-219-204-184:         "hysteresis":2,
ec2-34-219-204-184:         "loss_scale":0,
ec2-34-219-204-184:         "loss_scale_window":1000,
ec2-34-219-204-184:         "min_loss_scale":1
ec2-34-219-204-184:     },
ec2-34-219-204-184:     "fp32_allreduce":true,
ec2-34-219-204-184:     "gradient_accumulation_steps":16,
ec2-34-219-204-184:     "gradient_clipping":1.0,
ec2-34-219-204-184:     "steps_per_print":10,
ec2-34-219-204-184:     "train_micro_batch_size_per_gpu":1,
ec2-34-219-204-184:     "wall_clock_breakdown":true,
ec2-34-219-204-184:     "zero_allow_untested_optimizer":false
ec2-34-219-204-184: }
ec2-34-219-204-184: Using /home/ubuntu/.cache/torch_extensions as PyTorch extensions root...Using /home/ubuntu/.cache/torch_extensions as PyTorch extensions root...Using /home/ubuntu/.cache/torch_extensions as PyTorch extensions root...
ec2-34-219-204-184: 
ec2-34-219-204-184: 
ec2-34-219-204-184: Using /home/ubuntu/.cache/torch_extensions as PyTorch extensions root...
ec2-35-90-28-66: --------------------------initializing deepspeed-------------------------------
ec2-35-90-28-66: using pipeline Engine
ec2-35-90-28-66: zero is enabaled: False ---------------
ec2-35-90-28-66: ds check: 64 1 16
ec2-35-90-28-66: haha {'_param_dict': {'train_micro_batch_size_per_gpu': 1, 'gradient_accumulation_steps': 16, 'gradient_clipping': 1.0, 'steps_per_print': 10, 'wall_clock_breakdown': True, 'fp16': {'enabled': True, 'loss_scale': 0, 'loss_scale_window': 1000, 'hysteresis': 2, 'min_loss_scale': 1}, 'zero_allow_untested_optimizer': False, 'fp32_allreduce': True}, 'global_rank': 13, 'world_size': 4, 'elasticity_enabled': False, 'train_batch_size': 64, 'train_micro_batch_size_per_gpu': 1, 'gradient_accumulation_steps': 16, 'steps_per_print': 10, 'dump_state': False, 'disable_allgather': False, 'allreduce_always_fp32': True, 'prescale_gradients': False, 'gradient_predivide_factor': 1.0, 'sparse_gradients_enabled': False, 'zero_config': {
ec2-35-90-28-66:     "allgather_bucket_size": 500000000,
ec2-35-90-28-66:     "allgather_partitions": true,
ec2-35-90-28-66:     "contiguous_gradients": false,
ec2-35-90-28-66:     "cpu_offload": false,
ec2-35-90-28-66:     "cpu_offload_params": false,
ec2-35-90-28-66:     "cpu_offload_use_pin_memory": "cpu_offload_use_pin_memory",
ec2-35-90-28-66:     "elastic_checkpoint": true,
ec2-35-90-28-66:     "load_from_fp32_weights": true,
ec2-35-90-28-66:     "max_live_parameters": 1000000000,
ec2-35-90-28-66:     "max_reuse_distance": 1000000000,
ec2-35-90-28-66:     "overlap_comm": false,
ec2-35-90-28-66:     "param_persistence_threshold": 100000,
ec2-35-90-28-66:     "prefetch_bucket_size": 50000000,
ec2-35-90-28-66:     "reduce_bucket_size": 500000000,
ec2-35-90-28-66:     "reduce_scatter": true,
ec2-35-90-28-66:     "stage": 0,
ec2-35-90-28-66:     "sub_group_size": 1000000000000
ec2-35-90-28-66: }, 'zero_optimization_stage': 0, 'zero_enabled': False, 'activation_checkpointing_config': {
ec2-35-90-28-66:     "contiguous_memory_optimization": false,
ec2-35-90-28-66:     "cpu_checkpointing": false,
ec2-35-90-28-66:     "number_checkpoints": null,
ec2-35-90-28-66:     "partition_activations": false,
ec2-35-90-28-66:     "profile": false,
ec2-35-90-28-66:     "synchronize_checkpoint_boundary": false
ec2-35-90-28-66: }, 'gradient_clipping': 1.0, 'fp16_enabled': True, 'amp_enabled': False, 'amp_params': False, 'loss_scale': 0, 'initial_dynamic_scale': 4294967296, 'dynamic_loss_scale_args': {'init_scale': 4294967296, 'scale_window': 1000, 'delayed_shift': 2, 'min_scale': 1}, 'optimizer_name': None, 'optimizer_params': None, 'optimizer_legacy_fusion': False, 'zero_allow_untested_optimizer': False, 'scheduler_name': None, 'scheduler_params': None, 'wall_clock_breakdown': True, 'flops_profiler_config': {
ec2-35-90-28-66:     "detailed": true,
ec2-35-90-28-66:     "enabled": false,
ec2-35-90-28-66:     "module_depth": -1,
ec2-35-90-28-66:     "profile_step": 1,
ec2-35-90-28-66:     "top_modules": 3
ec2-35-90-28-66: }, 'memory_breakdown': False, 'tensorboard_enabled': False, 'tensorboard_output_path': '', 'tensorboard_job_name': 'DeepSpeedJobName', 'sparse_attention': None, 'pipeline': {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}, 'pld_enabled': False, 'pld_params': False, 'checkpoint_tag_validation_enabled': True, 'checkpoint_tag_validation_fail': False}
ec2-35-90-28-66:  > number of parameters on model parallel rank 0: 32519
ec2-35-90-28-66: --------------------------initializing deepspeed-------------------------------
ec2-35-90-28-66: using pipeline Engine
ec2-35-90-28-66: zero is enabaled: False ---------------
ec2-35-90-28-66: ds check: 64 1 16
ec2-35-90-28-66: haha {'_param_dict': {'train_micro_batch_size_per_gpu': 1, 'gradient_accumulation_steps': 16, 'gradient_clipping': 1.0, 'steps_per_print': 10, 'wall_clock_breakdown': True, 'fp16': {'enabled': True, 'loss_scale': 0, 'loss_scale_window': 1000, 'hysteresis': 2, 'min_loss_scale': 1}, 'zero_allow_untested_optimizer': False, 'fp32_allreduce': True}, 'global_rank': 12, 'world_size': 4, 'elasticity_enabled': False, 'train_batch_size': 64, 'train_micro_batch_size_per_gpu': 1, 'gradient_accumulation_steps': 16, 'steps_per_print': 10, 'dump_state': False, 'disable_allgather': False, 'allreduce_always_fp32': True, 'prescale_gradients': False, 'gradient_predivide_factor': 1.0, 'sparse_gradients_enabled': False, 'zero_config': {
ec2-35-90-28-66:     "allgather_bucket_size": 500000000,
ec2-35-90-28-66:     "allgather_partitions": true,
ec2-35-90-28-66:     "contiguous_gradients": false,
ec2-35-90-28-66:     "cpu_offload": false,
ec2-35-90-28-66:     "cpu_offload_params": false,
ec2-35-90-28-66:     "cpu_offload_use_pin_memory": "cpu_offload_use_pin_memory",
ec2-35-90-28-66:     "elastic_checkpoint": true,
ec2-35-90-28-66:     "load_from_fp32_weights": true,
ec2-35-90-28-66:     "max_live_parameters": 1000000000,
ec2-35-90-28-66:     "max_reuse_distance": 1000000000,
ec2-35-90-28-66:     "overlap_comm": false,
ec2-35-90-28-66:     "param_persistence_threshold": 100000,
ec2-35-90-28-66:     "prefetch_bucket_size": 50000000,
ec2-35-90-28-66:     "reduce_bucket_size": 500000000,
ec2-35-90-28-66:     "reduce_scatter": true,
ec2-35-90-28-66:     "stage": 0,
ec2-35-90-28-66:     "sub_group_size": 1000000000000
ec2-35-90-28-66: }, 'zero_optimization_stage': 0, 'zero_enabled': False, 'activation_checkpointing_config': {
ec2-35-90-28-66:     "contiguous_memory_optimization": false,
ec2-35-90-28-66:     "cpu_checkpointing": false,
ec2-35-90-28-66:     "number_checkpoints": null,
ec2-35-90-28-66:     "partition_activations": false,
ec2-35-90-28-66:     "profile": false,
ec2-35-90-28-66:     "synchronize_checkpoint_boundary": false
ec2-35-90-28-66: }, 'gradient_clipping': 1.0, 'fp16_enabled': True, 'amp_enabled': False, 'amp_params': False, 'loss_scale': 0, 'initial_dynamic_scale': 4294967296, 'dynamic_loss_scale_args': {'init_scale': 4294967296, 'scale_window': 1000, 'delayed_shift': 2, 'min_scale': 1}, 'optimizer_name': None, 'optimizer_params': None, 'optimizer_legacy_fusion': False, 'zero_allow_untested_optimizer': False, 'scheduler_name': None, 'scheduler_params': None, 'wall_clock_breakdown': True, 'flops_profiler_config': {
ec2-35-90-28-66:     "detailed": true,
ec2-35-90-28-66:     "enabled": false,
ec2-35-90-28-66:     "module_depth": -1,
ec2-35-90-28-66:     "profile_step": 1,
ec2-35-90-28-66:     "top_modules": 3
ec2-35-90-28-66: }, 'memory_breakdown': False, 'tensorboard_enabled': False, 'tensorboard_output_path': '', 'tensorboard_job_name': 'DeepSpeedJobName', 'sparse_attention': None, 'pipeline': {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}, 'pld_enabled': False, 'pld_params': False, 'checkpoint_tag_validation_enabled': True, 'checkpoint_tag_validation_fail': False}
ec2-35-90-28-66: --------------------------initializing deepspeed-------------------------------
ec2-35-90-28-66: using pipeline Engine
ec2-35-90-28-66: zero is enabaled: False ---------------
ec2-35-90-28-66: ds check: 64 1 16
ec2-35-90-28-66: haha {'_param_dict': {'train_micro_batch_size_per_gpu': 1, 'gradient_accumulation_steps': 16, 'gradient_clipping': 1.0, 'steps_per_print': 10, 'wall_clock_breakdown': True, 'fp16': {'enabled': True, 'loss_scale': 0, 'loss_scale_window': 1000, 'hysteresis': 2, 'min_loss_scale': 1}, 'zero_allow_untested_optimizer': False, 'fp32_allreduce': True}, 'global_rank': 15, 'world_size': 4, 'elasticity_enabled': False, 'train_batch_size': 64, 'train_micro_batch_size_per_gpu': 1, 'gradient_accumulation_steps': 16, 'steps_per_print': 10, 'dump_state': False, 'disable_allgather': False, 'allreduce_always_fp32': True, 'prescale_gradients': False, 'gradient_predivide_factor': 1.0, 'sparse_gradients_enabled': False, 'zero_config': {
ec2-35-90-28-66:     "allgather_bucket_size": 500000000,
ec2-35-90-28-66:     "allgather_partitions": true,
ec2-35-90-28-66:     "contiguous_gradients": false,
ec2-35-90-28-66:     "cpu_offload": false,
ec2-35-90-28-66:     "cpu_offload_params": false,
ec2-35-90-28-66:     "cpu_offload_use_pin_memory": "cpu_offload_use_pin_memory",
ec2-35-90-28-66:     "elastic_checkpoint": true,
ec2-35-90-28-66:     "load_from_fp32_weights": true,
ec2-35-90-28-66:     "max_live_parameters": 1000000000,
ec2-35-90-28-66:     "max_reuse_distance": 1000000000,
ec2-35-90-28-66:     "overlap_comm": false,
ec2-35-90-28-66:     "param_persistence_threshold": 100000,
ec2-35-90-28-66:     "prefetch_bucket_size": 50000000,
ec2-35-90-28-66:     "reduce_bucket_size": 500000000,
ec2-35-90-28-66:     "reduce_scatter": true,
ec2-35-90-28-66:     "stage": 0,
ec2-35-90-28-66:     "sub_group_size": 1000000000000
ec2-35-90-28-66: }, 'zero_optimization_stage': 0, 'zero_enabled': False, 'activation_checkpointing_config': {
ec2-35-90-28-66:     "contiguous_memory_optimization": false,
ec2-35-90-28-66:     "cpu_checkpointing": false,
ec2-35-90-28-66:     "number_checkpoints": null,
ec2-35-90-28-66:     "partition_activations": false,
ec2-35-90-28-66:     "profile": false,
ec2-35-90-28-66:     "synchronize_checkpoint_boundary": false
ec2-35-90-28-66: }, 'gradient_clipping': 1.0, 'fp16_enabled': True, 'amp_enabled': False, 'amp_params': False, 'loss_scale': 0, 'initial_dynamic_scale': 4294967296, 'dynamic_loss_scale_args': {'init_scale': 4294967296, 'scale_window': 1000, 'delayed_shift': 2, 'min_scale': 1}, 'optimizer_name': None, 'optimizer_params': None, 'optimizer_legacy_fusion': False, 'zero_allow_untested_optimizer': False, 'scheduler_name': None, 'scheduler_params': None, 'wall_clock_breakdown': True, 'flops_profiler_config': {
ec2-35-90-28-66:     "detailed": true,
ec2-35-90-28-66:     "enabled": false,
ec2-35-90-28-66:     "module_depth": -1,
ec2-35-90-28-66:     "profile_step": 1,
ec2-35-90-28-66:     "top_modules": 3
ec2-35-90-28-66: }, 'memory_breakdown': False, 'tensorboard_enabled': False, 'tensorboard_output_path': '', 'tensorboard_job_name': 'DeepSpeedJobName', 'sparse_attention': None, 'pipeline': {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}, 'pld_enabled': False, 'pld_params': False, 'checkpoint_tag_validation_enabled': True, 'checkpoint_tag_validation_fail': False}
ec2-35-90-28-66: --------------------------initializing deepspeed-------------------------------
ec2-35-90-28-66: using pipeline Engine
ec2-35-90-28-66: zero is enabaled: False ---------------
ec2-35-90-28-66: ds check: 64 1 16
ec2-35-90-28-66: haha {'_param_dict': {'train_micro_batch_size_per_gpu': 1, 'gradient_accumulation_steps': 16, 'gradient_clipping': 1.0, 'steps_per_print': 10, 'wall_clock_breakdown': True, 'fp16': {'enabled': True, 'loss_scale': 0, 'loss_scale_window': 1000, 'hysteresis': 2, 'min_loss_scale': 1}, 'zero_allow_untested_optimizer': False, 'fp32_allreduce': True}, 'global_rank': 14, 'world_size': 4, 'elasticity_enabled': False, 'train_batch_size': 64, 'train_micro_batch_size_per_gpu': 1, 'gradient_accumulation_steps': 16, 'steps_per_print': 10, 'dump_state': False, 'disable_allgather': False, 'allreduce_always_fp32': True, 'prescale_gradients': False, 'gradient_predivide_factor': 1.0, 'sparse_gradients_enabled': False, 'zero_config': {
ec2-35-90-28-66:     "allgather_bucket_size": 500000000,
ec2-35-90-28-66:     "allgather_partitions": true,
ec2-35-90-28-66:     "contiguous_gradients": false,
ec2-35-90-28-66:     "cpu_offload": false,
ec2-35-90-28-66:     "cpu_offload_params": false,
ec2-35-90-28-66:     "cpu_offload_use_pin_memory": "cpu_offload_use_pin_memory",
ec2-35-90-28-66:     "elastic_checkpoint": true,
ec2-35-90-28-66:     "load_from_fp32_weights": true,
ec2-35-90-28-66:     "max_live_parameters": 1000000000,
ec2-35-90-28-66:     "max_reuse_distance": 1000000000,
ec2-35-90-28-66:     "overlap_comm": false,
ec2-35-90-28-66:     "param_persistence_threshold": 100000,
ec2-35-90-28-66:     "prefetch_bucket_size": 50000000,
ec2-35-90-28-66:     "reduce_bucket_size": 500000000,
ec2-35-90-28-66:     "reduce_scatter": true,
ec2-35-90-28-66:     "stage": 0,
ec2-35-90-28-66:     "sub_group_size": 1000000000000
ec2-35-90-28-66: }, 'zero_optimization_stage': 0, 'zero_enabled': False, 'activation_checkpointing_config': {
ec2-35-90-28-66:     "contiguous_memory_optimization": false,
ec2-35-90-28-66:     "cpu_checkpointing": false,
ec2-35-90-28-66:     "number_checkpoints": null,
ec2-35-90-28-66:     "partition_activations": false,
ec2-35-90-28-66:     "profile": false,
ec2-35-90-28-66:     "synchronize_checkpoint_boundary": false
ec2-35-90-28-66: }, 'gradient_clipping': 1.0, 'fp16_enabled': True, 'amp_enabled': False, 'amp_params': False, 'loss_scale': 0, 'initial_dynamic_scale': 4294967296, 'dynamic_loss_scale_args': {'init_scale': 4294967296, 'scale_window': 1000, 'delayed_shift': 2, 'min_scale': 1}, 'optimizer_name': None, 'optimizer_params': None, 'optimizer_legacy_fusion': False, 'zero_allow_untested_optimizer': False, 'scheduler_name': None, 'scheduler_params': None, 'wall_clock_breakdown': True, 'flops_profiler_config': {
ec2-35-90-28-66:     "detailed": true,
ec2-35-90-28-66:     "enabled": false,
ec2-35-90-28-66:     "module_depth": -1,
ec2-35-90-28-66:     "profile_step": 1,
ec2-35-90-28-66:     "top_modules": 3
ec2-35-90-28-66: }, 'memory_breakdown': False, 'tensorboard_enabled': False, 'tensorboard_output_path': '', 'tensorboard_job_name': 'DeepSpeedJobName', 'sparse_attention': None, 'pipeline': {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0}, 'pld_enabled': False, 'pld_params': False, 'checkpoint_tag_validation_enabled': True, 'checkpoint_tag_validation_fail': False}
ec2-35-90-28-66: NCCL version 2.7.8+cuda11.0
ec2-34-219-204-184: Emitting ninja build file /home/ubuntu/.cache/torch_extensions/utils/build.ninja...
ec2-34-219-204-184: Building extension module utils...
ec2-34-219-204-184: Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ec2-35-90-28-66: ip-172-31-39-36:4025:4773 [2] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64
ec2-35-90-28-66: ip-172-31-39-36:4026:4772 [3] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64
ec2-35-90-28-66: ip-172-31-39-36:4023:4770 [0] NCCL INFO Channel 00/08 :    0   1   2   3
ec2-35-90-28-66: ip-172-31-39-36:4025:4773 [2] NCCL INFO Trees [0] 1/-1/-1->2->3|3->2->1/-1/-1 [1] 3/-1/-1->2->1|1->2->3/-1/-1 [2] 1/-1/-1->2->3|3->2->1/-1/-1 [3] 3/-1/-1->2->1|1->2->3/-1/-1 [4] 1/-1/-1->2->3|3->2->1/-1/-1 [5] 3/-1/-1->2->1|1->2->3/-1/-1 [6] 1/-1/-1->2->3|3->2->1/-1/-1 [7] 3/-1/-1->2->1|1->2->3/-1/-1
ec2-35-90-28-66: ip-172-31-39-36:4023:4770 [0] NCCL INFO Channel 01/08 :    0   3   2   1
ec2-35-90-28-66: ip-172-31-39-36:4023:4770 [0] NCCL INFO Channel 02/08 :    0   3   1   2
ec2-35-90-28-66: ip-172-31-39-36:4024:4771 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64
ec2-35-90-28-66: ip-172-31-39-36:4023:4770 [0] NCCL INFO Channel 03/08 :    0   2   1   3
ec2-35-90-28-66: ip-172-31-39-36:4026:4772 [3] NCCL INFO Trees [0] 2/-1/-1->3->0|0->3->2/-1/-1 [1] 0/-1/-1->3->2|2->3->0/-1/-1 [2] 2/-1/-1->3->0|0->3->2/-1/-1 [3] 0/-1/-1->3->2|2->3->0/-1/-1 [4] 2/-1/-1->3->0|0->3->2/-1/-1 [5] 0/-1/-1->3->2|2->3->0/-1/-1 [6] 2/-1/-1->3->0|0->3->2/-1/-1 [7] 0/-1/-1->3->2|2->3->0/-1/-1
ec2-35-90-28-66: ip-172-31-39-36:4023:4770 [0] NCCL INFO Channel 04/08 :    0   1   2   3
ec2-35-90-28-66: ip-172-31-39-36:4023:4770 [0] NCCL INFO Channel 05/08 :    0   3   2   1
ec2-35-90-28-66: ip-172-31-39-36:4024:4771 [1] NCCL INFO Trees [0] -1/-1/-1->1->2|2->1->-1/-1/-1 [1] 2/-1/-1->1->-1|-1->1->2/-1/-1 [2] -1/-1/-1->1->2|2->1->-1/-1/-1 [3] 2/-1/-1->1->-1|-1->1->2/-1/-1 [4] -1/-1/-1->1->2|2->1->-1/-1/-1 [5] 2/-1/-1->1->-1|-1->1->2/-1/-1 [6] -1/-1/-1->1->2|2->1->-1/-1/-1 [7] 2/-1/-1->1->-1|-1->1->2/-1/-1
ec2-35-90-28-66: ip-172-31-39-36:4023:4770 [0] NCCL INFO Channel 06/08 :    0   3   1   2
ec2-35-90-28-66: ip-172-31-39-36:4023:4770 [0] NCCL INFO Channel 07/08 :    0   2   1   3
ec2-35-90-28-66: ip-172-31-39-36:4023:4770 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64
ec2-35-90-28-66: ip-172-31-39-36:4023:4770 [0] NCCL INFO Trees [0] 3/-1/-1->0->-1|-1->0->3/-1/-1 [1] -1/-1/-1->0->3|3->0->-1/-1/-1 [2] 3/-1/-1->0->-1|-1->0->3/-1/-1 [3] -1/-1/-1->0->3|3->0->-1/-1/-1 [4] 3/-1/-1->0->-1|-1->0->3/-1/-1 [5] -1/-1/-1->0->3|3->0->-1/-1/-1 [6] 3/-1/-1->0->-1|-1->0->3/-1/-1 [7] -1/-1/-1->0->3|3->0->-1/-1/-1
ec2-35-90-28-66: ip-172-31-39-36:4025:4773 [2] NCCL INFO Channel 00 : 2[1d0] -> 3[1e0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4024:4771 [1] NCCL INFO Channel 00 : 1[1c0] -> 2[1d0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4026:4772 [3] NCCL INFO Channel 00 : 3[1e0] -> 0[1b0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4023:4770 [0] NCCL INFO Channel 00 : 0[1b0] -> 1[1c0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4023:4770 [0] NCCL INFO Channel 00 : 0[1b0] -> 3[1e0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4025:4773 [2] NCCL INFO Channel 00 : 2[1d0] -> 1[1c0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4026:4772 [3] NCCL INFO Channel 00 : 3[1e0] -> 2[1d0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4023:4770 [0] NCCL INFO Channel 01 : 0[1b0] -> 3[1e0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4024:4771 [1] NCCL INFO Channel 01 : 1[1c0] -> 0[1b0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4025:4773 [2] NCCL INFO Channel 01 : 2[1d0] -> 1[1c0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4026:4772 [3] NCCL INFO Channel 01 : 3[1e0] -> 2[1d0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4024:4771 [1] NCCL INFO Channel 01 : 1[1c0] -> 2[1d0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4025:4773 [2] NCCL INFO Channel 01 : 2[1d0] -> 3[1e0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4026:4772 [3] NCCL INFO Channel 01 : 3[1e0] -> 0[1b0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4024:4771 [1] NCCL INFO Channel 02 : 1[1c0] -> 2[1d0] via P2P/IPC
ec2-34-219-204-184: ninja: no work to do.
ec2-34-219-204-184: Loading extension module utils...
ec2-35-90-28-66: ip-172-31-39-36:4023:4770 [0] NCCL INFO Channel 02 : 0[1b0] -> 3[1e0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4025:4773 [2] NCCL INFO Channel 02 : 2[1d0] -> 0[1b0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4026:4772 [3] NCCL INFO Channel 02 : 3[1e0] -> 1[1c0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4025:4773 [2] NCCL INFO Channel 02 : 2[1d0] -> 3[1e0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4026:4772 [3] NCCL INFO Channel 02 : 3[1e0] -> 0[1b0] via P2P/IPC
ec2-34-219-204-184: Time to load utils op: 0.2509884834289551 seconds
ec2-35-90-28-66: ip-172-31-39-36:4025:4773 [2] NCCL INFO Channel 02 : 2[1d0] -> 1[1c0] via P2P/IPC
ec2-34-219-204-184: NCCL version 2.7.8+cuda11.0
ec2-35-90-28-66: ip-172-31-39-36:4026:4772 [3] NCCL INFO Channel 02 : 3[1e0] -> 2[1d0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4023:4770 [0] NCCL INFO Channel 03 : 0[1b0] -> 2[1d0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4024:4771 [1] NCCL INFO Channel 03 : 1[1c0] -> 3[1e0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4025:4773 [2] NCCL INFO Channel 03 : 2[1d0] -> 1[1c0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4026:4772 [3] NCCL INFO Channel 03 : 3[1e0] -> 0[1b0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4024:4771 [1] NCCL INFO Channel 03 : 1[1c0] -> 2[1d0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4023:4770 [0] NCCL INFO Channel 03 : 0[1b0] -> 3[1e0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4026:4772 [3] NCCL INFO Channel 03 : 3[1e0] -> 2[1d0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4023:4770 [0] NCCL INFO Channel 04 : 0[1b0] -> 1[1c0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4025:4773 [2] NCCL INFO Channel 03 : 2[1d0] -> 3[1e0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4024:4771 [1] NCCL INFO Channel 04 : 1[1c0] -> 2[1d0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4026:4772 [3] NCCL INFO Channel 04 : 3[1e0] -> 0[1b0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4025:4773 [2] NCCL INFO Channel 04 : 2[1d0] -> 3[1e0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4023:4770 [0] NCCL INFO Channel 04 : 0[1b0] -> 3[1e0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4026:4772 [3] NCCL INFO Channel 04 : 3[1e0] -> 2[1d0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4025:4773 [2] NCCL INFO Channel 04 : 2[1d0] -> 1[1c0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4023:4770 [0] NCCL INFO Channel 05 : 0[1b0] -> 3[1e0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4024:4771 [1] NCCL INFO Channel 05 : 1[1c0] -> 0[1b0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4026:4772 [3] NCCL INFO Channel 05 : 3[1e0] -> 2[1d0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4025:4773 [2] NCCL INFO Channel 05 : 2[1d0] -> 1[1c0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4024:4771 [1] NCCL INFO Channel 05 : 1[1c0] -> 2[1d0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4026:4772 [3] NCCL INFO Channel 05 : 3[1e0] -> 0[1b0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4025:4773 [2] NCCL INFO Channel 05 : 2[1d0] -> 3[1e0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4024:4771 [1] NCCL INFO Channel 06 : 1[1c0] -> 2[1d0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4023:4770 [0] NCCL INFO Channel 06 : 0[1b0] -> 3[1e0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4026:4772 [3] NCCL INFO Channel 06 : 3[1e0] -> 1[1c0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4025:4773 [2] NCCL INFO Channel 06 : 2[1d0] -> 0[1b0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4025:4773 [2] NCCL INFO Channel 06 : 2[1d0] -> 3[1e0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4026:4772 [3] NCCL INFO Channel 06 : 3[1e0] -> 0[1b0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4025:4773 [2] NCCL INFO Channel 06 : 2[1d0] -> 1[1c0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4026:4772 [3] NCCL INFO Channel 06 : 3[1e0] -> 2[1d0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4023:4770 [0] NCCL INFO Channel 07 : 0[1b0] -> 2[1d0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4024:4771 [1] NCCL INFO Channel 07 : 1[1c0] -> 3[1e0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4026:4772 [3] NCCL INFO Channel 07 : 3[1e0] -> 0[1b0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4025:4773 [2] NCCL INFO Channel 07 : 2[1d0] -> 1[1c0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4023:4770 [0] NCCL INFO Channel 07 : 0[1b0] -> 3[1e0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4024:4771 [1] NCCL INFO Channel 07 : 1[1c0] -> 2[1d0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4023:4770 [0] NCCL INFO 8 coll channels, 8 p2p channels, 2 p2p channels per peer
ec2-35-90-28-66: ip-172-31-39-36:4026:4772 [3] NCCL INFO Channel 07 : 3[1e0] -> 2[1d0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4023:4770 [0] NCCL INFO comm 0x7f8c20001060 rank 0 nranks 4 cudaDev 0 busId 1b0 - Init COMPLETE
ec2-35-90-28-66: ip-172-31-39-36:4023:4023 [0] NCCL INFO Launch mode Parallel
ec2-35-90-28-66: ip-172-31-39-36:4024:4771 [1] NCCL INFO 8 coll channels, 8 p2p channels, 2 p2p channels per peer
ec2-35-90-28-66: ip-172-31-39-36:4025:4773 [2] NCCL INFO Channel 07 : 2[1d0] -> 3[1e0] via P2P/IPC
ec2-35-90-28-66: ip-172-31-39-36:4024:4771 [1] NCCL INFO comm 0x7ff868001060 rank 1 nranks 4 cudaDev 1 busId 1c0 - Init COMPLETE
ec2-35-90-28-66: [2022-10-08 14:54:33,096] [INFO] [engine.py:596:_configure_optimizer] Removing param_group that has no 'params'in the client Optimizer
ec2-35-90-28-66: ip-172-31-39-36:4026:4772 [3] NCCL INFO 8 coll channels, 8 p2p channels, 2 p2p channels per peer
ec2-35-90-28-66: ip-172-31-39-36:4026:4772 [3] NCCL INFO comm 0x7f9850001060 rank 3 nranks 4 cudaDev 3 busId 1e0 - Init COMPLETE
ec2-35-90-28-66: ip-172-31-39-36:4025:4773 [2] NCCL INFO 8 coll channels, 8 p2p channels, 2 p2p channels per peer
ec2-35-90-28-66: ip-172-31-39-36:4025:4773 [2] NCCL INFO comm 0x7fc920001060 rank 2 nranks 4 cudaDev 2 busId 1d0 - Init COMPLETE
ec2-35-90-28-66: [2022-10-08 14:54:33,098] [INFO] [engine.py:596:_configure_optimizer] Removing param_group that has no 'params'in the client Optimizer
ec2-34-219-204-184: Loading extension module utils...
ec2-34-219-204-184: Loading extension module utils...
ec2-34-219-204-184: Loading extension module utils...
ec2-35-90-28-66: [2022-10-08 14:54:33,099] [INFO] [engine.py:596:_configure_optimizer] Removing param_group that has no 'params'in the client Optimizer
ec2-35-90-28-66: [2022-10-08 14:54:33,099] [INFO] [engine.py:596:_configure_optimizer] Removing param_group that has no 'params'in the client Optimizer
ec2-34-219-204-184: Time to load utils op: 0.3049123287200928 seconds
ec2-34-219-204-184: Time to load utils op: 0.30495262145996094 seconds
ec2-34-219-204-184: Time to load utils op: 0.3041231632232666 seconds
ec2-34-219-204-184: [2022-10-08 14:54:33,102] [INFO] [engine.py:72:__init__] CONFIG: micro_batches=16 micro_batch_size=1
ec2-34-219-204-184: NCCL version 2.7.8+cuda11.0
ec2-34-219-204-184: NCCL version 2.7.8+cuda11.0
ec2-35-90-28-66: Using /home/ubuntu/.cache/torch_extensions as PyTorch extensions root...Using /home/ubuntu/.cache/torch_extensions as PyTorch extensions root...Using /home/ubuntu/.cache/torch_extensions as PyTorch extensions root...Using /home/ubuntu/.cache/torch_extensions as PyTorch extensions root...
ec2-35-90-28-66: 
ec2-35-90-28-66: 
ec2-35-90-28-66: 
ec2-35-90-28-66: Emitting ninja build file /home/ubuntu/.cache/torch_extensions/utils/build.ninja...
ec2-35-90-28-66: Building extension module utils...
ec2-35-90-28-66: Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ec2-35-90-28-66: ninja: no work to do.
ec2-35-90-28-66: Loading extension module utils...
ec2-35-90-28-66: Loading extension module utils...Loading extension module utils...
ec2-35-90-28-66: 
ec2-35-90-28-66: Loading extension module utils...
ec2-35-90-28-66: Time to load utils op: 1.2239799499511719 secondsTime to load utils op: 1.2239975929260254 secondsTime to load utils op: 1.2239835262298584 seconds
ec2-35-90-28-66: 
ec2-35-90-28-66: 
ec2-35-90-28-66: Time to load utils op: 1.2240397930145264 seconds
ec2-35-90-65-226: ip-172-31-38-78:3919:4949 [3] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64
ec2-35-90-65-226: ip-172-31-38-78:3919:4949 [3] NCCL INFO Trees [0] 1/3/-1->2->0|0->2->1/3/-1 [1] -1/-1/-1->2->3|3->2->-1/-1/-1
ec2-35-90-28-66: ip-172-31-39-36:4026:4810 [3] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64
ec2-35-90-28-66: ip-172-31-39-36:4023:4811 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64
ec2-35-90-28-66: ip-172-31-39-36:4026:4810 [3] NCCL INFO Trees [0] -1/-1/-1->3->2|2->3->-1/-1/-1 [1] 2/0/-1->3->1|1->3->2/0/-1
ec2-35-90-28-66: ip-172-31-39-36:4023:4811 [0] NCCL INFO Trees [0] -1/-1/-1->3->2|2->3->-1/-1/-1 [1] 2/0/-1->3->1|1->3->2/0/-1
ec2-54-244-82-8: ip-172-31-44-10:14967:17016 [3] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64
ec2-34-219-204-184: ip-172-31-41-243:10717:12759 [3] NCCL INFO Channel 00/02 :    0   1   2   3
ec2-34-219-204-184: ip-172-31-41-243:10717:12759 [3] NCCL INFO Channel 01/02 :    0   1   2   3
ec2-54-244-82-8: ip-172-31-44-10:14967:17016 [3] NCCL INFO Trees [0] -1/-1/-1->1->2|2->1->-1/-1/-1 [1] 3/-1/-1->1->-1|-1->1->3/-1/-1
ec2-34-219-204-184: ip-172-31-41-243:10714:12768 [0] NCCL INFO Channel 00/02 :    0   1   2   3
ec2-34-219-204-184: ip-172-31-41-243:10714:12768 [0] NCCL INFO Channel 01/02 :    0   1   2   3
ec2-34-219-204-184: ip-172-31-41-243:10717:12759 [3] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64
ec2-34-219-204-184: ip-172-31-41-243:10717:12759 [3] NCCL INFO Trees [0] 2/-1/-1->0->-1|-1->0->2/-1/-1 [1] -1/-1/-1->0->3|3->0->-1/-1/-1
ec2-34-219-204-184: ip-172-31-41-243:10714:12768 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64
ec2-34-219-204-184: ip-172-31-41-243:10714:12768 [0] NCCL INFO Trees [0] 2/-1/-1->0->-1|-1->0->2/-1/-1 [1] -1/-1/-1->0->3|3->0->-1/-1/-1
ec2-54-244-82-8: ip-172-31-44-10:14964:17019 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64
ec2-54-244-82-8: ip-172-31-44-10:14964:17019 [0] NCCL INFO Trees [0] -1/-1/-1->1->2|2->1->-1/-1/-1 [1] 3/-1/-1->1->-1|-1->1->3/-1/-1
ec2-35-90-65-226: ip-172-31-38-78:3916:4952 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64
ec2-35-90-65-226: ip-172-31-38-78:3916:4952 [0] NCCL INFO Trees [0] 1/3/-1->2->0|0->2->1/3/-1 [1] -1/-1/-1->2->3|3->2->-1/-1/-1
ec2-35-90-65-226: ip-172-31-38-78:3918:4951 [2] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64
ec2-35-90-65-226: ip-172-31-38-78:3918:4951 [2] NCCL INFO Trees [0] 1/3/-1->2->0|0->2->1/3/-1 [1] -1/-1/-1->2->3|3->2->-1/-1/-1
ec2-35-90-28-66: ip-172-31-39-36:4025:4812 [2] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64
ec2-35-90-28-66: ip-172-31-39-36:4025:4812 [2] NCCL INFO Trees [0] -1/-1/-1->3->2|2->3->-1/-1/-1 [1] 2/0/-1->3->1|1->3->2/0/-1
ec2-35-90-65-226: ip-172-31-38-78:3917:4950 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64
ec2-35-90-65-226: ip-172-31-38-78:3917:4950 [1] NCCL INFO Trees [0] 1/3/-1->2->0|0->2->1/3/-1 [1] -1/-1/-1->2->3|3->2->-1/-1/-1
ec2-34-219-204-184: ip-172-31-41-243:10716:12766 [2] NCCL INFO Channel 00/02 :    0   1   2   3
ec2-34-219-204-184: ip-172-31-41-243:10716:12766 [2] NCCL INFO Channel 01/02 :    0   1   2   3
ec2-34-219-204-184: ip-172-31-41-243:10716:12766 [2] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64
ec2-34-219-204-184: ip-172-31-41-243:10716:12766 [2] NCCL INFO Trees [0] 2/-1/-1->0->-1|-1->0->2/-1/-1 [1] -1/-1/-1->0->3|3->0->-1/-1/-1
ec2-54-244-82-8: ip-172-31-44-10:14966:17018 [2] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64
ec2-54-244-82-8: ip-172-31-44-10:14966:17018 [2] NCCL INFO Trees [0] -1/-1/-1->1->2|2->1->-1/-1/-1 [1] 3/-1/-1->1->-1|-1->1->3/-1/-1
ec2-35-90-28-66: ip-172-31-39-36:4024:4809 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64
ec2-35-90-28-66: ip-172-31-39-36:4024:4809 [1] NCCL INFO Trees [0] -1/-1/-1->3->2|2->3->-1/-1/-1 [1] 2/0/-1->3->1|1->3->2/0/-1
ec2-34-219-204-184: ip-172-31-41-243:10715:12765 [1] NCCL INFO Channel 00/02 :    0   1   2   3
ec2-34-219-204-184: ip-172-31-41-243:10715:12765 [1] NCCL INFO Channel 01/02 :    0   1   2   3
ec2-54-244-82-8: ip-172-31-44-10:14965:17017 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64
ec2-54-244-82-8: ip-172-31-44-10:14965:17017 [1] NCCL INFO Trees [0] -1/-1/-1->1->2|2->1->-1/-1/-1 [1] 3/-1/-1->1->-1|-1->1->3/-1/-1
ec2-34-219-204-184: ip-172-31-41-243:10715:12765 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 8/8/64
ec2-34-219-204-184: ip-172-31-41-243:10715:12765 [1] NCCL INFO Trees [0] 2/-1/-1->0->-1|-1->0->2/-1/-1 [1] -1/-1/-1->0->3|3->0->-1/-1/-1
ec2-35-90-65-226: ip-172-31-38-78:3919:4949 [3] NCCL INFO Channel 00 : 1[1e0] -> 2[1e0] [receive] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3919:4949 [3] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-54-244-82-8: ip-172-31-44-10:14967:17016 [3] NCCL INFO Channel 00 : 0[1e0] -> 1[1e0] [receive] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14967:17016 [3] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-54-244-82-8: ip-172-31-44-10:14964:17019 [0] NCCL INFO Channel 00 : 0[1b0] -> 1[1b0] [receive] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14964:17019 [0] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-65-226: ip-172-31-38-78:3916:4952 [0] NCCL INFO Channel 00 : 1[1b0] -> 2[1b0] [receive] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3916:4952 [0] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-65-226: ip-172-31-38-78:3918:4951 [2] NCCL INFO Channel 00 : 1[1d0] -> 2[1d0] [receive] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3918:4951 [2] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-34-219-204-184: ip-172-31-41-243:10717:12759 [3] NCCL INFO Channel 00 : 3[1e0] -> 0[1e0] [receive] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10714:12768 [0] NCCL INFO Channel 00 : 3[1b0] -> 0[1b0] [receive] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10717:12759 [3] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-34-219-204-184: ip-172-31-41-243:10714:12768 [0] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-54-244-82-8: ip-172-31-44-10:14966:17018 [2] NCCL INFO Channel 00 : 0[1d0] -> 1[1d0] [receive] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14966:17018 [2] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-28-66: ip-172-31-39-36:4025:4812 [2] NCCL INFO Channel 00 : 2[1d0] -> 3[1d0] [receive] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4024:4809 [1] NCCL INFO Channel 00 : 2[1c0] -> 3[1c0] [receive] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4025:4812 [2] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-28-66: ip-172-31-39-36:4024:4809 [1] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-54-244-82-8: ip-172-31-44-10:14965:17017 [1] NCCL INFO Channel 00 : 0[1c0] -> 1[1c0] [receive] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14965:17017 [1] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-34-219-204-184: ip-172-31-41-243:10716:12766 [2] NCCL INFO Channel 00 : 3[1d0] -> 0[1d0] [receive] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10715:12765 [1] NCCL INFO Channel 00 : 3[1c0] -> 0[1c0] [receive] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10716:12766 [2] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-34-219-204-184: ip-172-31-41-243:10715:12765 [1] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-65-226: ip-172-31-38-78:3917:4950 [1] NCCL INFO Channel 00 : 1[1c0] -> 2[1c0] [receive] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3917:4950 [1] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-28-66: ip-172-31-39-36:4026:4810 [3] NCCL INFO Channel 00 : 2[1e0] -> 3[1e0] [receive] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4023:4811 [0] NCCL INFO Channel 00 : 2[1b0] -> 3[1b0] [receive] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4026:4810 [3] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-28-66: ip-172-31-39-36:4023:4811 [0] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-65-226: ip-172-31-38-78:3919:4949 [3] NCCL INFO Channel 00 : 2[1e0] -> 3[1e0] [send] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14967:17016 [3] NCCL INFO Channel 00 : 1[1e0] -> 2[1e0] [send] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14964:17019 [0] NCCL INFO Channel 00 : 1[1b0] -> 2[1b0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3918:4951 [2] NCCL INFO Channel 00 : 2[1d0] -> 3[1d0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3916:4952 [0] NCCL INFO Channel 00 : 2[1b0] -> 3[1b0] [send] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14966:17018 [2] NCCL INFO Channel 00 : 1[1d0] -> 2[1d0] [send] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10717:12759 [3] NCCL INFO Channel 00 : 0[1e0] -> 1[1e0] [send] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10714:12768 [0] NCCL INFO Channel 00 : 0[1b0] -> 1[1b0] [send] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14965:17017 [1] NCCL INFO Channel 00 : 1[1c0] -> 2[1c0] [send] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4025:4812 [2] NCCL INFO Channel 00 : 3[1d0] -> 0[1d0] [send] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4024:4809 [1] NCCL INFO Channel 00 : 3[1c0] -> 0[1c0] [send] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10716:12766 [2] NCCL INFO Channel 00 : 0[1d0] -> 1[1d0] [send] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10715:12765 [1] NCCL INFO Channel 00 : 0[1c0] -> 1[1c0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3917:4950 [1] NCCL INFO Channel 00 : 2[1c0] -> 3[1c0] [send] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4023:4811 [0] NCCL INFO Channel 00 : 3[1b0] -> 0[1b0] [send] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4026:4810 [3] NCCL INFO Channel 00 : 3[1e0] -> 0[1e0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3919:4949 [3] NCCL INFO Channel 00 : 3[1e0] -> 2[1e0] [receive] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3919:4949 [3] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-54-244-82-8: ip-172-31-44-10:14967:17016 [3] NCCL INFO Channel 00 : 2[1e0] -> 1[1e0] [receive] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14967:17016 [3] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-54-244-82-8: ip-172-31-44-10:14965:17017 [1] NCCL INFO Channel 00 : 2[1c0] -> 1[1c0] [receive] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14965:17017 [1] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-65-226: ip-172-31-38-78:3919:4949 [3] NCCL INFO Channel 00 : 2[1e0] -> 0[1e0] [send] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10714:12768 [0] NCCL INFO Channel 00 : 2[1b0] -> 0[1b0] [receive] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10714:12768 [0] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-34-219-204-184: ip-172-31-41-243:10717:12759 [3] NCCL INFO Channel 00 : 2[1e0] -> 0[1e0] [receive] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10717:12759 [3] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-28-66: ip-172-31-39-36:4023:4811 [0] NCCL INFO Channel 00 : 3[1b0] -> 2[1b0] [send] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4026:4810 [3] NCCL INFO Channel 00 : 3[1e0] -> 2[1e0] [send] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14966:17018 [2] NCCL INFO Channel 00 : 2[1d0] -> 1[1d0] [receive] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14966:17018 [2] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-65-226: ip-172-31-38-78:3916:4952 [0] NCCL INFO Channel 00 : 3[1b0] -> 2[1b0] [receive] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14964:17019 [0] NCCL INFO Channel 00 : 2[1b0] -> 1[1b0] [receive] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14964:17019 [0] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-65-226: ip-172-31-38-78:3916:4952 [0] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-34-219-204-184: ip-172-31-41-243:10716:12766 [2] NCCL INFO Channel 00 : 2[1d0] -> 0[1d0] [receive] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10716:12766 [2] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-34-219-204-184: ip-172-31-41-243:10715:12765 [1] NCCL INFO Channel 00 : 2[1c0] -> 0[1c0] [receive] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10715:12765 [1] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-65-226: ip-172-31-38-78:3916:4952 [0] NCCL INFO Channel 00 : 2[1b0] -> 0[1b0] [send] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4026:4810 [3] NCCL INFO Channel 01 : 2[1e0] -> 3[1e0] [receive] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4026:4810 [3] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-28-66: ip-172-31-39-36:4023:4811 [0] NCCL INFO Channel 01 : 2[1b0] -> 3[1b0] [receive] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4023:4811 [0] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-65-226: ip-172-31-38-78:3918:4951 [2] NCCL INFO Channel 00 : 3[1d0] -> 2[1d0] [receive] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3918:4951 [2] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-65-226: ip-172-31-38-78:3916:4952 [0] NCCL INFO Channel 00 : 0[1b0] -> 2[1b0] [receive] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10714:12768 [0] NCCL INFO Channel 00 : 0[1b0] -> 2[1b0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3916:4952 [0] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-28-66: ip-172-31-39-36:4025:4812 [2] NCCL INFO Channel 00 : 3[1d0] -> 2[1d0] [send] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4024:4809 [1] NCCL INFO Channel 00 : 3[1c0] -> 2[1c0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3917:4950 [1] NCCL INFO Channel 00 : 3[1c0] -> 2[1c0] [receive] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3917:4950 [1] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-28-66: ip-172-31-39-36:4026:4810 [3] NCCL INFO Channel 01 : 3[1e0] -> 0[1e0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3918:4951 [2] NCCL INFO Channel 00 : 2[1d0] -> 0[1d0] [send] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4023:4811 [0] NCCL INFO Channel 01 : 3[1b0] -> 0[1b0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3916:4952 [0] NCCL INFO Channel 00 : 2[1b0] -> 1[1b0] [send] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10714:12768 [0] NCCL INFO Channel 01 : 3[1b0] -> 0[1b0] [receive] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10714:12768 [0] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-28-66: ip-172-31-39-36:4025:4812 [2] NCCL INFO Channel 01 : 2[1d0] -> 3[1d0] [receive] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4025:4812 [2] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-65-226: ip-172-31-38-78:3917:4950 [1] NCCL INFO Channel 00 : 2[1c0] -> 0[1c0] [send] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4024:4809 [1] NCCL INFO Channel 01 : 2[1c0] -> 3[1c0] [receive] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4024:4809 [1] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-65-226: ip-172-31-38-78:3918:4951 [2] NCCL INFO Channel 00 : 0[1d0] -> 2[1d0] [receive] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14964:17019 [0] NCCL INFO Channel 01 : 0[1b0] -> 1[1b0] [receive] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14964:17019 [0] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-28-66: ip-172-31-39-36:4025:4812 [2] NCCL INFO Channel 01 : 3[1d0] -> 0[1d0] [send] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10716:12766 [2] NCCL INFO Channel 00 : 0[1d0] -> 2[1d0] [send] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10714:12768 [0] NCCL INFO Channel 01 : 0[1b0] -> 1[1b0] [send] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4024:4809 [1] NCCL INFO Channel 01 : 3[1c0] -> 0[1c0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3919:4949 [3] NCCL INFO Channel 00 : 0[1e0] -> 2[1e0] [receive] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3919:4949 [3] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-54-244-82-8: ip-172-31-44-10:14964:17019 [0] NCCL INFO Channel 01 : 1[1b0] -> 2[1b0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3917:4950 [1] NCCL INFO Channel 00 : 0[1c0] -> 2[1c0] [receive] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3917:4950 [1] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-34-219-204-184: ip-172-31-41-243:10714:12768 [0] NCCL INFO Channel 01 : 0[1b0] -> 3[1b0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3919:4949 [3] NCCL INFO Channel 00 : 2[1e0] -> 1[1e0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3917:4950 [1] NCCL INFO Channel 00 : 2[1c0] -> 1[1c0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3918:4951 [2] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-34-219-204-184: ip-172-31-41-243:10717:12759 [3] NCCL INFO Channel 00 : 0[1e0] -> 2[1e0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3918:4951 [2] NCCL INFO Channel 00 : 2[1d0] -> 1[1d0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3916:4952 [0] NCCL INFO Channel 01 : 1[1b0] -> 2[1b0] [receive] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3916:4952 [0] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-34-219-204-184: ip-172-31-41-243:10716:12766 [2] NCCL INFO Channel 01 : 3[1d0] -> 0[1d0] [receive] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3916:4952 [0] NCCL INFO Channel 01 : 2[1b0] -> 3[1b0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3919:4949 [3] NCCL INFO Channel 01 : 1[1e0] -> 2[1e0] [receive] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3919:4949 [3] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-34-219-204-184: ip-172-31-41-243:10717:12759 [3] NCCL INFO Channel 01 : 3[1e0] -> 0[1e0] [receive] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10717:12759 [3] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-65-226: ip-172-31-38-78:3918:4951 [2] NCCL INFO Channel 01 : 1[1d0] -> 2[1d0] [receive] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3918:4951 [2] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-54-244-82-8: ip-172-31-44-10:14966:17018 [2] NCCL INFO Channel 01 : 0[1d0] -> 1[1d0] [receive] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14966:17018 [2] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-54-244-82-8: ip-172-31-44-10:14964:17019 [0] NCCL INFO Channel 01 : 3[1b0] -> 1[1b0] [receive] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14964:17019 [0] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-34-219-204-184: ip-172-31-41-243:10715:12765 [1] NCCL INFO Channel 00 : 0[1c0] -> 2[1c0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3919:4949 [3] NCCL INFO Channel 01 : 2[1e0] -> 3[1e0] [send] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10717:12759 [3] NCCL INFO Channel 01 : 0[1e0] -> 1[1e0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3918:4951 [2] NCCL INFO Channel 01 : 2[1d0] -> 3[1d0] [send] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14966:17018 [2] NCCL INFO Channel 01 : 1[1d0] -> 2[1d0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3916:4952 [0] NCCL INFO Channel 01 : 3[1b0] -> 2[1b0] [receive] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3916:4952 [0] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-28-66: ip-172-31-39-36:4023:4811 [0] NCCL INFO Channel 01 : 0[1b0] -> 3[1b0] [receive] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4023:4811 [0] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-54-244-82-8: ip-172-31-44-10:14967:17016 [3] NCCL INFO Channel 01 : 0[1e0] -> 1[1e0] [receive] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14967:17016 [3] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-34-219-204-184: ip-172-31-41-243:10715:12765 [1] NCCL INFO Channel 01 : 3[1c0] -> 0[1c0] [receive] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10715:12765 [1] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-65-226: ip-172-31-38-78:3917:4950 [1] NCCL INFO Channel 01 : 1[1c0] -> 2[1c0] [receive] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3917:4950 [1] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-54-244-82-8: ip-172-31-44-10:14965:17017 [1] NCCL INFO Channel 01 : 0[1c0] -> 1[1c0] [receive] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14965:17017 [1] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-65-226: ip-172-31-38-78:3918:4951 [2] NCCL INFO Channel 01 : 3[1d0] -> 2[1d0] [receive] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3918:4951 [2] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-54-244-82-8: ip-172-31-44-10:14967:17016 [3] NCCL INFO Channel 01 : 1[1e0] -> 2[1e0] [send] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4026:4810 [3] NCCL INFO Channel 01 : 0[1e0] -> 3[1e0] [receive] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4026:4810 [3] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-34-219-204-184: ip-172-31-41-243:10715:12765 [1] NCCL INFO Channel 01 : 0[1c0] -> 1[1c0] [send] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4023:4811 [0] NCCL INFO Channel 01 : 3[1b0] -> 1[1b0] [send] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10717:12759 [3] NCCL INFO Channel 01 : 0[1e0] -> 3[1e0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3917:4950 [1] NCCL INFO Channel 01 : 2[1c0] -> 3[1c0] [send] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14965:17017 [1] NCCL INFO Channel 01 : 1[1c0] -> 2[1c0] [send] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10717:12759 [3] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-34-219-204-184: ip-172-31-41-243:10717:12759 [3] NCCL INFO comm 0x7f6f9c001060 rank 0 nranks 4 cudaDev 3 busId 1e0 - Init COMPLETE
ec2-34-219-204-184: ip-172-31-41-243:10717:10717 [3] NCCL INFO Launch mode Parallel
ec2-35-90-65-226: ip-172-31-38-78:3919:4949 [3] NCCL INFO Channel 01 : 3[1e0] -> 2[1e0] [receive] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3919:4949 [3] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-28-66: ip-172-31-39-36:4026:4810 [3] NCCL INFO Channel 01 : 3[1e0] -> 1[1e0] [send] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14967:17016 [3] NCCL INFO Channel 01 : 3[1e0] -> 1[1e0] [receive] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14967:17016 [3] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-34-219-204-184: ip-172-31-41-243:10715:12765 [1] NCCL INFO Channel 01 : 0[1c0] -> 3[1c0] [send] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10716:12766 [2] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-28-66: ip-172-31-39-36:4024:4809 [1] NCCL INFO Channel 01 : 0[1c0] -> 3[1c0] [receive] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14965:17017 [1] NCCL INFO Channel 01 : 3[1c0] -> 1[1c0] [receive] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4024:4809 [1] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-54-244-82-8: ip-172-31-44-10:14965:17017 [1] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-34-219-204-184: ip-172-31-41-243:10715:12765 [1] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-34-219-204-184: ip-172-31-41-243:10715:12765 [1] NCCL INFO comm 0x7fc114001060 rank 0 nranks 4 cudaDev 1 busId 1c0 - Init COMPLETE
ec2-34-219-204-184: ip-172-31-41-243:10715:10715 [1] NCCL INFO Launch mode Parallel
ec2-54-244-82-8: ip-172-31-44-10:14967:17016 [3] NCCL INFO Channel 01 : 1[1e0] -> 3[1e0] [send] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4026:4810 [3] NCCL INFO Channel 01 : 1[1e0] -> 3[1e0] [receive] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4026:4810 [3] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-28-66: ip-172-31-39-36:4024:4809 [1] NCCL INFO Channel 01 : 3[1c0] -> 1[1c0] [send] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10716:12766 [2] NCCL INFO Channel 01 : 0[1d0] -> 1[1d0] [send] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14967:17016 [3] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-54-244-82-8: ip-172-31-44-10:14967:17016 [3] NCCL INFO comm 0x7fcf94001060 rank 1 nranks 4 cudaDev 3 busId 1e0 - Init COMPLETE
ec2-35-90-28-66: ip-172-31-39-36:4026:4810 [3] NCCL INFO Channel 01 : 3[1e0] -> 2[1e0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3919:4949 [3] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-35-90-28-66: ip-172-31-39-36:4026:4810 [3] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-35-90-65-226: ip-172-31-38-78:3919:4949 [3] NCCL INFO comm 0x7f5234006330 rank 2 nranks 4 cudaDev 3 busId 1e0 - Init COMPLETE
ec2-35-90-28-66: ip-172-31-39-36:4026:4810 [3] NCCL INFO comm 0x7f9850006330 rank 3 nranks 4 cudaDev 3 busId 1e0 - Init COMPLETE
ec2-54-244-82-8: ip-172-31-44-10:14965:17017 [1] NCCL INFO Channel 01 : 1[1c0] -> 3[1c0] [send] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4024:4809 [1] NCCL INFO Channel 01 : 1[1c0] -> 3[1c0] [receive] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4024:4809 [1] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-34-219-204-184: ip-172-31-41-243:10714:12768 [0] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-54-244-82-8: ip-172-31-44-10:14965:17017 [1] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-54-244-82-8: ip-172-31-44-10:14965:17017 [1] NCCL INFO comm 0x7f234c001060 rank 1 nranks 4 cudaDev 1 busId 1c0 - Init COMPLETE
ec2-34-219-204-184: ip-172-31-41-243:10714:12768 [0] NCCL INFO comm 0x7f2458001060 rank 0 nranks 4 cudaDev 0 busId 1b0 - Init COMPLETE
ec2-34-219-204-184: ip-172-31-41-243:10714:10714 [0] NCCL INFO Launch mode Parallel
ec2-54-244-82-8: ip-172-31-44-10:14964:17019 [0] NCCL INFO Channel 01 : 1[1b0] -> 3[1b0] [send] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4024:4809 [1] NCCL INFO Channel 01 : 3[1c0] -> 2[1c0] [send] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4023:4811 [0] NCCL INFO Channel 01 : 1[1b0] -> 3[1b0] [receive] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4023:4811 [0] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-54-244-82-8: ip-172-31-44-10:14964:17019 [0] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-54-244-82-8: ip-172-31-44-10:14964:17019 [0] NCCL INFO comm 0x7f8fd4001060 rank 1 nranks 4 cudaDev 0 busId 1b0 - Init COMPLETE
ec2-35-90-28-66: ip-172-31-39-36:4023:4811 [0] NCCL INFO Channel 01 : 3[1b0] -> 2[1b0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3916:4952 [0] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-35-90-28-66: ip-172-31-39-36:4023:4811 [0] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-35-90-65-226: ip-172-31-38-78:3916:4952 [0] NCCL INFO comm 0x7f886c006330 rank 2 nranks 4 cudaDev 0 busId 1b0 - Init COMPLETE
ec2-35-90-28-66: ip-172-31-39-36:4023:4811 [0] NCCL INFO comm 0x7f8c20006330 rank 3 nranks 4 cudaDev 0 busId 1b0 - Init COMPLETE
ec2-34-219-204-184: [2022-10-08 14:54:34,641] [INFO] [engine.py:129:__init__] RANK=0 STAGE=0 LAYERS=12 [0, 12) STAGE_PARAMS=155972781 (155.973M) TOTAL_PARAMS=199490283 (199.490M) UNIQUE_PARAMS=199490283 (199.490M)
ec2-35-90-65-226: [2022-10-08 14:54:34,640] [INFO] [engine.py:129:__init__] RANK=8 STAGE=2 LAYERS=5 [44, 49) STAGE_PARAMS=40585 (0.041M) TOTAL_PARAMS=199490283 (199.490M) UNIQUE_PARAMS=199490283 (199.490M)
ec2-54-244-82-8: [2022-10-08 14:54:34,639] [INFO] [engine.py:129:__init__] RANK=4 STAGE=1 LAYERS=32 [12, 44) STAGE_PARAMS=43444398 (43.444M) TOTAL_PARAMS=199490283 (199.490M) UNIQUE_PARAMS=199490283 (199.490M)
ec2-35-90-28-66: [2022-10-08 14:54:34,639] [INFO] [engine.py:129:__init__] RANK=12 STAGE=3 LAYERS=7 [49, 56) STAGE_PARAMS=32519 (0.033M) TOTAL_PARAMS=199490283 (199.490M) UNIQUE_PARAMS=199490283 (199.490M)
ec2-54-244-82-8: ip-172-31-44-10:14966:17018 [2] NCCL INFO Channel 01 : 3[1d0] -> 1[1d0] [receive] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14966:17018 [2] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-65-226: ip-172-31-38-78:3917:4950 [1] NCCL INFO Channel 01 : 3[1c0] -> 2[1c0] [receive] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3917:4950 [1] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-34-219-204-184: ip-172-31-41-243:10716:12766 [2] NCCL INFO Channel 01 : 0[1d0] -> 3[1d0] [send] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4025:4812 [2] NCCL INFO Channel 01 : 0[1d0] -> 3[1d0] [receive] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4025:4812 [2] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-34-219-204-184: ip-172-31-41-243:10716:12766 [2] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-34-219-204-184: ip-172-31-41-243:10716:12766 [2] NCCL INFO comm 0x7f667c001060 rank 0 nranks 4 cudaDev 2 busId 1d0 - Init COMPLETE
ec2-34-219-204-184: ip-172-31-41-243:10716:10716 [2] NCCL INFO Launch mode Parallel
ec2-35-90-28-66: ip-172-31-39-36:4025:4812 [2] NCCL INFO Channel 01 : 3[1d0] -> 1[1d0] [send] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14966:17018 [2] NCCL INFO Channel 01 : 1[1d0] -> 3[1d0] [send] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4025:4812 [2] NCCL INFO Channel 01 : 1[1d0] -> 3[1d0] [receive] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4025:4812 [2] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-54-244-82-8: ip-172-31-44-10:14966:17018 [2] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-54-244-82-8: ip-172-31-44-10:14966:17018 [2] NCCL INFO comm 0x7f4abc001060 rank 1 nranks 4 cudaDev 2 busId 1d0 - Init COMPLETE
ec2-35-90-28-66: ip-172-31-39-36:4025:4812 [2] NCCL INFO Channel 01 : 3[1d0] -> 2[1d0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3918:4951 [2] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-35-90-28-66: ip-172-31-39-36:4025:4812 [2] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-35-90-65-226: ip-172-31-38-78:3918:4951 [2] NCCL INFO comm 0x7f61240060b0 rank 2 nranks 4 cudaDev 2 busId 1d0 - Init COMPLETE
ec2-35-90-28-66: ip-172-31-39-36:4025:4812 [2] NCCL INFO comm 0x7fc9200060b0 rank 3 nranks 4 cudaDev 2 busId 1d0 - Init COMPLETE
ec2-35-90-65-226: ip-172-31-38-78:3917:4950 [1] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-35-90-65-226: ip-172-31-38-78:3917:4950 [1] NCCL INFO comm 0x7f20540060b0 rank 2 nranks 4 cudaDev 1 busId 1c0 - Init COMPLETE
ec2-35-90-28-66: ip-172-31-39-36:4024:4809 [1] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-35-90-28-66: ip-172-31-39-36:4024:4809 [1] NCCL INFO comm 0x7ff868006330 rank 3 nranks 4 cudaDev 1 busId 1c0 - Init COMPLETE
ec2-35-90-65-226: NCCL version 2.7.8+cuda11.0
ec2-35-90-65-226: NCCL version 2.7.8+cuda11.0
ec2-35-90-65-226: NCCL version 2.7.8+cuda11.0
ec2-35-90-65-226: ip-172-31-38-78:3917:5014 [1] NCCL INFO Channel 00/02 :    0   1
ec2-35-90-65-226: ip-172-31-38-78:3917:5014 [1] NCCL INFO Channel 01/02 :    0   1
ec2-35-90-28-66: ip-172-31-39-36:4024:4844 [1] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64
ec2-35-90-28-66: ip-172-31-39-36:4024:4844 [1] NCCL INFO Trees [0] -1/-1/-1->1->0|0->1->-1/-1/-1 [1] 0/-1/-1->1->-1|-1->1->0/-1/-1
ec2-35-90-65-226: ip-172-31-38-78:3917:5014 [1] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64
ec2-35-90-65-226: ip-172-31-38-78:3917:5014 [1] NCCL INFO Trees [0] 1/-1/-1->0->-1|-1->0->1/-1/-1 [1] -1/-1/-1->0->1|1->0->-1/-1/-1
ec2-35-90-28-66: ip-172-31-39-36:4026:4845 [3] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64
ec2-35-90-28-66: ip-172-31-39-36:4026:4845 [3] NCCL INFO Trees [0] -1/-1/-1->1->0|0->1->-1/-1/-1 [1] 0/-1/-1->1->-1|-1->1->0/-1/-1
ec2-35-90-28-66: ip-172-31-39-36:4023:4843 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64
ec2-35-90-28-66: ip-172-31-39-36:4023:4843 [0] NCCL INFO Trees [0] -1/-1/-1->1->0|0->1->-1/-1/-1 [1] 0/-1/-1->1->-1|-1->1->0/-1/-1
ec2-35-90-65-226: ip-172-31-38-78:3919:5015 [3] NCCL INFO Channel 00/02 :    0   1
ec2-35-90-65-226: ip-172-31-38-78:3919:5015 [3] NCCL INFO Channel 01/02 :    0   1
ec2-35-90-65-226: ip-172-31-38-78:3916:5011 [0] NCCL INFO Channel 00/02 :    0   1
ec2-35-90-65-226: ip-172-31-38-78:3919:5015 [3] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64
ec2-35-90-65-226: ip-172-31-38-78:3916:5011 [0] NCCL INFO Channel 01/02 :    0   1
ec2-35-90-65-226: ip-172-31-38-78:3919:5015 [3] NCCL INFO Trees [0] 1/-1/-1->0->-1|-1->0->1/-1/-1 [1] -1/-1/-1->0->1|1->0->-1/-1/-1
ec2-35-90-65-226: ip-172-31-38-78:3916:5011 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64
ec2-35-90-65-226: ip-172-31-38-78:3916:5011 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1|-1->0->1/-1/-1 [1] -1/-1/-1->0->1|1->0->-1/-1/-1
ec2-35-90-28-66: ip-172-31-39-36:4025:4846 [2] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64
ec2-35-90-28-66: ip-172-31-39-36:4025:4846 [2] NCCL INFO Trees [0] -1/-1/-1->1->0|0->1->-1/-1/-1 [1] 0/-1/-1->1->-1|-1->1->0/-1/-1
ec2-35-90-65-226: ip-172-31-38-78:3918:5012 [2] NCCL INFO Channel 00/02 :    0   1
ec2-35-90-65-226: ip-172-31-38-78:3918:5012 [2] NCCL INFO Channel 01/02 :    0   1
ec2-35-90-65-226: ip-172-31-38-78:3917:5014 [1] NCCL INFO Channel 00 : 1[1c0] -> 0[1c0] [receive] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3918:5012 [2] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64
ec2-35-90-65-226: ip-172-31-38-78:3918:5012 [2] NCCL INFO Trees [0] 1/-1/-1->0->-1|-1->0->1/-1/-1 [1] -1/-1/-1->0->1|1->0->-1/-1/-1
ec2-35-90-65-226: ip-172-31-38-78:3917:5014 [1] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-28-66: ip-172-31-39-36:4024:4844 [1] NCCL INFO Channel 00 : 0[1c0] -> 1[1c0] [receive] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4024:4844 [1] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-54-244-82-8: ip-172-31-44-10:14965:17074 [1] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64
ec2-34-219-204-184: ip-172-31-41-243:10715:12820 [1] NCCL INFO Channel 00/02 :    0   1
ec2-34-219-204-184: ip-172-31-41-243:10715:12820 [1] NCCL INFO Channel 01/02 :    0   1
ec2-54-244-82-8: ip-172-31-44-10:14965:17074 [1] NCCL INFO Trees [0] -1/-1/-1->1->0|0->1->-1/-1/-1 [1] 0/-1/-1->1->-1|-1->1->0/-1/-1
ec2-34-219-204-184: ip-172-31-41-243:10715:12820 [1] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64
ec2-34-219-204-184: ip-172-31-41-243:10715:12820 [1] NCCL INFO Trees [0] 1/-1/-1->0->-1|-1->0->1/-1/-1 [1] -1/-1/-1->0->1|1->0->-1/-1/-1
ec2-54-244-82-8: ip-172-31-44-10:14966:17075 [2] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64
ec2-54-244-82-8: ip-172-31-44-10:14966:17075 [2] NCCL INFO Trees [0] -1/-1/-1->1->0|0->1->-1/-1/-1 [1] 0/-1/-1->1->-1|-1->1->0/-1/-1
ec2-34-219-204-184: ip-172-31-41-243:10716:12821 [2] NCCL INFO Channel 00/02 :    0   1
ec2-34-219-204-184: ip-172-31-41-243:10716:12821 [2] NCCL INFO Channel 01/02 :    0   1
ec2-34-219-204-184: ip-172-31-41-243:10716:12821 [2] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64
ec2-34-219-204-184: ip-172-31-41-243:10716:12821 [2] NCCL INFO Trees [0] 1/-1/-1->0->-1|-1->0->1/-1/-1 [1] -1/-1/-1->0->1|1->0->-1/-1/-1
ec2-35-90-28-66: ip-172-31-39-36:4026:4845 [3] NCCL INFO Channel 00 : 0[1e0] -> 1[1e0] [receive] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14964:17077 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64
ec2-54-244-82-8: ip-172-31-44-10:14964:17077 [0] NCCL INFO Trees [0] -1/-1/-1->1->0|0->1->-1/-1/-1 [1] 0/-1/-1->1->-1|-1->1->0/-1/-1
ec2-54-244-82-8: ip-172-31-44-10:14967:17076 [3] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64
ec2-54-244-82-8: ip-172-31-44-10:14967:17076 [3] NCCL INFO Trees [0] -1/-1/-1->1->0|0->1->-1/-1/-1 [1] 0/-1/-1->1->-1|-1->1->0/-1/-1
ec2-34-219-204-184: ip-172-31-41-243:10714:12819 [0] NCCL INFO Channel 00/02 :    0   1
ec2-35-90-28-66: ip-172-31-39-36:4026:4845 [3] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-34-219-204-184: ip-172-31-41-243:10714:12819 [0] NCCL INFO Channel 01/02 :    0   1
ec2-34-219-204-184: ip-172-31-41-243:10717:12823 [3] NCCL INFO Channel 00/02 :    0   1
ec2-34-219-204-184: ip-172-31-41-243:10717:12823 [3] NCCL INFO Channel 01/02 :    0   1
ec2-34-219-204-184: ip-172-31-41-243:10717:12823 [3] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64
ec2-34-219-204-184: ip-172-31-41-243:10714:12819 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64
ec2-34-219-204-184: ip-172-31-41-243:10717:12823 [3] NCCL INFO Trees [0] 1/-1/-1->0->-1|-1->0->1/-1/-1 [1] -1/-1/-1->0->1|1->0->-1/-1/-1
ec2-34-219-204-184: ip-172-31-41-243:10714:12819 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1|-1->0->1/-1/-1 [1] -1/-1/-1->0->1|1->0->-1/-1/-1
ec2-35-90-65-226: ip-172-31-38-78:3919:5015 [3] NCCL INFO Channel 00 : 1[1e0] -> 0[1e0] [receive] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3919:5015 [3] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-65-226: ip-172-31-38-78:3916:5011 [0] NCCL INFO Channel 00 : 1[1b0] -> 0[1b0] [receive] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3916:5011 [0] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-65-226: ip-172-31-38-78:3918:5012 [2] NCCL INFO Channel 00 : 1[1d0] -> 0[1d0] [receive] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3918:5012 [2] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-28-66: ip-172-31-39-36:4023:4843 [0] NCCL INFO Channel 00 : 0[1b0] -> 1[1b0] [receive] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4023:4843 [0] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-65-226: ip-172-31-38-78:3917:5014 [1] NCCL INFO Channel 00 : 0[1c0] -> 1[1c0] [send] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4025:4846 [2] NCCL INFO Channel 00 : 0[1d0] -> 1[1d0] [receive] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4025:4846 [2] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-28-66: ip-172-31-39-36:4024:4844 [1] NCCL INFO Channel 00 : 1[1c0] -> 0[1c0] [send] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14965:17074 [1] NCCL INFO Channel 00 : 0[1c0] -> 1[1c0] [receive] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14965:17074 [1] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-34-219-204-184: ip-172-31-41-243:10715:12820 [1] NCCL INFO Channel 00 : 1[1c0] -> 0[1c0] [receive] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10715:12820 [1] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-54-244-82-8: ip-172-31-44-10:14966:17075 [2] NCCL INFO Channel 00 : 0[1d0] -> 1[1d0] [receive] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14966:17075 [2] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-28-66: ip-172-31-39-36:4026:4845 [3] NCCL INFO Channel 00 : 1[1e0] -> 0[1e0] [send] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10717:12823 [3] NCCL INFO Channel 00 : 1[1e0] -> 0[1e0] [receive] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14964:17077 [0] NCCL INFO Channel 00 : 0[1b0] -> 1[1b0] [receive] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10717:12823 [3] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-54-244-82-8: ip-172-31-44-10:14964:17077 [0] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-54-244-82-8: ip-172-31-44-10:14967:17076 [3] NCCL INFO Channel 00 : 0[1e0] -> 1[1e0] [receive] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14967:17076 [3] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-28-66: ip-172-31-39-36:4023:4843 [0] NCCL INFO Channel 00 : 1[1b0] -> 0[1b0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3919:5015 [3] NCCL INFO Channel 00 : 0[1e0] -> 1[1e0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3916:5011 [0] NCCL INFO Channel 00 : 0[1b0] -> 1[1b0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3918:5012 [2] NCCL INFO Channel 00 : 0[1d0] -> 1[1d0] [send] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4025:4846 [2] NCCL INFO Channel 00 : 1[1d0] -> 0[1d0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3917:5014 [1] NCCL INFO Channel 01 : 1[1c0] -> 0[1c0] [receive] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3917:5014 [1] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-28-66: ip-172-31-39-36:4024:4844 [1] NCCL INFO Channel 01 : 0[1c0] -> 1[1c0] [receive] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4024:4844 [1] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-34-219-204-184: ip-172-31-41-243:10716:12821 [2] NCCL INFO Channel 00 : 1[1d0] -> 0[1d0] [receive] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10714:12819 [0] NCCL INFO Channel 00 : 1[1b0] -> 0[1b0] [receive] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10716:12821 [2] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-34-219-204-184: ip-172-31-41-243:10714:12819 [0] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-54-244-82-8: ip-172-31-44-10:14966:17075 [2] NCCL INFO Channel 00 : 1[1d0] -> 0[1d0] [send] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10717:12823 [3] NCCL INFO Channel 00 : 0[1e0] -> 1[1e0] [send] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14964:17077 [0] NCCL INFO Channel 00 : 1[1b0] -> 0[1b0] [send] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14965:17074 [1] NCCL INFO Channel 00 : 1[1c0] -> 0[1c0] [send] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14967:17076 [3] NCCL INFO Channel 00 : 1[1e0] -> 0[1e0] [send] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10715:12820 [1] NCCL INFO Channel 00 : 0[1c0] -> 1[1c0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3917:5014 [1] NCCL INFO Channel 01 : 0[1c0] -> 1[1c0] [send] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4024:4844 [1] NCCL INFO Channel 01 : 1[1c0] -> 0[1c0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3916:5011 [0] NCCL INFO Channel 01 : 1[1b0] -> 0[1b0] [receive] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4023:4843 [0] NCCL INFO Channel 01 : 0[1b0] -> 1[1b0] [receive] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3916:5011 [0] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-65-226: ip-172-31-38-78:3918:5012 [2] NCCL INFO Channel 01 : 1[1d0] -> 0[1d0] [receive] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4023:4843 [0] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-65-226: ip-172-31-38-78:3918:5012 [2] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-28-66: ip-172-31-39-36:4025:4846 [2] NCCL INFO Channel 01 : 0[1d0] -> 1[1d0] [receive] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4025:4846 [2] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-65-226: ip-172-31-38-78:3917:5014 [1] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-35-90-28-66: ip-172-31-39-36:4024:4844 [1] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-35-90-65-226: ip-172-31-38-78:3917:5014 [1] NCCL INFO comm 0x7f2024001060 rank 0 nranks 2 cudaDev 1 busId 1c0 - Init COMPLETE
ec2-35-90-28-66: ip-172-31-39-36:4024:4844 [1] NCCL INFO comm 0x7ff820001060 rank 1 nranks 2 cudaDev 1 busId 1c0 - Init COMPLETE
ec2-35-90-65-226: ip-172-31-38-78:3917:3917 [1] NCCL INFO Launch mode Parallel
ec2-34-219-204-184: ip-172-31-41-243:10716:12821 [2] NCCL INFO Channel 00 : 0[1d0] -> 1[1d0] [send] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10714:12819 [0] NCCL INFO Channel 00 : 0[1b0] -> 1[1b0] [send] via NET/Socket/0
ec2-35-90-28-66: Traceback (most recent call last):
ec2-35-90-28-66:   File "pretrain_transgan.py", line 165, in <module>
ec2-35-90-28-66:     args_defaults={'tokenizer_type': 'GPT2BPETokenizer'})
ec2-35-90-28-66:   File "/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/megatron/training.py", line 162, in pretrain_transgan
ec2-35-90-28-66: ip-172-31-39-36:4023:4843 [0] NCCL INFO Channel 01 : 1[1b0] -> 0[1b0] [send] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14967:17076 [3] NCCL INFO Channel 01 : 0[1e0] -> 1[1e0] [receive] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14967:17076 [3] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-65-226: ip-172-31-38-78:3916:5011 [0] NCCL INFO Channel 01 : 0[1b0] -> 1[1b0] [send] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10717:12823 [3] NCCL INFO Channel 01 : 1[1e0] -> 0[1e0] [receive] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10717:12823 [3] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-65-226: ip-172-31-38-78:3918:5012 [2] NCCL INFO Channel 01 : 0[1d0] -> 1[1d0] [send] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4025:4846 [2] NCCL INFO Channel 01 : 1[1d0] -> 0[1d0] [send] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14965:17074 [1] NCCL INFO Channel 01 : 0[1c0] -> 1[1c0] [receive] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14965:17074 [1] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-34-219-204-184: ip-172-31-41-243:10715:12820 [1] NCCL INFO Channel 01 : 1[1c0] -> 0[1c0] [receive] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4023:4843 [0] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-34-219-204-184: ip-172-31-41-243:10715:12820 [1] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-65-226: ip-172-31-38-78:3916:5011 [0] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-35-90-28-66: ip-172-31-39-36:4023:4843 [0] NCCL INFO comm 0x7f8c1c001060 rank 1 nranks 2 cudaDev 0 busId 1b0 - Init COMPLETE
ec2-35-90-65-226: ip-172-31-38-78:3916:5011 [0] NCCL INFO comm 0x7f8818001060 rank 0 nranks 2 cudaDev 0 busId 1b0 - Init COMPLETE
ec2-35-90-65-226: ip-172-31-38-78:3916:3916 [0] NCCL INFO Launch mode Parallel
ec2-35-90-28-66: Traceback (most recent call last):
ec2-35-90-28-66:   File "pretrain_transgan.py", line 165, in <module>
ec2-35-90-28-66:     args_defaults={'tokenizer_type': 'GPT2BPETokenizer'})
ec2-35-90-28-66:   File "/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/megatron/training.py", line 162, in pretrain_transgan
ec2-54-244-82-8: ip-172-31-44-10:14966:17075 [2] NCCL INFO Channel 01 : 0[1d0] -> 1[1d0] [receive] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14966:17075 [2] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-54-244-82-8: ip-172-31-44-10:14967:17076 [3] NCCL INFO Channel 01 : 1[1e0] -> 0[1e0] [send] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10717:12823 [3] NCCL INFO Channel 01 : 0[1e0] -> 1[1e0] [send] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14965:17074 [1] NCCL INFO Channel 01 : 1[1c0] -> 0[1c0] [send] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10716:12821 [2] NCCL INFO Channel 01 : 1[1d0] -> 0[1d0] [receive] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10716:12821 [2] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-34-219-204-184: ip-172-31-41-243:10715:12820 [1] NCCL INFO Channel 01 : 0[1c0] -> 1[1c0] [send] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10716:12821 [2] NCCL INFO Channel 01 : 0[1d0] -> 1[1d0] [send] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14966:17075 [2] NCCL INFO Channel 01 : 1[1d0] -> 0[1d0] [send] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10716:12821 [2] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-54-244-82-8: ip-172-31-44-10:14966:17075 [2] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-34-219-204-184: ip-172-31-41-243:10716:12821 [2] NCCL INFO comm 0x7f6674001060 rank 0 nranks 2 cudaDev 2 busId 1d0 - Init COMPLETE
ec2-54-244-82-8: ip-172-31-44-10:14966:17075 [2] NCCL INFO comm 0x7f4ab4001060 rank 1 nranks 2 cudaDev 2 busId 1d0 - Init COMPLETE
ec2-34-219-204-184: ip-172-31-41-243:10716:10716 [2] NCCL INFO Launch mode Parallel
ec2-54-244-82-8: NCCL version 2.7.8+cuda11.0
ec2-34-219-204-184: Traceback (most recent call last):
ec2-34-219-204-184:   File "pretrain_transgan.py", line 165, in <module>
ec2-34-219-204-184:     args_defaults={'tokenizer_type': 'GPT2BPETokenizer'})
ec2-34-219-204-184:   File "/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/megatron/training.py", line 162, in pretrain_transgan
ec2-34-219-204-184:     train_valid_test_dataset_provider)
ec2-34-219-204-184:   File "/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/megatron/training.py", line 1068, in build_train_valid_test_data_iterators_transgan
ec2-34-219-204-184:     args=args)
ec2-34-219-204-184:   File "pretrain_transgan.py", line 155, in train_valid_test_datasets_provider
ec2-34-219-204-184:     train_ds_dis = ImageDataset(args, cur_img_size=8)
ec2-34-219-204-184:   File "/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/megatron/data/trans_gan_dataset.py", line 492, in __init__
ec2-34-219-204-184:     self.train_dataset = Dt(root=args.data_path, classes=["church_outdoor_train"], transform=transform)
ec2-34-219-204-184:   File "/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/megatron/data/trans_gan_dataset.py", line 107, in __init__
ec2-34-219-204-184:     transform=transform))
ec2-34-219-204-184:   File "/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/megatron/data/trans_gan_dataset.py", line 39, in __init__
ec2-34-219-204-184:     import lmdb
ec2-34-219-204-184: ModuleNotFoundError: No module named 'lmdb'
ec2-35-90-28-66: ip-172-31-39-36:4026:4845 [3] NCCL INFO Channel 01 : 0[1e0] -> 1[1e0] [receive] via NET/Socket/0
ec2-35-90-28-66: ip-172-31-39-36:4026:4845 [3] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-65-226: ip-172-31-38-78:3919:5015 [3] NCCL INFO Channel 01 : 1[1e0] -> 0[1e0] [receive] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3919:5015 [3] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-54-244-82-8: ip-172-31-44-10:14964:17077 [0] NCCL INFO Channel 01 : 0[1b0] -> 1[1b0] [receive] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14964:17077 [0] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-28-66: ip-172-31-39-36:4026:4845 [3] NCCL INFO Channel 01 : 1[1e0] -> 0[1e0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3919:5015 [3] NCCL INFO Channel 01 : 0[1e0] -> 1[1e0] [send] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10714:12819 [0] NCCL INFO Channel 01 : 1[1b0] -> 0[1b0] [receive] via NET/Socket/0
ec2-34-219-204-184: ip-172-31-41-243:10714:12819 [0] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-28-66: ip-172-31-39-36:4026:4845 [3] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-35-90-65-226: ip-172-31-38-78:3919:5015 [3] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-35-90-28-66: ip-172-31-39-36:4026:4845 [3] NCCL INFO comm 0x7f9830001060 rank 1 nranks 2 cudaDev 3 busId 1e0 - Init COMPLETE
ec2-35-90-65-226: ip-172-31-38-78:3919:5015 [3] NCCL INFO comm 0x7f51dc001060 rank 0 nranks 2 cudaDev 3 busId 1e0 - Init COMPLETE
ec2-35-90-65-226: ip-172-31-38-78:3919:3919 [3] NCCL INFO Launch mode Parallel
ec2-35-90-28-66: ip-172-31-39-36:4025:4846 [2] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-35-90-65-226: ip-172-31-38-78:3918:5012 [2] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-35-90-28-66: ip-172-31-39-36:4025:4846 [2] NCCL INFO comm 0x7fc8cc001060 rank 1 nranks 2 cudaDev 2 busId 1d0 - Init COMPLETE
ec2-35-90-28-66: Traceback (most recent call last):
ec2-35-90-28-66:   File "pretrain_transgan.py", line 165, in <module>
ec2-35-90-65-226: ip-172-31-38-78:3918:5012 [2] NCCL INFO comm 0x7f60e8001060 rank 0 nranks 2 cudaDev 2 busId 1d0 - Init COMPLETE
ec2-35-90-28-66:     args_defaults={'tokenizer_type': 'GPT2BPETokenizer'})
ec2-35-90-28-66:   File "/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/megatron/training.py", line 162, in pretrain_transgan
ec2-35-90-65-226: ip-172-31-38-78:3918:3918 [2] NCCL INFO Launch mode Parallel
ec2-54-244-82-8: ip-172-31-44-10:14964:17077 [0] NCCL INFO Channel 01 : 1[1b0] -> 0[1b0] [send] via NET/Socket/0
ec2-35-90-28-66: Traceback (most recent call last):
ec2-35-90-28-66:   File "pretrain_transgan.py", line 165, in <module>
ec2-35-90-28-66:     args_defaults={'tokenizer_type': 'GPT2BPETokenizer'})
ec2-35-90-28-66:   File "/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/megatron/training.py", line 162, in pretrain_transgan
ec2-34-219-204-184: ip-172-31-41-243:10714:12819 [0] NCCL INFO Channel 01 : 0[1b0] -> 1[1b0] [send] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14967:17076 [3] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-34-219-204-184: ip-172-31-41-243:10717:12823 [3] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-54-244-82-8: ip-172-31-44-10:14967:17076 [3] NCCL INFO comm 0x7fcf8c001060 rank 1 nranks 2 cudaDev 3 busId 1e0 - Init COMPLETE
ec2-34-219-204-184: ip-172-31-41-243:10717:12823 [3] NCCL INFO comm 0x7f6f98001060 rank 0 nranks 2 cudaDev 3 busId 1e0 - Init COMPLETE
ec2-34-219-204-184: ip-172-31-41-243:10717:10717 [3] NCCL INFO Launch mode Parallel
ec2-54-244-82-8: NCCL version 2.7.8+cuda11.0
ec2-34-219-204-184: Traceback (most recent call last):
ec2-34-219-204-184:   File "pretrain_transgan.py", line 165, in <module>
ec2-34-219-204-184:     args_defaults={'tokenizer_type': 'GPT2BPETokenizer'})
ec2-34-219-204-184:   File "/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/megatron/training.py", line 162, in pretrain_transgan
ec2-34-219-204-184:     train_valid_test_dataset_provider)
ec2-34-219-204-184:   File "/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/megatron/training.py", line 1068, in build_train_valid_test_data_iterators_transgan
ec2-54-244-82-8: ip-172-31-44-10:14964:17077 [0] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-34-219-204-184: ip-172-31-41-243:10714:12819 [0] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-34-219-204-184:     args=args)
ec2-34-219-204-184:   File "pretrain_transgan.py", line 155, in train_valid_test_datasets_provider
ec2-34-219-204-184:     train_ds_dis = ImageDataset(args, cur_img_size=8)
ec2-34-219-204-184:   File "/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/megatron/data/trans_gan_dataset.py", line 492, in __init__
ec2-54-244-82-8: ip-172-31-44-10:14964:17077 [0] NCCL INFO comm 0x7f910c001060 rank 1 nranks 2 cudaDev 0 busId 1b0 - Init COMPLETE
ec2-34-219-204-184: ip-172-31-41-243:10714:12819 [0] NCCL INFO comm 0x7f2370001060 rank 0 nranks 2 cudaDev 0 busId 1b0 - Init COMPLETE
ec2-34-219-204-184:     self.train_dataset = Dt(root=args.data_path, classes=["church_outdoor_train"], transform=transform)
ec2-34-219-204-184:   File "/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/megatron/data/trans_gan_dataset.py", line 107, in __init__
ec2-34-219-204-184:     transform=transform))
ec2-34-219-204-184:   File "/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/megatron/data/trans_gan_dataset.py", line 39, in __init__
ec2-34-219-204-184: ip-172-31-41-243:10714:10714 [0] NCCL INFO Launch mode Parallel
ec2-34-219-204-184:     import lmdb
ec2-34-219-204-184: ModuleNotFoundError: No module named 'lmdb'
ec2-34-219-204-184: ip-172-31-41-243:10715:12820 [1] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-34-219-204-184: > building train, validation, and test datasets ...
ec2-34-219-204-184:  > datasets target sizes (minimum size):
ec2-34-219-204-184:     train:      20480000
ec2-34-219-204-184:     validation: 2560000
ec2-34-219-204-184:     test:       640000
ec2-34-219-204-184: > building train dataset for TransGAN ...
ec2-54-244-82-8: ip-172-31-44-10:14965:17074 [1] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-34-219-204-184: ip-172-31-41-243:10715:12820 [1] NCCL INFO comm 0x7fc110001060 rank 0 nranks 2 cudaDev 1 busId 1c0 - Init COMPLETE
ec2-34-219-204-184: ip-172-31-41-243:10715:10715 [1] NCCL INFO Launch mode Parallel
ec2-54-244-82-8: ip-172-31-44-10:14965:17074 [1] NCCL INFO comm 0x7f2344001060 rank 1 nranks 2 cudaDev 1 busId 1c0 - Init COMPLETE
ec2-34-219-204-184: Traceback (most recent call last):
ec2-34-219-204-184:   File "pretrain_transgan.py", line 165, in <module>
ec2-34-219-204-184:     args_defaults={'tokenizer_type': 'GPT2BPETokenizer'})
ec2-34-219-204-184:   File "/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/megatron/training.py", line 162, in pretrain_transgan
ec2-54-244-82-8: NCCL version 2.7.8+cuda11.0
ec2-34-219-204-184:     train_valid_test_dataset_provider)
ec2-34-219-204-184:   File "/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/megatron/training.py", line 1068, in build_train_valid_test_data_iterators_transgan
ec2-34-219-204-184:     args=args)
ec2-34-219-204-184:   File "pretrain_transgan.py", line 155, in train_valid_test_datasets_provider
ec2-34-219-204-184:     train_ds_dis = ImageDataset(args, cur_img_size=8)
ec2-34-219-204-184:   File "/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/megatron/data/trans_gan_dataset.py", line 492, in __init__
ec2-34-219-204-184: Traceback (most recent call last):
ec2-34-219-204-184:   File "pretrain_transgan.py", line 165, in <module>
ec2-34-219-204-184:     self.train_dataset = Dt(root=args.data_path, classes=["church_outdoor_train"], transform=transform)
ec2-34-219-204-184:   File "/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/megatron/data/trans_gan_dataset.py", line 107, in __init__
ec2-34-219-204-184:     transform=transform))
ec2-34-219-204-184:     args_defaults={'tokenizer_type': 'GPT2BPETokenizer'})  File "/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/megatron/data/trans_gan_dataset.py", line 39, in __init__
ec2-34-219-204-184: 
ec2-34-219-204-184:   File "/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/megatron/training.py", line 162, in pretrain_transgan
ec2-34-219-204-184:     import lmdb
ec2-34-219-204-184: ModuleNotFoundError: No module named 'lmdb'
ec2-34-219-204-184:     train_valid_test_dataset_provider)
ec2-34-219-204-184:   File "/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/megatron/training.py", line 1068, in build_train_valid_test_data_iterators_transgan
ec2-34-219-204-184:     args=args)
ec2-34-219-204-184:   File "pretrain_transgan.py", line 155, in train_valid_test_datasets_provider
ec2-34-219-204-184:     train_ds_dis = ImageDataset(args, cur_img_size=8)
ec2-34-219-204-184:   File "/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/megatron/data/trans_gan_dataset.py", line 492, in __init__
ec2-34-219-204-184:     self.train_dataset = Dt(root=args.data_path, classes=["church_outdoor_train"], transform=transform)
ec2-34-219-204-184:   File "/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/megatron/data/trans_gan_dataset.py", line 107, in __init__
ec2-34-219-204-184:     transform=transform))
ec2-34-219-204-184:   File "/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/megatron/data/trans_gan_dataset.py", line 39, in __init__
ec2-34-219-204-184:     import lmdb
ec2-34-219-204-184: ModuleNotFoundError: No module named 'lmdb'
ec2-54-244-82-8: ip-172-31-44-10:14966:17081 [2] NCCL INFO Channel 00/02 :    0   1
ec2-54-244-82-8: ip-172-31-44-10:14966:17081 [2] NCCL INFO Channel 01/02 :    0   1
ec2-54-244-82-8: ip-172-31-44-10:14966:17081 [2] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64
ec2-54-244-82-8: ip-172-31-44-10:14966:17081 [2] NCCL INFO Trees [0] 1/-1/-1->0->-1|-1->0->1/-1/-1 [1] -1/-1/-1->0->1|1->0->-1/-1/-1
ec2-35-90-65-226: ip-172-31-38-78:3918:5027 [2] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64
ec2-35-90-65-226: ip-172-31-38-78:3918:5027 [2] NCCL INFO Trees [0] -1/-1/-1->1->0|0->1->-1/-1/-1 [1] 0/-1/-1->1->-1|-1->1->0/-1/-1
ec2-54-244-82-8: ip-172-31-44-10:14966:17081 [2] NCCL INFO Channel 00 : 1[1d0] -> 0[1d0] [receive] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14966:17081 [2] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-65-226: ip-172-31-38-78:3918:5027 [2] NCCL INFO Channel 00 : 0[1d0] -> 1[1d0] [receive] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3918:5027 [2] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-54-244-82-8: ip-172-31-44-10:14967:17084 [3] NCCL INFO Channel 00/02 :    0   1
ec2-54-244-82-8: ip-172-31-44-10:14967:17084 [3] NCCL INFO Channel 01/02 :    0   1
ec2-35-90-65-226: ip-172-31-38-78:3919:5028 [3] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64
ec2-35-90-65-226: ip-172-31-38-78:3919:5028 [3] NCCL INFO Trees [0] -1/-1/-1->1->0|0->1->-1/-1/-1 [1] 0/-1/-1->1->-1|-1->1->0/-1/-1
ec2-54-244-82-8: ip-172-31-44-10:14967:17084 [3] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64
ec2-54-244-82-8: ip-172-31-44-10:14967:17084 [3] NCCL INFO Trees [0] 1/-1/-1->0->-1|-1->0->1/-1/-1 [1] -1/-1/-1->0->1|1->0->-1/-1/-1
ec2-54-244-82-8: ip-172-31-44-10:14964:17088 [0] NCCL INFO Channel 00/02 :    0   1
ec2-54-244-82-8: ip-172-31-44-10:14964:17088 [0] NCCL INFO Channel 01/02 :    0   1
ec2-35-90-65-226: ip-172-31-38-78:3916:5029 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64
ec2-35-90-65-226: ip-172-31-38-78:3916:5029 [0] NCCL INFO Trees [0] -1/-1/-1->1->0|0->1->-1/-1/-1 [1] 0/-1/-1->1->-1|-1->1->0/-1/-1
ec2-54-244-82-8: ip-172-31-44-10:14964:17088 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64
ec2-54-244-82-8: ip-172-31-44-10:14964:17088 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1|-1->0->1/-1/-1 [1] -1/-1/-1->0->1|1->0->-1/-1/-1
ec2-54-244-82-8: ip-172-31-44-10:14965:17093 [1] NCCL INFO Channel 00/02 :    0   1
ec2-54-244-82-8: ip-172-31-44-10:14965:17093 [1] NCCL INFO Channel 01/02 :    0   1
ec2-35-90-65-226: ip-172-31-38-78:3917:5030 [1] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64
ec2-35-90-65-226: ip-172-31-38-78:3917:5030 [1] NCCL INFO Trees [0] -1/-1/-1->1->0|0->1->-1/-1/-1 [1] 0/-1/-1->1->-1|-1->1->0/-1/-1
ec2-54-244-82-8: ip-172-31-44-10:14965:17093 [1] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 8/8/64
ec2-54-244-82-8: ip-172-31-44-10:14965:17093 [1] NCCL INFO Trees [0] 1/-1/-1->0->-1|-1->0->1/-1/-1 [1] -1/-1/-1->0->1|1->0->-1/-1/-1
ec2-54-244-82-8: ip-172-31-44-10:14966:17081 [2] NCCL INFO Channel 00 : 0[1d0] -> 1[1d0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3918:5027 [2] NCCL INFO Channel 00 : 1[1d0] -> 0[1d0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3919:5028 [3] NCCL INFO Channel 00 : 0[1e0] -> 1[1e0] [receive] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3919:5028 [3] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-65-226: ip-172-31-38-78:3916:5029 [0] NCCL INFO Channel 00 : 0[1b0] -> 1[1b0] [receive] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3916:5029 [0] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-54-244-82-8: ip-172-31-44-10:14964:17088 [0] NCCL INFO Channel 00 : 1[1b0] -> 0[1b0] [receive] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14964:17088 [0] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-54-244-82-8: ip-172-31-44-10:14967:17084 [3] NCCL INFO Channel 00 : 1[1e0] -> 0[1e0] [receive] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14967:17084 [3] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-65-226: ip-172-31-38-78:3917:5030 [1] NCCL INFO Channel 00 : 0[1c0] -> 1[1c0] [receive] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3917:5030 [1] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-65-226: ip-172-31-38-78:3919:5028 [3] NCCL INFO Channel 00 : 1[1e0] -> 0[1e0] [send] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14965:17093 [1] NCCL INFO Channel 00 : 1[1c0] -> 0[1c0] [receive] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14965:17093 [1] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-65-226: ip-172-31-38-78:3916:5029 [0] NCCL INFO Channel 00 : 1[1b0] -> 0[1b0] [send] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14964:17088 [0] NCCL INFO Channel 00 : 0[1b0] -> 1[1b0] [send] via NET/Socket/0
ec2-35-90-28-66:         train_valid_test_dataset_provider)train_valid_test_dataset_provider)
ec2-35-90-28-66:     
ec2-35-90-28-66: train_valid_test_dataset_provider)
ec2-35-90-28-66:   File "/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/megatron/training.py", line 1068, in build_train_valid_test_data_iterators_transgan
ec2-35-90-28-66:   File "/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/megatron/training.py", line 1068, in build_train_valid_test_data_iterators_transgan
ec2-35-90-28-66:   File "/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/megatron/training.py", line 1068, in build_train_valid_test_data_iterators_transgan
ec2-35-90-28-66:     train_valid_test_dataset_provider)
ec2-35-90-28-66:   File "/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/megatron/training.py", line 1068, in build_train_valid_test_data_iterators_transgan
ec2-35-90-28-66:                 args=args)args=args)args=args)args=args)
ec2-35-90-28-66: 
ec2-35-90-28-66: 
ec2-35-90-28-66: 
ec2-35-90-28-66:   File "pretrain_transgan.py", line 155, in train_valid_test_datasets_provider
ec2-35-90-28-66:   File "pretrain_transgan.py", line 155, in train_valid_test_datasets_provider
ec2-35-90-28-66:   File "pretrain_transgan.py", line 155, in train_valid_test_datasets_provider
ec2-35-90-28-66:   File "pretrain_transgan.py", line 155, in train_valid_test_datasets_provider
ec2-35-90-28-66:             train_ds_dis = ImageDataset(args, cur_img_size=8)train_ds_dis = ImageDataset(args, cur_img_size=8)train_ds_dis = ImageDataset(args, cur_img_size=8)    
ec2-35-90-28-66: 
ec2-35-90-28-66: 
ec2-35-90-28-66: train_ds_dis = ImageDataset(args, cur_img_size=8)
ec2-35-90-28-66:   File "/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/megatron/data/trans_gan_dataset.py", line 492, in __init__
ec2-35-90-28-66:   File "/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/megatron/data/trans_gan_dataset.py", line 492, in __init__
ec2-35-90-28-66:   File "/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/megatron/data/trans_gan_dataset.py", line 492, in __init__
ec2-35-90-28-66:   File "/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/megatron/data/trans_gan_dataset.py", line 492, in __init__
ec2-35-90-28-66:         self.train_dataset = Dt(root=args.data_path, classes=["church_outdoor_train"], transform=transform)self.train_dataset = Dt(root=args.data_path, classes=["church_outdoor_train"], transform=transform)
ec2-35-90-28-66: 
ec2-35-90-28-66:   File "/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/megatron/data/trans_gan_dataset.py", line 107, in __init__
ec2-35-90-28-66:   File "/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/megatron/data/trans_gan_dataset.py", line 107, in __init__
ec2-35-90-28-66:     self.train_dataset = Dt(root=args.data_path, classes=["church_outdoor_train"], transform=transform)
ec2-35-90-28-66:   File "/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/megatron/data/trans_gan_dataset.py", line 107, in __init__
ec2-35-90-28-66:     self.train_dataset = Dt(root=args.data_path, classes=["church_outdoor_train"], transform=transform)
ec2-35-90-28-66:   File "/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/megatron/data/trans_gan_dataset.py", line 107, in __init__
ec2-35-90-28-66:         transform=transform))transform=transform))
ec2-35-90-28-66: 
ec2-35-90-28-66:   File "/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/megatron/data/trans_gan_dataset.py", line 39, in __init__
ec2-35-90-28-66:   File "/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/megatron/data/trans_gan_dataset.py", line 39, in __init__
ec2-35-90-28-66:     transform=transform))
ec2-35-90-28-66:     transform=transform))  File "/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/megatron/data/trans_gan_dataset.py", line 39, in __init__
ec2-35-90-28-66: 
ec2-35-90-28-66:   File "/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/megatron/data/trans_gan_dataset.py", line 39, in __init__
ec2-35-90-28-66:         import lmdbimport lmdb
ec2-35-90-28-66: 
ec2-35-90-28-66: ModuleNotFoundErrorModuleNotFoundError: : No module named 'lmdb'No module named 'lmdb'
ec2-35-90-28-66: 
ec2-35-90-28-66:         import lmdb
ec2-35-90-28-66: import lmdb
ec2-35-90-28-66: ModuleNotFoundErrorModuleNotFoundError: : No module named 'lmdb'No module named 'lmdb'
ec2-35-90-28-66: 
ec2-54-244-82-8: ip-172-31-44-10:14967:17084 [3] NCCL INFO Channel 00 : 0[1e0] -> 1[1e0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3917:5030 [1] NCCL INFO Channel 00 : 1[1c0] -> 0[1c0] [send] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14965:17093 [1] NCCL INFO Channel 00 : 0[1c0] -> 1[1c0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3916:5029 [0] NCCL INFO Channel 01 : 0[1b0] -> 1[1b0] [receive] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3916:5029 [0] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-54-244-82-8: ip-172-31-44-10:14964:17088 [0] NCCL INFO Channel 01 : 1[1b0] -> 0[1b0] [receive] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14964:17088 [0] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-65-226: ip-172-31-38-78:3919:5028 [3] NCCL INFO Channel 01 : 0[1e0] -> 1[1e0] [receive] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3919:5028 [3] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-65-226: ip-172-31-38-78:3916:5029 [0] NCCL INFO Channel 01 : 1[1b0] -> 0[1b0] [send] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14964:17088 [0] NCCL INFO Channel 01 : 0[1b0] -> 1[1b0] [send] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14964:17088 [0] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-35-90-65-226: ip-172-31-38-78:3916:5029 [0] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-54-244-82-8: ip-172-31-44-10:14967:17084 [3] NCCL INFO Channel 01 : 1[1e0] -> 0[1e0] [receive] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14964:17088 [0] NCCL INFO comm 0x7f8f88001060 rank 0 nranks 2 cudaDev 0 busId 1b0 - Init COMPLETE
ec2-54-244-82-8: ip-172-31-44-10:14967:17084 [3] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-65-226: ip-172-31-38-78:3916:5029 [0] NCCL INFO comm 0x7f8814001060 rank 1 nranks 2 cudaDev 0 busId 1b0 - Init COMPLETE
ec2-54-244-82-8: ip-172-31-44-10:14964:14964 [0] NCCL INFO Launch mode Parallel
ec2-35-90-65-226: ip-172-31-38-78:3917:5030 [1] NCCL INFO Channel 01 : 0[1c0] -> 1[1c0] [receive] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3917:5030 [1] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-54-244-82-8: ip-172-31-44-10:14965:17093 [1] NCCL INFO Channel 01 : 1[1c0] -> 0[1c0] [receive] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14965:17093 [1] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-35-90-65-226: ip-172-31-38-78:3919:5028 [3] NCCL INFO Channel 01 : 1[1e0] -> 0[1e0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3918:5027 [2] NCCL INFO Channel 01 : 0[1d0] -> 1[1d0] [receive] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3918:5027 [2] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-54-244-82-8: ip-172-31-44-10:14966:17081 [2] NCCL INFO Channel 01 : 1[1d0] -> 0[1d0] [receive] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14966:17081 [2] NCCL INFO NET/Socket: Using 2 threads and 8 sockets per thread
ec2-54-244-82-8: ip-172-31-44-10:14967:17084 [3] NCCL INFO Channel 01 : 0[1e0] -> 1[1e0] [send] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14965:17093 [1] NCCL INFO Channel 01 : 0[1c0] -> 1[1c0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3917:5030 [1] NCCL INFO Channel 01 : 1[1c0] -> 0[1c0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3918:5027 [2] NCCL INFO Channel 01 : 1[1d0] -> 0[1d0] [send] via NET/Socket/0
ec2-54-244-82-8: ip-172-31-44-10:14966:17081 [2] NCCL INFO Channel 01 : 0[1d0] -> 1[1d0] [send] via NET/Socket/0
ec2-35-90-65-226: ip-172-31-38-78:3919:5028 [3] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-54-244-82-8: ip-172-31-44-10:14967:17084 [3] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-35-90-65-226: ip-172-31-38-78:3919:5028 [3] NCCL INFO comm 0x7f51e4001060 rank 1 nranks 2 cudaDev 3 busId 1e0 - Init COMPLETE
ec2-54-244-82-8: ip-172-31-44-10:14967:17084 [3] NCCL INFO comm 0x7fcf80001060 rank 0 nranks 2 cudaDev 3 busId 1e0 - Init COMPLETE
ec2-54-244-82-8: ip-172-31-44-10:14965:17093 [1] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-54-244-82-8: ip-172-31-44-10:14967:14967 [3] NCCL INFO Launch mode Parallel
ec2-35-90-65-226: ip-172-31-38-78:3917:5030 [1] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-54-244-82-8: ip-172-31-44-10:14965:17093 [1] NCCL INFO comm 0x7f2338001060 rank 0 nranks 2 cudaDev 1 busId 1c0 - Init COMPLETE
ec2-54-244-82-8: ip-172-31-44-10:14965:14965 [1] NCCL INFO Launch mode Parallel
ec2-35-90-65-226: ip-172-31-38-78:3917:5030 [1] NCCL INFO comm 0x7f202c001060 rank 1 nranks 2 cudaDev 1 busId 1c0 - Init COMPLETE
ec2-35-90-65-226: ip-172-31-38-78:3918:5027 [2] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-54-244-82-8: ip-172-31-44-10:14966:17081 [2] NCCL INFO 2 coll channels, 2 p2p channels, 1 p2p channels per peer
ec2-35-90-65-226: ip-172-31-38-78:3918:5027 [2] NCCL INFO comm 0x7f60f0001060 rank 1 nranks 2 cudaDev 2 busId 1d0 - Init COMPLETE
ec2-54-244-82-8: ip-172-31-44-10:14966:17081 [2] NCCL INFO comm 0x7f4aa8001060 rank 0 nranks 2 cudaDev 2 busId 1d0 - Init COMPLETE
ec2-54-244-82-8: ip-172-31-44-10:14966:14966 [2] NCCL INFO Launch mode Parallel
ec2-54-244-82-8: 
ec2-54-244-82-8: ip-172-31-44-10:14964:16593 [0] include/socket.h:416 NCCL WARN Net : Connection closed by remote peer
ec2-54-244-82-8: ip-172-31-44-10:14964:16593 [0] NCCL INFO transport/net_socket.cc:405 -> 2
ec2-54-244-82-8: ip-172-31-44-10:14964:16593 [0] NCCL INFO include/net.h:28 -> 2
ec2-54-244-82-8: ip-172-31-44-10:14964:16593 [0] NCCL INFO transport/net.cc:357 -> 2
ec2-54-244-82-8: ip-172-31-44-10:14964:16593 [0] NCCL INFO proxy.cc:198 -> 2 [Proxy Thread]
ec2-35-90-28-66: Killing subprocess 4023
ec2-35-90-28-66: Killing subprocess 4024
ec2-35-90-28-66: Killing subprocess 4025
ec2-35-90-28-66: Killing subprocess 4026
ec2-35-90-28-66: Traceback (most recent call last):
ec2-35-90-28-66:   File "/home/ubuntu/anaconda3/envs/amp/lib/python3.7/runpy.py", line 193, in _run_module_as_main
ec2-35-90-28-66:     "__main__", mod_spec)
ec2-35-90-28-66:   File "/home/ubuntu/anaconda3/envs/amp/lib/python3.7/runpy.py", line 85, in _run_code
ec2-35-90-28-66:     exec(code, run_globals)
ec2-35-90-28-66:   File "/home/ubuntu/AMP/DeepSpeed/deepspeed/launcher/launch.py", line 206, in <module>
ec2-35-90-28-66:     main()
ec2-35-90-28-66:   File "/home/ubuntu/AMP/DeepSpeed/deepspeed/launcher/launch.py", line 195, in main
ec2-35-90-28-66:     sigkill_handler(signal.SIGTERM, None)  # not coming back
ec2-35-90-28-66:   File "/home/ubuntu/AMP/DeepSpeed/deepspeed/launcher/launch.py", line 165, in sigkill_handler
ec2-35-90-28-66:     raise subprocess.CalledProcessError(returncode=last_return_code, cmd=cmd)
ec2-35-90-28-66: subprocess.CalledProcessError: Command '['/home/ubuntu/anaconda3/envs/amp/bin/python3.7', '-u', 'pretrain_transgan.py', '--local_rank=3', '--model-parallel-size', '1', '--pipe-parallel-size', '4', '--gas', '16', '--exp_name', 'simulate_het_model', '--num-layers', '24', '--hidden-size', '1024', '--num-attention-heads', '1', '--seq-length', '1024', '--fp16', '--max-position-embeddings', '1024', '--batch-size', '1', '--train-iters', '320000', '--lr-decay-iters', '320000', '--save', '/home/ubuntu/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/examples/ckpts/gpt2_1542m_ds_distributed', '--load', '/home/ubuntu/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/examples/ckpts/gpt2_1542m_ds_distributed', '--data-path', '/home/ubuntu/datasets/datasets/preprocessed_data/my-gpt2_text_document', '--vocab-file', '/home/ubuntu/datasets/datasets/gpt2-vocab.json', '--merge-file', '/home/ubuntu/datasets/datasets/gpt2-merges.txt', '--data-impl', 'mmap', '--split', '949,50,1', '--distributed-backend', 'nccl', '--lr', '1.5e-4', '--lr-decay-style', 'cosine', '--min-lr', '1.0e-5', '--weight-decay', '1e-2', '--clip-grad', '1.0', '--warmup', '0.01', '--log-interval', '20', '--save-interval', '50000', '--eval-interval', '100000', '--eval-iters', '10000', '--tensorboard-dir', 'tensorboard_data/24l_1024h_n_g_4pp_1mp_1b_ds4', '-gen_bs', '16', '-dis_bs', '16', '--accumulated_times', '4', '--g_accumulated_times', '8', '--dist-url', 'tcp://localhost:10641', '--dist-backend', 'nccl', '--dataset', 'church', '--data_path', './lsun', '--bottom_width', '9', '--img_size', '256', '--max_iter', '500000', '--gen_model', 'ViT_custom_local544444_256_rp_noise', '--dis_model', 'ViT_scale3_local_new_rp', '--g_window_size', '18', '--d_window_size', '12', '--g_norm', 'pn', '--df_dim', '384', '--d_depth', '3', '--g_depth', '12,0,0,0,0,12', '--latent_dim', '512', '--gf_dim', '1024', '--num_workers', '8', '--g_lr', '0.0001', '--d_lr', '0.0001', '--optimizer', 'adam', '--loss', 'wgangp-eps', '--wd', '1e-3', '--beta1', '0', '--beta2', '0.99', '--phi', '1', '--eval_batch_size', '10', '--num_eval_imgs', '50000', '--init_type', 'xavier_uniform', '--n_critic', '4', '--val_freq', '5000', '--print_freq', '50', '--grow_steps', '0', '0', '--fade_in', '0', '--patch_size', '4', '--diff_aug', 'translation,erase_ratio,color', '--fid_stat', 'fid_stat/fid_stats_church_256.npz', '--ema', '0.995', '--deepspeed', '--deepspeed_config', '/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/examples/ds_config.json']' returned non-zero exit status 1.
pdsh@ip-172-31-41-243: ec2-35-90-28-66: ssh exited with exit code 1
ec2-34-219-204-184: Killing subprocess 10714
ec2-34-219-204-184: Killing subprocess 10715
ec2-34-219-204-184: Killing subprocess 10716
ec2-34-219-204-184: Killing subprocess 10717
ec2-34-219-204-184: Traceback (most recent call last):
ec2-34-219-204-184:   File "/home/ubuntu/anaconda3/envs/amp/lib/python3.7/runpy.py", line 193, in _run_module_as_main
ec2-34-219-204-184:     "__main__", mod_spec)
ec2-34-219-204-184:   File "/home/ubuntu/anaconda3/envs/amp/lib/python3.7/runpy.py", line 85, in _run_code
ec2-34-219-204-184:     exec(code, run_globals)
ec2-34-219-204-184:   File "/home/ubuntu/AMP/DeepSpeed/deepspeed/launcher/launch.py", line 206, in <module>
ec2-34-219-204-184:     main()
ec2-34-219-204-184:   File "/home/ubuntu/AMP/DeepSpeed/deepspeed/launcher/launch.py", line 195, in main
ec2-34-219-204-184:     sigkill_handler(signal.SIGTERM, None)  # not coming back
ec2-34-219-204-184:   File "/home/ubuntu/AMP/DeepSpeed/deepspeed/launcher/launch.py", line 165, in sigkill_handler
ec2-34-219-204-184:     raise subprocess.CalledProcessError(returncode=last_return_code, cmd=cmd)
ec2-34-219-204-184: subprocess.CalledProcessError: Command '['/home/ubuntu/anaconda3/envs/amp/bin/python3.7', '-u', 'pretrain_transgan.py', '--local_rank=3', '--model-parallel-size', '1', '--pipe-parallel-size', '4', '--gas', '16', '--exp_name', 'simulate_het_model', '--num-layers', '24', '--hidden-size', '1024', '--num-attention-heads', '1', '--seq-length', '1024', '--fp16', '--max-position-embeddings', '1024', '--batch-size', '1', '--train-iters', '320000', '--lr-decay-iters', '320000', '--save', '/home/ubuntu/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/examples/ckpts/gpt2_1542m_ds_distributed', '--load', '/home/ubuntu/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/examples/ckpts/gpt2_1542m_ds_distributed', '--data-path', '/home/ubuntu/datasets/datasets/preprocessed_data/my-gpt2_text_document', '--vocab-file', '/home/ubuntu/datasets/datasets/gpt2-vocab.json', '--merge-file', '/home/ubuntu/datasets/datasets/gpt2-merges.txt', '--data-impl', 'mmap', '--split', '949,50,1', '--distributed-backend', 'nccl', '--lr', '1.5e-4', '--lr-decay-style', 'cosine', '--min-lr', '1.0e-5', '--weight-decay', '1e-2', '--clip-grad', '1.0', '--warmup', '0.01', '--log-interval', '20', '--save-interval', '50000', '--eval-interval', '100000', '--eval-iters', '10000', '--tensorboard-dir', 'tensorboard_data/24l_1024h_n_g_4pp_1mp_1b_ds4', '-gen_bs', '16', '-dis_bs', '16', '--accumulated_times', '4', '--g_accumulated_times', '8', '--dist-url', 'tcp://localhost:10641', '--dist-backend', 'nccl', '--dataset', 'church', '--data_path', './lsun', '--bottom_width', '9', '--img_size', '256', '--max_iter', '500000', '--gen_model', 'ViT_custom_local544444_256_rp_noise', '--dis_model', 'ViT_scale3_local_new_rp', '--g_window_size', '18', '--d_window_size', '12', '--g_norm', 'pn', '--df_dim', '384', '--d_depth', '3', '--g_depth', '12,0,0,0,0,12', '--latent_dim', '512', '--gf_dim', '1024', '--num_workers', '8', '--g_lr', '0.0001', '--d_lr', '0.0001', '--optimizer', 'adam', '--loss', 'wgangp-eps', '--wd', '1e-3', '--beta1', '0', '--beta2', '0.99', '--phi', '1', '--eval_batch_size', '10', '--num_eval_imgs', '50000', '--init_type', 'xavier_uniform', '--n_critic', '4', '--val_freq', '5000', '--print_freq', '50', '--grow_steps', '0', '0', '--fade_in', '0', '--patch_size', '4', '--diff_aug', 'translation,erase_ratio,color', '--fid_stat', 'fid_stat/fid_stats_church_256.npz', '--ema', '0.995', '--deepspeed', '--deepspeed_config', '/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/examples/ds_config.json']' returned non-zero exit status 1.
pdsh@ip-172-31-41-243: ec2-34-219-204-184: ssh exited with exit code 1
pdsh@ip-172-31-41-243: interrupt (one more within 1 sec to abort)
pdsh@ip-172-31-41-243:  (^Z within 1 sec to cancel pending threads)
pdsh@ip-172-31-41-243: ec2-54-244-82-8: command in progress
pdsh@ip-172-31-41-243: ec2-35-90-65-226: command in progress

amp gives partition: [24]
[24] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 56] tensor([4.2591]) tensor([0.1812])
pipe_ast used 14.538636684417725 with L=25, k=16
amp gives partition: [3, 3, 3, 3, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[3, 3, 3, 3, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 5, 8, 11, 14, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 56] tensor([7.6214]) tensor([0.])
using pipe uniform
pipe uniform returns [3, 3, 3, 3, 3, 3, 3, 3]
amp gives partition: [3, 3, 3, 3, 3, 3, 3, 3]
[3, 3, 3, 3, 3, 3, 3, 3] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 5, 8, 11, 14, 43, 46, 49, 56] tensor([7.0312]) tensor([0.0071])
pipe_ast used 9.741841554641724 with L=25, k=8
amp gives partition: [6, 6, 3, 2, 2, 2, 2, 2]
[6, 6, 3, 2, 2, 2, 2, 2] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 8, 14, 43, 45, 47, 49, 51, 56] tensor([9.7538]) tensor([0.])
using pipe uniform
pipe uniform returns [6, 6, 6, 6]
amp gives partition: [6, 6, 6, 6]
[6, 6, 6, 6] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 8, 14, 46, 56] tensor([8.4343]) tensor([0.0071])
pipe_ast used 4.919516324996948 with L=25, k=4
amp gives partition: [10, 6, 4, 5]
[10, 6, 4, 5] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 12, 44, 48, 56] tensor([10.3676]) tensor([0.])
using pipe uniform
pipe uniform returns [12, 12]
amp gives partition: [12, 12]
[12, 12] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 14, 56] tensor([8.2750]) tensor([0.1107])
using pipe uniform
pipe uniform returns [2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1]
amp gives partition: [2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1]
[2, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 4, 6, 8, 10, 12, 14, 42, 44, 45, 46, 47, 48, 49, 50, 51, 56] tensor([14.0561]) tensor([0.])
using pipe uniform
pipe uniform returns [3, 3, 3, 3, 3, 3, 3, 3]
amp gives partition: [3, 3, 3, 3, 3, 3, 3, 3]
[3, 3, 3, 3, 3, 3, 3, 3] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 5, 8, 11, 14, 43, 46, 49, 56] tensor([16.8583]) tensor([0.])
using pipe uniform
pipe uniform returns [6, 6, 6, 6]
amp gives partition: [6, 6, 6, 6]
[6, 6, 6, 6] [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52]
[0, 8, 14, 46, 56] tensor([16.3625]) tensor([0.])
finish amp search without placement in 65 iterations in 292.6981248855591
debug rank_map None
bash /home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/examples/ds_pretrain_transgan_pipe.sh 1 4 24 1024 1 16 simulate_het_model
Traceback (most recent call last):
  File "/home/ubuntu/anaconda3/envs/amp/bin/deepspeed", line 7, in <module>
    exec(compile(f.read(), __file__, 'exec'))
  File "/home/ubuntu/AMP/DeepSpeed/bin/deepspeed", line 6, in <module>
    main()
  File "/home/ubuntu/AMP/DeepSpeed/deepspeed/launcher/runner.py", line 362, in main
    result.wait()
  File "/home/ubuntu/anaconda3/envs/amp/lib/python3.7/subprocess.py", line 990, in wait
    return self._wait(timeout=timeout)
  File "/home/ubuntu/anaconda3/envs/amp/lib/python3.7/subprocess.py", line 1624, in _wait
    (pid, sts) = self._try_wait(0)
  File "/home/ubuntu/anaconda3/envs/amp/lib/python3.7/subprocess.py", line 1582, in _try_wait
    (pid, sts) = os.waitpid(self.pid, wait_flags)
KeyboardInterrupt
Traceback (most recent call last):
  File "het_model.py", line 127, in <module>
    gt_cost = simulate([rmap], [partition], torch.ones(1,)*global_bs, to_float_torch([mbs]), model_config, [oth], exp_name)
  File "/home/ubuntu/AMP/DeepSpeed/DeepSpeedExamples/Megatron-LM-v1.1.5-3D_parallelism/amp_utils.py", line 149, in simulate
    subprocess.run(cmd, shell=True)
  File "/home/ubuntu/anaconda3/envs/amp/lib/python3.7/subprocess.py", line 474, in run
    stdout, stderr = process.communicate(input, timeout=timeout)
  File "/home/ubuntu/anaconda3/envs/amp/lib/python3.7/subprocess.py", line 931, in communicate
    self.wait()
  File "/home/ubuntu/anaconda3/envs/amp/lib/python3.7/subprocess.py", line 990, in wait
    return self._wait(timeout=timeout)
  File "/home/ubuntu/anaconda3/envs/amp/lib/python3.7/subprocess.py", line 1624, in _wait
    (pid, sts) = self._try_wait(0)
  File "/home/ubuntu/anaconda3/envs/amp/lib/python3.7/subprocess.py", line 1582, in _try_wait
    (pid, sts) = os.waitpid(self.pid, wait_flags)
KeyboardInterrupt
ec2-35-90-65-226: kill all: timeout
ec2-35-90-65-226: Killing subprocess 3916
ec2-35-90-65-226: Killing subprocess 3917
ec2-35-90-65-226: Killing subprocess 3918
ec2-35-90-65-226: Killing subprocess 3919
ec2-35-90-65-226: Main process received SIGTERM, exiting
ec2-54-244-82-8: kill all: timeout
ec2-54-244-82-8: Killing subprocess 14964
ec2-54-244-82-8: Killing subprocess 14965
ec2-54-244-82-8: Killing subprocess 14966
ec2-54-244-82-8: Killing subprocess 14967
ec2-54-244-82-8: Main process received SIGTERM, exiting
pdsh@ip-172-31-41-243: ec2-35-90-65-226: ssh exited with exit code 1
pdsh@ip-172-31-41-243: ec2-54-244-82-8: ssh exited with exit code 1
